var VVVV_ENV="production";$.ajaxPrefilter(function(a,b){if("script"==a.dataType||"script"==b.dataType)a.cache=!0});window.console||(window.console={log:function(){}});VVVV={Config:{}};VVVV.Config.auto_undo=!1;VVVV.Nodes={};VVVV.PinTypes={};VVVV.NodeLibrary={};VVVV.NodeNames=[];VVVV.Patches={};VVVV.onNotImplemented=function(a){console.log("Warning: "+a+" is not implemented.")};VVVV.loadCounter=0;
VVVV.loadScript=function(a,b){var g=document.getElementsByTagName("head")[0],e=document.createElement("script");e.async=!1;e.src=VVVV.Root+"/"+a;b&&e.addEventListener("load",b);VVVV.loadCounter++;g.appendChild(e)};
VVVV.init=function(a,b,g){function e(){var c=new VVVV.Core.Patch("");_(VVVV.Nodes).each(function(f){var d=new f(0,c);"development"==VVVV_ENV&&console.log("Registering "+d.nodename);VVVV.NodeLibrary[d.nodename.toLowerCase()]=f;VVVV.NodeNames.push(d.nodename)});"development"==VVVV_ENV&&console.log("done ...");VVVV.MainLoops=[];$("script[language='VVVV']").each(function(){new VVVV.Core.Patch($(this).attr("src"),function(){var c=new VVVV.Core.MainLoop(this);VVVV.MainLoops.push(c)})});"function"===typeof g&&
g.call()}VVVV.Root=a||"./";"development"==VVVV_ENV&&console.log("loading vvvv.js ...");if("development"==VVVV_ENV){document.getElementsByTagName("head");var d=function(c){c.target.removeEventListener("load",d);0>=--VVVV.loadCounter&&e()};0==$("script[src*=thirdparty]").length&&VVVV.loadScript("thirdparty.js",d);0==$("script[src*=underscore]").length&&VVVV.loadScript("lib/underscore/underscore-min.js",d);0==$('script[src*="d3.js"]').length&&("full"==b||"vvvviewer"==b)&&VVVV.loadScript("lib/d3-v3/d3.v3.min.js",
d);0==$("script[src*=glMatrix]").length&&("full"==b||"run"==b)&&VVVV.loadScript("lib/glMatrix-0.9.5.min.js",d);if(0==$('script[src*="vvvv.core.js"]').length){VVVV.loadScript("core/vvvv.core.js",d);VVVV.loadScript("core/vvvv.core.vvvvconnector.js",d);if("run"==b||"full"==b)VVVV.loadScript("mainloop/vvvv.mainloop.js",d),VVVV.loadScript("mainloop/vvvv.dominterface.js",d),VVVV.loadScript("nodes/vvvv.nodes.value.js",d),VVVV.loadScript("nodes/vvvv.nodes.string.js",d),VVVV.loadScript("nodes/vvvv.nodes.boolean.js",
d),VVVV.loadScript("nodes/vvvv.nodes.color.js",d),VVVV.loadScript("nodes/vvvv.nodes.spreads.js",d),VVVV.loadScript("nodes/vvvv.nodes.spectral.js",d),VVVV.loadScript("nodes/vvvv.nodes.animation.js",d),VVVV.loadScript("nodes/vvvv.nodes.network.js",d),VVVV.loadScript("nodes/vvvv.nodes.system.js",d),VVVV.loadScript("nodes/vvvv.nodes.canvas.js",d),VVVV.loadScript("nodes/vvvv.nodes.html5.js",d),VVVV.loadScript("nodes/vvvv.nodes.transform.js",d),VVVV.loadScript("nodes/vvvv.nodes.vectors.js",d),VVVV.loadScript("nodes/vvvv.nodes.webgl.js",
d),VVVV.loadScript("nodes/vvvv.nodes.complex.js",d),VVVV.loadScript("nodes/vvvv.nodes.enumerations.js",d),VVVV.loadScript("nodes/vvvv.nodes.2d.js",d),VVVV.loadScript("nodes/vvvv.nodes.3d.js",d),VVVV.loadScript("nodes/vvvv.nodes.node.js",d),VVVV.loadScript("nodes/vvvv.nodes.astronomy.js",d),VVVV.loadScript("nodes/vvvv.nodes.xml.js",d);("vvvviewer"==b||"full"==b)&&VVVV.loadScript("vvvviewer/vvvv.vvvviewer.js",d);VVVV.loadScript("editors/vvvv.editors.browser_editor.js",d)}}"production"==VVVV_ENV&&e()};VVVV.Types={};VVVV.MousePositions={_all:{x:0,y:0,wheel:0,lb:0,mb:0,rb:0}};VVVV.Types.Color=function(a,b,g,e){this.rgba=[a,b,g,e];this.toString=function(){return"r="+100*a+"% g="+100*b+"% b="+100*g+"% a="+100*e+"%"}};var PinDirection={Input:0,Output:1,Configuration:2};VVVV.PinTypes.Generic={typeName:"Generic",reset_on_disconnect:!0,defaultValue:function(){return"0"}};VVVV.PinTypes.Value={typeName:"Value",reset_on_disconnect:!1,defaultValue:function(){return 0},primitive:!0};
VVVV.PinTypes.String={typeName:"String",reset_on_disconnect:!1,defaultValue:function(){return""},primitive:!0};VVVV.PinTypes.Enum={typeName:"Enum",reset_on_disconnect:!1,defaultValue:function(){return""},primitive:!0};
VVVV.Helpers={translateOperators:function(a){a=a.replace("Add","+");a=a.replace("Subtract","-");a=a.replace("Multiply","*");a=a.replace("Divide","/");return a=a.replace("EQ","=")},prepareFilePath:function(a,b){a=a.replace(/\\/g,"/");return a.match(/^%VVVV%/)?a.replace("%VVVV%",VVVV.Root):a.match(/^%PAGE%/)?a.replace("%PAGE%",location.pathname):a.match(/^(\/|.+:\/\/)/)?a:b?b.getAbsolutePath()+a:a}};
VVVV.Core={Pin:function(a,b,g,e,d){this.direction=b;this.pinname=a;this.links=[];this.values=[];this.node=e;this.changed=!0;this.reset_on_disconnect=this.active=!1;this.masterPin=this.slavePin=void 0;this.connectionChangedHandlers={};this.enumOptions=[];void 0==d&&"development"==VVVV_ENV&&console.warn(e.nodename+" / "+a+" -> Generic");this.getValue=function(c,f){if(!f||1==f)return this.values[c%this.values.length];for(var d=[],e=0;e<f;e++)d.push(this.values[(c*f+e)%this.values.length]);return d};
this.setValue=function(c,f,d){d=d||!1;this.values[c]=f;this.changed=!0;this.node.dirty=!0;if(this.direction==PinDirection.Output)for(var e=this.links.length,g=0;g<e;g++)this.links[g].toPin.setValue(c,f);this.slavePin&&!d&&this.slavePin.setValue(c,f);this.direction==PinDirection.Input&&(this.masterPin&&!this.isConnected())&&this.masterPin.setValue(c,f,!0);this.node.isIOBox&&"Descriptive Name"==this.pinname&&(this.node.parentPatch.domInterface?this.node.parentPatch.domInterface.connect(this.node):this.node.parentPatch.parentPatch&&
this.node.registerInterfacePin())};this.markPinAsChanged=function(){this.changed=!0;this.node.dirty=!0;if(this.direction==PinDirection.Output)for(var c=this.links.length,f=0;f<c;f++)this.links[f].toPin.markPinAsChanged();this.slavePin&&this.slavePin.markPinAsChanged()};this.pinIsChanged=function(){var c=this.changed;this.changed=!1;return c};this.isConnected=function(){return 0<this.links.length||this.masterPin&&this.masterPin.isConnected()};this.getSliceCount=function(){return this.values.length};
this.setSliceCount=function(c){if(this.values.length!=c){this.values.length=c;this.changed=!0;this.node.dirty=!0;if(this.direction==PinDirection.Output)for(var f=this.links.length,d=0;d<f;d++)this.links[d].toPin.setSliceCount(c);this.slavePin&&this.slavePin.setSliceCount(c)}};this.setType=function(c){if(c.typeName!=this.typeName){var f=this;delete this.connectionChangedHandlers.nodepin;delete this.connectionChangedHandlers.webglresource;_(c.connectionChangedHandlers).each(function(d,e){f.connectionChangedHandlers[e]=
c.connectionChangedHandlers[e]});this.typeName=c.typeName;this.defaultValue=c.defaultValue;this.direction==PinDirection.Input&&this.defaultValue&&(this.setValue(0,this.defaultValue()),this.setSliceCount(1));void 0!=c.reset_on_disconnect&&(this.reset_on_disconnect=c.reset_on_disconnect)}};void 0==d&&(d=VVVV.PinTypes.Generic,this.unvalidated=!0);this.setType(d);g&&0<g.length&&(this.values=g.slice(0));this.reset=function(){console.log("resetting "+this.pinname);this.defaultValue?(this.setValue(0,this.defaultValue()),
this.setSliceCount(1)):this.values=g.slice(0);this.markPinAsChanged()};this.connectionChanged=function(){var c=this;_(this.connectionChangedHandlers).each(function(f){c.f=f;c.f()})}},Node:function(a,b,g){this.nodename=b;this.id=a;this.height=this.width=this.y=this.x=0;this.isShader=this.isIOBox=!1;this.resourcesPending=0;this.auto_nil=!0;this.setupObject=function(){this.inputPins={};this.outputPins={};this.invisiblePins={};this.defaultPinValues={}};this.setupObject();this.delays_output=this.auto_evaluate=
!1;this.dirty=!0;(this.parentPatch=g)&&(this.parentPatch.nodeMap[a]=this);this.addDefault=function(e,d){this.defaultPinValues[e]=d};this.addInputPin=function(e,d,c){d=new VVVV.Core.Pin(e,PinDirection.Input,d,this,c);this.inputPins[e]=d;this.parentPatch&&(this.parentPatch.pinMap[this.id+"_in_"+e]=d);this.applyPinValuesFromXML(e);return d};this.addOutputPin=function(e,d,c){d=new VVVV.Core.Pin(e,PinDirection.Output,d,this,c);this.outputPins[e]=d;this.parentPatch&&(this.parentPatch.pinMap[this.id+"_out_"+
e]=d);return d};this.removeInputPin=function(e){if(this.inputPins[e]){var d=this.inputPins[e].links[0];d&&(d.fromPin.connectionChanged(),d.destroy());delete this.inputPins[e];this.dirty=!0}};this.removeOutputPin=function(e){if(this.outputPins[e]){for(var d=this.outputPins[e].links.length,c=0;c<d;c++){var f=this.outputPins[e].links[c];f.toPin.connectionChanged();f.destroy()}delete this.outputPins[e];this.dirty=!0}};this.addInvisiblePin=function(e,d,c){d=new VVVV.Core.Pin(e,PinDirection.Configuration,
d,this,c);this.invisiblePins[e]=d;this.parentPatch.pinMap[this.id+"_inv_"+e]=d;void 0!=this.defaultPinValues[e]&&(d.values=this.defaultPinValues[e]);return d};this.IOBoxType=function(){var e=/^IOBox \((.*)\)/.exec(this.nodename);return e&&1<e.length?e[1]:""};this.IOBoxInputPin=function(){switch(this.IOBoxType()){case "Value Advanced":return this.inputPins["Y Input Value"];case "String":return this.inputPins["Input String"];case "Color":return this.inputPins["Color Input"];case "Node":return this.inputPins["Input Node"]}};
this.IOBoxOutputPin=function(){switch(this.IOBoxType()){case "Value Advanced":return this.outputPins["Y Output Value"];case "String":return this.outputPins["Output String"];case "Color":return this.outputPins["Color Output"];case "Node":return this.outputPins["Output Node"]}};this.IOBoxRows=function(){return this.invisiblePins.Rows?this.invisiblePins.Rows.getValue(0):1};this.isComment=function(){return this.isIOBox&&0==_(this.outputPins).size()};this.label=function(){if(this.isIOBox)return this.IOBoxInputPin().getValue(0)?
this.IOBoxInputPin().getValue(0).toString():"";if(this.isSubpatch)return"||"+this.nodename.match(/([^\/]+)\.v4p$/)[1];var e=this.nodename.replace(/\s\(.+\)/,"");return e=VVVV.Helpers.translateOperators(e)};this.getWidth=function(){var e;e=100==this.width||0==this.width?this.isIOBox?60:Math.max(18,6*(this.label().length+2)):this.width/15;return e=Math.max(e,12*(_(this.inputPins).size()-1)+4)};this.getHeight=function(){return this.isIOBox&&100==this.height?18*this.IOBoxRows():100==this.height||this.isSubpatch?
18:Math.max(18,this.height/15)};this.getUpstreamNodes=function(){var e=[];_(this.inputPins).each(function(d){0<d.links.length&&e.push(d.links[0].fromPin.node)});return e};this.getDownstreamNodes=function(){var e=[];_(this.outputPins).each(function(d){for(var c=0;c<d.links.length;c++)e.push(d.links[c].toPin.node)});return e};this.findDownstreamNodes=function(e){var d=[];_(this.outputPins).each(function(c){for(var f=0;f<c.links.length;f++)c.links[f].toPin.node.nodename==e?d.push(c.links[f].toPin.node):
d=c.links[f].toPin.slavePin?d.concat(c.links[f].toPin.slavePin.node.findDownstreamNodes(e)):c.links[f].toPin.node.isIOBox&&c.links[f].toPin.node.IOBoxOutputPin().slavePin?d.concat(c.links[f].toPin.node.IOBoxOutputPin().slavePin.node.findDownstreamNodes(e)):d.concat(c.links[f].toPin.node.findDownstreamNodes(e))});return d};this.hasNilInputs=function(){var e=!1;_(this.inputPins).each(function(d){0==d.getSliceCount()&&(e=!0)});return e};this.getMaxInputSliceCount=function(){var e=0;_(this.inputPins).each(function(d){d.getSliceCount()>
e&&(e=d.values.length)});return e};this.applyPinValuesFromXML=function(e){if(this.inputPins[e]){var d=this.inputPins[e];e=this.defaultPinValues[e];if(void 0!=e&&(!d.reset_on_disconnect||1<e.length||""!=e[0])){for(var c=0;c<e.length;c++)d.values[c]!=e[c]&&d.setValue(c,e[c]);d.setSliceCount(e.length)}}};this.registerInterfacePin=function(){var e=this;if(this.isIOBox&&this.parentPatch.parentPatch&&""!=this.invisiblePins["Descriptive Name"].getValue(0)){var d=this.invisiblePins["Descriptive Name"].getValue(0);
this.IOBoxInputPin().connectionChangedHandlers.subpatchpins=function(){if(0<this.links.length&&this.masterPin){"development"==VVVV_ENV&&console.log("deleting "+d+" input pin because node has input connection...");for(var c=0;c<this.masterPin.links.length;c++)this.masterPin.links[c].destroy();e.parentPatch.removeInputPin(d);this.masterPin=void 0}e.IOBoxOutputPin().slavePin?e.IOBoxOutputPin().slavePin.pinname!=d&&("development"==VVVV_ENV&&console.log("renaming "+e.IOBoxOutputPin().slavePin.pinname+
" to "+d),e.parentPatch.outputPins[d]=e.parentPatch.outputPins[e.IOBoxOutputPin().slavePin.pinname],e.parentPatch.removeOutputPin(e.IOBoxOutputPin().slavePin.pinname),e.IOBoxOutputPin().slavePin.pinname=d):("development"==VVVV_ENV&&console.log("interfacing output pin detected: "+d),c=e.parentPatch.outputPins[d],void 0==c&&(c=e.parentPatch.addOutputPin(d,e.IOBoxOutputPin().values)),c.setType(VVVV.PinTypes[e.IOBoxOutputPin().typeName]),e.IOBoxOutputPin().slavePin=c,c.masterPin=e.IOBoxOutputPin())};
this.IOBoxInputPin().connectionChanged();this.IOBoxOutputPin().connectionChangedHandlers.subpatchpins=function(){if(0<this.links.length&&this.slavePin){"development"==VVVV_ENV&&console.log("deleting "+d+" output pin because node "+e.id+" has output connection...");for(var c=0;c<this.slavePin.links.length;c++)this.slavePin.links[c].destroy();e.parentPatch.removeOutputPin(d);this.slavePin=void 0}if(e.IOBoxInputPin().masterPin)e.IOBoxInputPin().masterPin.pinname!=d&&(console.log("renaming "+e.IOBoxInputPin().masterPin.pinname+
" to "+d),e.parentPatch.inputPins[d]=e.parentPatch.inputPins[e.IOBoxInputPin().masterPin.pinname],e.parentPatch.removeInputPin(e.IOBoxInputPin().masterPin.pinname),e.IOBoxInputPin().masterPin.pinname=d);else{"development"==VVVV_ENV&&console.log("interfacing input pin detected: "+d);var f=e.parentPatch.inputPins[d];if(void 0==f)"development"==VVVV_ENV&&console.log("creating new input pin at parent patch, using IOBox values"),f=e.parentPatch.addInputPin(d,e.IOBoxInputPin().values);else{slicecount=f.getSliceCount();
for(c=0;c<slicecount;c++)e.IOBoxInputPin().setValue(c,f.getValue(c));0<slicecount&&e.IOBoxInputPin().setSliceCount(f.getSliceCount())}c=f.values.slice();f.setType(VVVV.PinTypes[e.IOBoxInputPin().typeName]);if(f.unvalidated&&VVVV.PinTypes[f.typeName].primitive||f.isConnected())f.values=c,f.unvalidated=!1;f.slavePin=e.IOBoxInputPin();e.IOBoxInputPin().masterPin=f}};this.IOBoxOutputPin().connectionChanged()}};this.setup=function(){this.addInvisiblePin("Descriptive Name",[""],VVVV.PinTypes.String)};this.initialize=
function(){};this.evaluate=function(){_(this.outputPins).each(function(e){e.setValue(0,"not calculated")})};this.serialize=function(){var e=$("<NODE>");e.attr("id",this.id);e.attr("nodename",this.nodename);e.attr("systemname",this.nodename);this.shaderFile&&e.attr("filename",this.shaderFile.replace(".vvvvjs.fx",".fx").replace("%VVVV%/effects","%VVVV%/lib/nodes/effects"));this.isSubpatch&&(e.attr("filename",this.nodename),e.attr("systemname",this.nodename.match("(.*).v4p$")[1]));this.isIOBox?e.attr("componentmode",
"InABox"):e.attr("componentmode","Hidden");var d=$("<BOUNDS>");this.isIOBox?d.attr("type","Box"):d.attr("type","Node");d.attr("left",parseInt(15*this.x));d.attr("top",parseInt(15*this.y));d.attr("width",parseInt(this.width));d.attr("height",parseInt(this.height));e.append(d);var c=this;_(this.inputPins).each(function(f){var d=$("<PIN>");d.attr("pinname",f.pinname);d.attr("visible","1");(!f.isConnected()||f.masterPin)&&(VVVV.PinTypes[f.typeName].primitive&&c.defaultPinValues[f.pinname])&&d.attr("values",
_(c.defaultPinValues[f.pinname]).map(function(c){return"|"+c+"|"}).join(","));e.append(d)});_(this.invisiblePins).each(function(c){var d=$("<PIN>");d.attr("pinname",c.pinname);d.attr("visible","0");VVVV.PinTypes[c.typeName].primitive&&d.attr("values",_(c.values).map(function(c){return"|"+c+"|"}).join(","));e.append(d)});return e}},Link:function(a,b){this.fromPin=a;this.toPin=b;this.fromPin.links.push(this);this.toPin.links.push(this);this.destroy=function(){this.fromPin.links.splice(this.fromPin.links.indexOf(this),
1);this.toPin.links.splice(this.toPin.links.indexOf(this),1);this.fromPin.node.parentPatch.linkList.splice(this.fromPin.node.parentPatch.linkList.indexOf(this),1)};this.serialize=function(){var g=$("<LONK>");g.attr("srcnodeid",this.fromPin.node.id);g.attr("srcpinname",this.fromPin.pinname);g.attr("dstnodeid",this.toPin.node.id);g.attr("dstpinname",this.toPin.pinname);return g}},Patch:function(a,b,g,e,d){function c(c){if(void 0==c)return[];if("45_26">=this.vvvv_version)return separator=/\|/.test(c)?
"|":",",c.split(separator).filter(function(c){return""!=c});for(var f=[],d="",h=!1,e=c.length,g=0;g<e;g++)","==c[g]&&!h?(f.push(d),d=""):"|"==c[g]?h=!h:d+=c[g];f.push(d);return f}function f(){if(!VVVV.Editors.Connector.isConnected()&&(window.location.hash=="#sync/"+j.ressource||window.location.hash=="#syncandview/"+j.ressource))console.log("enabling devel env"),VVVV.Editors.Connector.disable(),VVVV.Editors.Connector.host="ws://localhost",VVVV.Editors.Connector.enable(j);if(!j.vvvviewer&&(window.location.hash==
"#view/"+j.ressource||window.location.hash=="#syncandview/"+j.ressource))j.vvvviewer=new VVVV.VVVViewer(j);window.location.hash=="#edit/"+j.ressource&&(console.log("launching editor ..."),VVVV.Editors.edit.enable(j))}this.ressource=a;this.vvvv_version="45_26.1";this.boundingBox={width:0,height:0};this.windowHeight=this.windowWidth=500;this.pinMap={};this.nodeMap={};this.nodeList=[];this.linkList=[];this.success=b;this.error=g;this.XMLCode="";this.editor=void 0;this.setupObject();e&&(this.parentPatch=
e);d&&(this.id=d);var h=!1;this.getAbsolutePath=function(){var c=this.getRelativePath();this.parentPatch&&(c=this.parentPatch.getRelativePath()+c);return c};this.getRelativePath=function(){return this.nodename.match(/(.*\/)?[^/]+\.v4p/)[1]||""};if("45_26">=this.vvvv_version)var k={},m={},l={},p={};var j=this;this.doLoad=function(f,d){function h(c){"complete"==g&&(m={});$(c).find('link[deleteme="pronto"]').each(function(){for(var c=!1,f=0;f<j.linkList.length;f++)j.linkList[f].fromPin.node.id==$(this).attr("srcnodeid")&&
(j.linkList[f].fromPin.pinname==$(this).attr("srcpinname")&&j.linkList[f].toPin.node.id==$(this).attr("dstnodeid")&&j.linkList[f].toPin.pinname==$(this).attr("dstpinname"))&&(c=j.linkList[f]);if(c){"development"==VVVV_ENV&&console.log("removing "+c.fromPin.pinname+" -> "+c.toPin.pinname);var f=c.fromPin,d=c.toPin;c.destroy();f.connectionChanged();d.connectionChanged();d.markPinAsChanged();d.reset_on_disconnect&&d.reset()}});$(c).find('link[deleteme!="pronto"]').each(function(){var c=j.pinMap[$(this).attr("srcnodeid")+
"_out_"+$(this).attr("srcpinname")],f=j.pinMap[$(this).attr("dstnodeid")+"_in_"+$(this).attr("dstpinname")];void 0==c&&j.nodeMap[$(this).attr("srcnodeid")]&&(c=j.nodeMap[$(this).attr("srcnodeid")].addOutputPin($(this).attr("srcpinname"),void 0));void 0==f&&j.nodeMap[$(this).attr("dstnodeid")]&&(f=j.nodeMap[$(this).attr("dstnodeid")].addInputPin($(this).attr("dstpinname"),void 0));if(c&&f){c.typeName!=f.typeName&&"Node"!=c.typeName&&"Node"!=f.typeName&&"development"==VVVV_ENV&&console.warn("Type Mismatch: "+
c.node.nodename+"/"+c.pinname+" <-> "+f.node.nodename+"/"+f.pinname);for(var d=!1,h=0;h<j.linkList.length;h++)j.linkList[h].fromPin.node.id==c.node.id&&(j.linkList[h].fromPin.pinname==c.pinname&&j.linkList[h].toPin.node.id==f.node.id&&j.linkList[h].toPin.pinname==f.pinname)&&(d=j.linkList[h]);if(!d){d=new VVVV.Core.Link(c,f);c.connectionChanged();f.connectionChanged();j.linkList.push(d);for(h=0;h<c.values.length;h++)f.setValue(h,c.getValue(h));f.setSliceCount(c.getSliceCount())}"complete"==g&&(m[c.node.id+
"_"+c.pinname+"-"+f.node.id+"_"+f.pinname]=d)}});"complete"==g&&(_(k).each(function(c,f){if(void 0==m[f]){"development"==VVVV_ENV&&console.log("removing "+c.fromPin.pinname+" -> "+c.toPin.pinname);var d=c.fromPin,h=c.toPin;c.destroy();d.connectionChanged();h.connectionChanged();h.markPinAsChanged();h.reset_on_disconnect&&h.reset()}}),k={},_(m).each(function(c,f){k[f]=c}))}var e=this;do e.dirty=!0;while(e=e.parentPatch);if(e=/^<!DOCTYPE\s+PATCH\s+SYSTEM\s+"(.+)\\(.+)\.dtd/.exec(f))j.vvvv_version=e[2].replace(/[a-zA-Z]+/,
"_");var g="diff";if(/\s<PATCH/.test(f)||"45_26">=j.vvvv_version)g="complete","development"==VVVV_ENV&&console.log("complete: "+this.nodename),j.XMLCode=f;e=$(f).find('bounds[type="Window"]').first();0<e.length&&(j.windowWidth=e.attr("width")/15,j.windowHeight=e.attr("height")/15);"complete"==g&&(p={});var a=0;$(f).find("node").each(function(){if("pronto"==$(this).attr("createme")&&void 0!=j.nodeMap[$(this).attr("id")]){var e=j.nodeMap[$(this).attr("id")];"development"==VVVV_ENV&&console.log("node renamed, so deleting node "+
e.id+" / "+e.nodename);_(e.inputPins).each(function(c){_(c.links).each(function(c){c.destroy();c.fromPin.connectionChanged()})});_(e.outputPins).each(function(c){_(c.links).each(function(c){c.destroy();c.toPin.connectionChanged();c.toPin.markPinAsChanged();c.toPin.reset_on_disconnect&&c.toPin.reset()})});j.nodeList.splice(j.nodeList.indexOf(e),1);delete j.nodeMap[e.id]}var k;k="InABox"==$(this).attr("componentmode")?$(this).find('bounds[type="Box"]').first():$(this).find('bounds[type="Node"]').first();
var l=void 0!=j.nodeMap[$(this).attr("id")];if(l)e=j.nodeMap[$(this).attr("id")];else{nodename=""!=$(this).attr("systemname")?$(this).attr("systemname"):$(this).attr("nodename");if(void 0==nodename)return;if(void 0!=VVVV.NodeLibrary[nodename.toLowerCase()])e=new (VVVV.NodeLibrary[nodename.toLowerCase()])($(this).attr("id"),j),VVVV.NodeLibrary[nodename.toLowerCase()].requirements&&(j.resourcesPending++,_(VVVV.NodeLibrary[nodename.toLowerCase()].requirements).each(function(c){void 0===VVVV.LoadedLibs[c]&&
VVVV.loadScript(VVVV.ThirdPartyLibs[c],function(){j.resourcesPending--})}));else if(/.fx$/.test($(this).attr("filename")))e=new VVVV.Nodes.GenericShader($(this).attr("id"),j),e.isShader=!0,e.shaderFile=$(this).attr("filename").replace(/\\/g,"/").replace(/\.fx$/,".vvvvjs.fx").replace("lib/nodes/",""),e.nodename=nodename;else if(/.v4p$/.test($(this).attr("filename"))){j.resourcesPending++;a++;var b=this,e=new VVVV.Core.Patch($(this).attr("filename"),function(){j.resourcesPending--;a--;"development"==
VVVV_ENV&&console.log(this.nodename+"invoking update links");h(f);j.editor&&j.editor.addPatch(this);if(this.auto_evaluate){var c=j;do c.auto_evaluate=!0;while(c=c.parentPatch)}j.afterUpdate();0>=j.resourcesPending&&d&&(d(),d=void 0)},function(){this.not_implemented=!0;VVVV.onNotImplemented(nodename)},j,$(b).attr("id"));e.isSubpatch=!0;j.editor&&!e.editor&&j.editor.addPatch(e);j.nodeMap[e.id]=e}else e=new VVVV.Core.Node($(this).attr("id"),nodename,j),e.not_implemented=!0,"diff"==g&&!0==VVVV.Config.auto_undo&&
j.editor.sendUndo(),VVVV.onNotImplemented(nodename);"development"==VVVV_ENV&&"complete"!=g&&console.log(j.nodename+": inserted new node "+e.nodename)}if(e.auto_evaluate){b=j;do b.auto_evaluate=!0;while(b=b.parentPatch)}if("pronto"==$(this).attr("deleteme")){"development"==VVVV_ENV&&console.log("removing node "+e.id);if(e.isSubpatch){e.editor&&e.editor.removePatch(e);b=e.getSubPatches();b.push(e);for(var m,n=0;n<b.length;n++)m=VVVV.Helpers.prepareFilePath(b[n].nodename,b[n].parentPatch),VVVV.Patches[m].splice(VVVV.Patches[m].indexOf(e),
1),0==VVVV.Patches[m].length&&delete VVVV.Patches[m]}j.nodeList.splice(j.nodeList.indexOf(e),1);delete j.nodeMap[e.id]}0<k.length&&(k.attr("left")&&(e.x=k.attr("left")/15,e.y=k.attr("top")/15,j.boundingBox.width=Math.max(j.boundingBox.width,e.x+100),j.boundingBox.height=Math.max(j.boundingBox.height,e.y+100)),k.attr("width")&&(e.width=k.attr("width"),e.height=k.attr("height")));/^iobox/.test(e.nodename.toLowerCase())&&(e.isIOBox=!0);l||e.setup();b=this;$(this).find("pin").each(function(){var d=$(this).attr("pinname"),
h=c($(this).attr("values"));void 0!=h&&0<h.length&&e.addDefault(d,h);if(void 0==e.outputPins[d])if(void 0!=e.inputPins[d])e.inputPins[d].isConnected()||e.applyPinValuesFromXML(d);else if(void 0!=e.invisiblePins[d]){if(void 0!=h){for(var g=0;g<h.length;g++)e.invisiblePins[d].values[g]!=h[g]&&e.invisiblePins[d].setValue(g,h[g]);e.invisiblePins[d].setSliceCount(h.length)}}else 1==$(this).attr("visible")&&"Configuration"!=$(this).attr("pintype")||e.isSubpatch?"Output"==$(this).attr("pintype")||0<$(f).find("link[srcnodeid="+
e.id+"]").filter("link[srcpinname='"+d.replace(/[\[\]]/,"")+"']").length?void 0==e.outputPins[d]&&e.addOutputPin(d,h):void 0==e.inputPins[d]&&void 0==e.invisiblePins[d]&&e.addInputPin(d,h):void 0==e.inputPins[d]&&void 0==e.invisiblePins[d]&&e.addInvisiblePin(d,h)});l||(e.initialize(),j.nodeList.push(e));"complete"==g&&(p[e.id]=e)});"complete"==g&&(_(l).each(function(c,f){void 0==p[f]&&("development"==VVVV_ENV&&console.log("removing node "+c.id),j.nodeList.splice(j.nodeList.indexOf(c),1),delete j.nodeMap[c.id])}),
l={},_(p).each(function(c,f){l[f]=c}));0===a&&h(f);0>=this.resourcesPending&&d&&(d(),d=void 0)};this.getSubPatches=function(){for(var c=[],f=0;f<this.nodeList.length;f++)this.nodeList[f].isSubpatch&&(c.push(this.nodeList[f]),c=c.concat(this.nodeList[f].getSubPatches()));return c};this.afterEvaluate=function(){};this.afterUpdate=function(){};this.toXML=function(){var c=$("<PATCH>"),f=$("<BOUNDS>");f.attr("type","Window");f.attr("width",parseInt(15*this.windowWidth));f.attr("height",parseInt(15*this.windowHeight));
c.append(f);for(f=0;f<this.nodeList.length;f++)c.append(this.nodeList[f].serialize());for(f=0;f<this.linkList.length;f++)c.append(this.linkList[f].serialize());c='<!DOCTYPE PATCH  SYSTEM "http://vvvv.org/versions/vvvv45beta28.1.dtd" >\r\n  '+c.wrapAll("<d></d>").parent().html();c=c.replace(/<patch/g,"<PATCH");c=c.replace(/<\/patch>/g,"\n  </PATCH>");c=c.replace(/<node/g,"\n  <NODE");c=c.replace(/<\/node>/g,"\n  </NODE>");c=c.replace(/<bounds/g,"\n  <BOUNDS");c=c.replace(/<\/bounds>/g,"\n  </BOUNDS>");
c=c.replace(/<pin/g,"\n  <PIN");c=c.replace(/<\/pin>/g,"\n  </PIN>");c=c.replace(/<lonk/g,"\n  <LINK");return c=c.replace(/<\/lonk>/g,"\n  </LINK>")};this.evaluate=function(){function c(f){var e=f.getUpstreamNodes();_(e).each(function(f){void 0!=d[f.id]&&!f.delays_output&&c(f)});if(f.dirty||f.auto_evaluate||f.isSubpatch){if(h)var g=(new Date).getTime();if(f.auto_nil&&!f.isSubpatch&&f.hasNilInputs())_(f.outputPins).each(function(c){c.setSliceCount(0)});else{try{f.evaluate()}catch(k){console.log("VVVV.Js / Error evaluating "+
f.nodename+": "+k.message)}h&&console.log(f.nodename+" / "+f.id+": "+((new Date).getTime()-g)+"ms");f.dirty=!1;_(f.inputPins).each(function(c){c.changed=!1})}}delete d[f.id];return!0}if(!(0<this.resourcesPending)){if(h)var f=(new Date).getTime();for(var d={},e={},g=0;g<this.nodeList.length;g++){if(0==this.nodeList[g].getDownstreamNodes().length||this.nodeList[g].auto_evaluate||this.nodeList[g].delays_output)e[this.nodeList[g].id]=this.nodeList[g];d[this.nodeList[g].id]=this.nodeList[g]}h&&console.log("building node maps: "+
((new Date).getTime()-f)+"ms");_(e).each(function(f){void 0!=d[f.id]&&c(f)});h&&(f=(new Date).getTime());this.afterEvaluate();h&&console.log("patch rendering: "+((new Date).getTime()-f)+"ms");h=!1}};$(window).keydown(function(c){84==c.which&&(c.altKey&&c.ctrlKey)&&(h=!0)});if(/\.v4p[^<>\s]*$/.test(a)){this.nodename=a;var n=this,r=a;this.parentPatch&&(r=VVVV.Helpers.prepareFilePath(a,this.parentPatch));VVVV.Patches[r]?n.doLoad(VVVV.Patches[r][0].toXML(),function(){VVVV.Patches[r].push(n);n.success&&
n.success();n.afterUpdate()}):$.ajax({url:r,type:"get",dataType:"text",success:function(c){n.doLoad(c,function(){VVVV.Patches[r]=VVVV.Patches[r]||[];VVVV.Patches[r].push(n);n.success&&n.success();n.afterUpdate()})}})}else/^ws:\/\//.test(a)?(n=this,VVVV.Editors.Connector.host=a,VVVV.Editors.Connector.enable(this,{success:function(){n.success&&n.success()},error:function(){n.error&&n.error()}})):this.doLoad(a,function(){this.success&&this.success()});f();$(window).bind("hashchange",function(){f()})}};
VVVV.Core.Patch.prototype=new VVVV.Core.Node;if(!WebSocket&&MozWebSocket)var WebSocket=MozWebSocket;
VVVV.Core.VVVVConnector=function(){this.patches=[];this.patchMap={};var a=this.host=!1,b=[],g=this;this.enable=function(e,d){d=d||{};if(this.host){a=new WebSocket(this.host+":4444","vvvvjs");window.setInterval(function(){(message=b.shift())&&a.send(message)},300);var c=!1;a.onopen=function(){function f(c){h[c]&&(g.addPatch(h[c]),window.setTimeout(function(){f(c+1)},2E3))}c=!0;console.log("connected to VVVV ...");g.addPatch(e);var h=e.getSubPatches();window.setTimeout(function(){f(0)},2E3);d.success&&
d.success()};a.onclose=function(){!c&&d.error&&d.error();c=!1};a.onmessage=function(c){c=c.data.split("UPDATE");for(var d=0;d<c.length;d++){var e=("UPDATE"+c[d]).match(/^UPDATE\/([^/]+)\/([\s\S]*)/);if(e&&(g.patchMap[e[1]+".v4p"]&&_(g.patchMap[e[1]+".v4p"]).each(function(c){c.doLoad(e[2]);c.afterUpdate()}),"*"==e[1])){var a=g.patchMap[Object.keys(g.patchMap)[0]][0];a.doLoad(e[2]);a.afterUpdate()}}};$(window).unload(function(){console.log("closing socket ...");a.close()})}};this.addPatch=function(e){for(var d=
0;d<this.patches.length;d++)if(this.patches[d].id==e.id)return;console.log("adding patch "+e.nodename+" to Connector");this.patches.push(e);this.patchMap[e.nodename]||(this.patchMap[e.nodename]=[]);this.patchMap[e.nodename].push(e);e.VVVVConnector=this;g.pushCompletePatch(e);window.setTimeout(function(){g.pullCompletePatch(e)},1E3)};this.disable=function(){this.patch&&(this.patch=this.patch.VVVVConnector=void 0,a&&a.close(),a.onmessage=null,a.onopen=null,a=!1)};this.pullCompletePatch=function(e){console.log("pulling patch..."+
e.nodename);b.push("PULL/"+e.nodename)};this.pushCompletePatch=function(e){console.log("pushing patch ..."+e.nodename);b.push("PUSH/"+e.nodename+"/"+e.XMLCode)};this.sendUndo=function(){a&&(console.log("forcing Undo ..."),b.push("UNDO"))};this.isConnected=function(){return!1!==a}};VVVV.Editors={};VVVV.Editors.Connector=new VVVV.Core.VVVVConnector;VVVV.Nodes.VVVVJsConnector=function(a,b){this.constructor(a,"VVVVJsConnector (VVVVjs)",b)};VVVV.Nodes.VVVVJsConnector.prototype=new VVVV.Core.Node;VVVV.Core.DOMInterface=function(a){var b={},g={};a.domInterface=this;this.connect=function(d){_(b).each(function(c,f){c.node.id==d.id&&("event"==c.property_class&&$(c.selector).unbind(c.property),delete b[f])});_(g).each(function(c,f){c.node.id==d.id&&delete g[f]});var c=/([^\/]+)(\/(event|attribute|style)\/(.+))?/.exec(d.invisiblePins["Descriptive Name"].getValue(0));if(null!=c){var f={selector:c[1],property_class:c[3],property:c[4],values:[],node:d};0!=$(f.selector).length&&(0==d.getUpstreamNodes().length?
b[c[0]]=f:0==d.getDownstreamNodes().length&&(g[c[0]]=f),"event"==f.property_class&&(c=f.selector,"window"==c&&(c=window),"document"==c&&(c=document),$(c).each(function(c){f.values[c]=0;$(this).bind(f.property,function(){f.values[c]=1;return!1})})))}};var e=this;_(a.nodeList).each(function(d){d.isIOBox&&void 0!=d.invisiblePins["Descriptive Name"]&&(e.connect(d),d.IOBoxInputPin().connectionChanged=function(){e.connect(d)})});this.populateInputConnectors=function(){var d=this;_(b).each(function(c){switch(c.property_class){case "event":c.values.length!=
c.node.IOBoxInputPin().values.length&&c.node.IOBoxInputPin().setSliceCount(c.values.length);for(var f=0;f<c.values.length;f++)(void 0==c.node.IOBoxInputPin().values[f]||c.values[f]!=c.node.IOBoxInputPin().values[f])&&c.node.IOBoxInputPin().setValue(f,c.values[f]);break;default:d.fetchValuesFromDOM(c);c.values.length!=c.node.IOBoxInputPin().values.length&&c.node.IOBoxInputPin().setSliceCount(c.values.length);for(f=0;f<c.values.length;f++)c.node.IOBoxInputPin().getValue(f)!=c.values[f]&&c.node.IOBoxInputPin().setValue(f,
c.values[f])}})};this.processOutputConnectors=function(){var d=this;_(g).each(function(c){switch(c.property_class){default:d.setDOMByIOBox(c)}});_(b).each(function(c){if("event"==c.property_class)for(var f=0;f<c.values.length;f++)c.values[f]=0})};this.fetchValuesFromDOM=function(d){d.values.length=0;$(d.selector).each(function(c){var f;if(void 0==d.property_class)switch(this.nodeName){case "INPUT":"text"==$(this).attr("type")&&(f=$(this).val());"checkbox"==$(this).attr("type")&&(f=$(this).attr("checked")?
1:0);break;default:f=$(this).text()}"attribute"==d.property_class&&(f=$(this).attr(d.property));"style"==d.property_class&&(f=$(this).css(d.property));d.values[c]=f})};this.setDOMByIOBox=function(d){if(d.node.IOBoxOutputPin().pinIsChanged()){var c=d.node.IOBoxInputPin().values,f=$(d.selector).length;void 0==d.property_class&&($(d.selector).empty(),$(d.selector).val(""));for(var e=0;e<Math.max(c.length,f);e++){var g=e%f,a=e%c.length,b=$(d.selector).eq(g);if(0!=b.length){if(void 0==d.property_class)switch(b[0].nodeName){case "INPUT":b.val($(d.selector).eq(g).val()+
c[a]);break;default:b.html($(d.selector).eq(g).html()+c[a])}"attribute"==d.property_class&&b.attr(d.property,c[a]);"style"==d.property_class&&b.css(d.property,c[a])}}}}};VVVV.fps=60;
VVVV.Core.MainLoop=function(a,b){function g(){if(0==a.resourcesPending){e++;var k=(new Date).getTime();d.populateInputConnectors();a.evaluate();d.processOutputConnectors();var b=(new Date).getTime()-k;0==e%10&&(h&&(console.log(1/((k-f)/1E4)+"fps"),h=!1),f=k)}c&&window.setTimeout(g,Math.max(0,Math.round(1E3/VVVV.fps-b)))}VVVV.fps=b||60;var e=0,d=new VVVV.Core.DOMInterface(a),c=!0,f=0,h=!1;this.stop=function(){c=!1};this.start=function(){c||(c=!0,g())};this.isRunning=function(){return c};g();$(window).keydown(function(c){if((102==
c.which||70==c.which)&&c.altKey&&c.ctrlKey)h=!0})};VVVV.Nodes.Cross2d=function(a,b){this.constructor(a,"Cross (2d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("X In",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y In",[0],VVVV.PinTypes.Value),d=this.addInputPin("Include Upper",[1],VVVV.PinTypes.Value),c=this.addInputPin("Include Lower",[1],VVVV.PinTypes.Value),f=this.addInputPin("Include Equal",[1],VVVV.PinTypes.Value),h=this.addOutputPin("X Out",
[0],VVVV.PinTypes.Value),k=this.addOutputPin("Y Out",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=0,b=0;b<e.getSliceCount();b++)for(var p=0;p<g.getSliceCount();p++)!(0.5>d.getValue(0)&&b>p)&&(!(0.5>c.getValue(0)&&b<p)&&!(0.5>f.getValue(0)&&b==p))&&(h.setValue(a,g.getValue(p)),k.setValue(a,e.getValue(b)),a++);h.setSliceCount(a);k.setSliceCount(a)}};VVVV.Nodes.Cross2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Polar2d=function(a,b){this.constructor(a,"Polar (2d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("X",[1],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Angle",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Length",[1],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),h=0;h<
f;h++){var k=g.getValue(h),a=e.getValue(h);d.setValue(h,Math.atan2(a,k)/(2*Math.PI));c.setValue(h,Math.sqrt(k*k+a*a))}d.setSliceCount(f);c.setSliceCount(f)}};VVVV.Nodes.Polar2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Cartesian2d=function(a,b){this.constructor(a,"Cartesian (2d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Angle",[0],VVVV.PinTypes.Value),e=this.addInputPin("Length",[1],VVVV.PinTypes.Value),d=this.addOutputPin("X",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Y",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),h=0;h<f;h++){var k=g.getValue(h),
a=e.getValue(h);d.setValue(h,a*Math.cos(2*k*Math.PI));c.setValue(h,a*Math.sin(2*k*Math.PI))}d.setSliceCount(f);c.setSliceCount(f)}};VVVV.Nodes.Cartesian2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Points2Vector2d=function(a,b){this.constructor(a,"Points2Vector (2d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("X1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y1",[0],VVVV.PinTypes.Value),d=this.addInputPin("X2",[1],VVVV.PinTypes.Value),c=this.addInputPin("Y2",[0],VVVV.PinTypes.Value),f=this.addOutputPin("X",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),
k=this.addOutputPin("Length",[1],VVVV.PinTypes.Value),m=this.addOutputPin("Angle",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var j=parseFloat(g.getValue(b)),n=parseFloat(e.getValue(b)),r=parseFloat(d.getValue(b)),u=parseFloat(c.getValue(b)),r=r-j,u=u-n;f.setValue(b,j+r/2);h.setValue(b,n+u/2);k.setValue(b,Math.sqrt(r*r+u*u));m.setValue(b,Math.atan2(u,r)/(2*Math.PI))}f.setSliceCount(a);h.setSliceCount(a);k.setSliceCount(a);m.setSliceCount(a)}};
VVVV.Nodes.Points2Vector2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Vector2Points2d=function(a,b){this.constructor(a,"Vector2Points (2d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),d=this.addInputPin("Length",[1],VVVV.PinTypes.Value),c=this.addInputPin("Angle",[0],VVVV.PinTypes.Value),f=this.addOutputPin("X1",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Y1",[0],VVVV.PinTypes.Value),
k=this.addOutputPin("X2",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Y2",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var j=parseFloat(g.getValue(b)),n=parseFloat(e.getValue(b)),r=parseFloat(d.getValue(b)),u=2*parseFloat(c.getValue(b)-0.25)*Math.PI,s=r/2*Math.sin(u),r=-r/2*Math.cos(u);f.setValue(b,j+s);h.setValue(b,n+r);k.setValue(b,j-s);m.setValue(b,n-r)}f.setSliceCount(a);h.setSliceCount(a);k.setSliceCount(a);m.setSliceCount(a)}};
VVVV.Nodes.Vector2Points2d.prototype=new VVVV.Core.Node;VVVV.Nodes.Polar3d=function(a,b){this.constructor(a,"Polar (3d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),d=this.addInputPin("Z",[-1],VVVV.PinTypes.Value),c=this.addOutputPin("Pitch",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Yaw",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Length",[1],VVVV.PinTypes.Value);
this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var l=g.getValue(b),p=e.getValue(b),j=d.getValue(b),n=Math.sqrt(l*l+p*p+j*j);f.setValue(b,Math.atan2(-l,-j)/(2*Math.PI));c.setValue(b,0==n?0:Math.acos(-p/n)/(2*Math.PI)-0.25);h.setValue(b,n)}f.setSliceCount(a);c.setSliceCount(a);h.setSliceCount(a)}};VVVV.Nodes.Polar3d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Cartesian3d=function(a,b){this.constructor(a,"Cartesian (3d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Pitch",[0],VVVV.PinTypes.Value),e=this.addInputPin("Yaw",[0],VVVV.PinTypes.Value),d=this.addInputPin("Length",[1],VVVV.PinTypes.Value),c=this.addOutputPin("X",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Z",[1],VVVV.PinTypes.Value);
this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var l=2*(g.getValue(b)+0.25)*Math.PI,p=2*e.getValue(b)*Math.PI,j=d.getValue(b);h.setValue(b,-j*Math.cos(p)*Math.sin(l));c.setValue(b,-j*Math.sin(p)*Math.sin(l));f.setValue(b,-j*Math.cos(l))}c.setSliceCount(a);f.setSliceCount(a);h.setSliceCount(a)}};VVVV.Nodes.Cartesian3d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Normalize3d=function(a,b){this.constructor(a,"Normalize (3d)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("X",[1],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),d=this.addInputPin("Z",[0],VVVV.PinTypes.Value),c=this.addOutputPin("NormalizedX",[1],VVVV.PinTypes.Value),f=this.addOutputPin("NormalizedY",[0],VVVV.PinTypes.Value),h=this.addOutputPin("NormalizedZ",
[0],VVVV.PinTypes.Value),k=this.addOutputPin("Input Length",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var p=g.getValue(b),j=e.getValue(b),n=d.getValue(b),r=Math.sqrt(p*p+j*j+n*n);c.setValue(b,0==r?0:p/r);f.setValue(b,0==r?0:j/r);h.setValue(b,0==r?0:n/r);k.setValue(b,r)}c.setSliceCount(a);f.setSliceCount(a);h.setSliceCount(a);k.setSliceCount(a)}};VVVV.Nodes.Normalize3d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Normalize3dVector=function(a,b){this.constructor(a,"Normalize (3d Vector)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("XYZ",[],VVVV.PinTypes.Value),e=this.addOutputPin("NormalizedXYZ",[],VVVV.PinTypes.Value),d=this.addOutputPin("Input Length",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c/3;f++){var h=g.getValue(f,3),a=Math.sqrt(h[0]*
h[0]+h[1]*h[1]+h[2]*h[2]);e.setValue(3*f,0==a?0:h[0]/a);e.setValue(3*f+1,0==a?0:h[1]/a);e.setValue(3*f+2,0==a?0:h[2]/a);d.setValue(f,a)}e.setSliceCount(3*Math.ceil(c/3));d.setSliceCount(Math.ceil(c/3))}};VVVV.Nodes.Normalize3dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Multiply3dCross=function(a,b){this.constructor(a,"Multiply (3d Cross)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input1 XYZ",[],VVVV.PinTypes.Value),e=this.addInputPin("Input2 XYZ",[],VVVV.PinTypes.Value),d=this.addOutputPin("Output XYZ",[],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c/3;f++){var h=g.getValue(f,3),a=e.getValue(f,
3);d.setValue(3*f+0,h[1]*a[2]-h[2]*a[1]);d.setValue(3*f+1,-(h[0]*a[2]-h[2]*a[0]));d.setValue(3*f+2,h[0]*a[1]-h[1]*a[0])}d.setSliceCount(3*Math.ceil(c/3))}};VVVV.Nodes.Multiply3dCross.prototype=new VVVV.Core.Node;
VVVV.Nodes.Multiply3dDot=function(a,b){this.constructor(a,"Multiply (3d Dot)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input1 XYZ",[],VVVV.PinTypes.Value),e=this.addInputPin("Input2 XYZ",[],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c/3;f++){var h=g.getValue(f,3),a=e.getValue(f,3);d.setValue(f,
h[0]*a[0]+h[1]*a[1]+h[2]*a[2])}d.setSliceCount(Math.ceil(c/3))}};VVVV.Nodes.Multiply3dDot.prototype=new VVVV.Core.Node;
VVVV.Nodes.Multiply3dVector=function(a,b){this.constructor(a,"Multiply (3d Vector)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),e=this.addInputPin("XYZ UnTransformed",[0,0,0],VVVV.PinTypes.Value),d=this.addOutputPin("XYZ Transformed",[0,0,0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=Math.max(g.getSliceCount(),e.getSliceCount()/3),f=0;f<
c;f++){var h=e.getValue(3*f,3),a=g.getValue(f);mat4.multiplyVec3(a,h);d.setValue(3*f+0,h[0]);d.setValue(3*f+1,h[1]);d.setValue(3*f+2,h[2])}d.setSliceCount(Math.ceil(3*c))}};VVVV.Nodes.Multiply3dVector.prototype=new VVVV.Core.Node;VVVV.Nodes.LFO=function(a,b){this.constructor(a,"LFO (Animation)",b);this.meta={authors:["Matthias Zauner, sebl"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Not spreadable yet"]};this.auto_evaluate=!0;var g=this.addInputPin("Period",[1],VVVV.PinTypes.Value),e=this.addInputPin("Pause",[0],VVVV.PinTypes.Value),d=this.addInputPin("Reverse",[0],VVVV.PinTypes.Value),c=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),f=this.addInputPin("Phase",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Output",
[0],VVVV.PinTypes.Value),k=this.addOutputPin("Cycles",[0],VVVV.PinTypes.Value),m=[],l=[],p=(new Date).getTime(),j=(new Date).getTime();this.evaluate=function(){var a=this.getMaxInputSliceCount();p=(new Date).getTime()-j;for(var b=0;b<a;b++){var u=g.getValue(b%g.values.length),s=e.getValue(b%e.values.length),q=d.getValue(b%d.values.length),v=c.getValue(b%c.values.length),t=f.getValue(b%f.values.length);void 0==m[b]&&(m[b]=0);void 0==l[b]&&(l[b]=0);0.5>s&&(0!=u&&isFinite(u))&&(dv=1/(1E3*u)*p,0<q&&(dv*=
-1),m[b]+=dv,0>m[b]&&(l[b]-=Math.ceil(-m[b]),m[b]=1+m[b]),1<m[b]&&(l[b]+=Math.floor(m[b])));j=(new Date).getTime();0.5<=v&&(m[b]=0,l[b]=0);if(0.5>s||0.5<=v)h.setValue(b,(m[b]+t)%1),k.setValue(b,l[b]);m[b]%=1}h.setSliceCount(a);k.setSliceCount(a);m.splice(a);l.splice(a)}};VVVV.Nodes.LFO.prototype=new VVVV.Core.Node;
VVVV.Nodes.LinearFilter=function(a,b){this.constructor(a,"LinearFilter (Animation)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Sometimes doesnt stop when target reached","Cyclic Pin not implemented","Acceleration and Velocitity Out are not set yet"]};this.auto_evaluate=!0;var g=this.addInputPin("Go To Position",[0],VVVV.PinTypes.Value),e=this.addInputPin("FilterTime",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Position Out",[0],VVVV.PinTypes.Value);
this.addOutputPin("Velocity Out",[0],VVVV.PinTypes.Value);this.addOutputPin("Acceleration Out",[0],VVVV.PinTypes.Value);var c=[],f=[],h=[],k=[],m=[];this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=g.pinIsChanged()||e.pinIsChanged(),j=0;j<a;j++){void 0==c[j]&&(c[j]=(new Date).getTime());var n=(new Date).getTime()-c[j],r=parseFloat(g.getValue(j)),u=parseFloat(e.getValue(j));void 0==f[j]&&(f[j]=r);!isFinite(r)||!isFinite(u)?(f[j]=void 0,d.setValue(j,void 0)):(b&&(k[j]=void 0,m[j]=0<=
r-f[j],h[j]=0<u?(r-f[j])/(1E3*u):0),m[j]==0<=r-f[j]&&(f[j]+=h[j]*n),void 0!=k[j]&&0<=r-f[j]!=0<=k[j]&&(h[j]=0,f[j]=r),0!=k[j]&&d.setValue(j,f[j]),k[j]=r-f[j],c[j]=(new Date).getTime())}b&&d.getSliceCount()!=a&&(c.splice(a),f.splice(a),h.splice(a),k.splice(a),d.setSliceCount(a))}};VVVV.Nodes.LinearFilter.prototype=new VVVV.Core.Node;
VVVV.Nodes.Delay=function(a,b){this.constructor(a,"Delay (Animation)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Reset not implemented","Linear Mode not implemented"]};this.auto_evaluate=!0;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Time",[1],VVVV.PinTypes.Value),d=this.addInputPin("Insert",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),f=[],h=Array(1024);this.evaluate=
function(){var a=this.getMaxInputSliceCount();now=(new Date).getTime();var b=g.pinIsChanged();if(void 0==g.getValue(0))b&&c.setValue(0,void 0);else{if(1==d.getValue(0)&&(b||e.pinIsChanged())){h.pop();h.unshift(now);for(b=0;b<a;b++){if(void 0==f[b]){f[b]=Array(1024);for(var l=1024;l--;)f[b][l]=0}1024<=f[b].length&&f[b].pop();f[b].unshift(g.getValue(b))}}for(b=0;b<a;b++){for(var p=now-1E3*e.getValue(b),j=!1,l=0;1024>l;l++)if(h[l]<=p){c.values[b]!=f[b][l]&&c.setValue(b,f[b][l]);j=!0;break}!j&&0!=c.values[b]&&
c.setValue(b,0)}c.setSliceCount(a);f.splice(a)}}};VVVV.Nodes.Delay.prototype=new VVVV.Core.Node;
VVVV.Nodes.Change=function(a,b){this.constructor(a,"Change (Animation)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("OnChange",[0],VVVV.PinTypes.Value),d=[];this.evaluate=function(){var c=this.getMaxInputSliceCount();if(g.pinIsChanged()){for(var f=0;f<c;f++)d[f]!=g.getValue(f)?e.setValue(f,1):1==e.getValue(f)&&e.setValue(f,0),d[f]=g.getValue(f);
e.setSliceCount(c)}else{for(f=0;f<c;f++)1==e.getValue(f)&&(e.setValue(f,0),e.setSliceCount(c));d[f]=g.getValue(f)}}};VVVV.Nodes.Change.prototype=new VVVV.Core.Node;
VVVV.Nodes.TogEdge=function(a,b){this.constructor(a,"TogEdge (Animation)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Up Edge",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Down Edge",[0],VVVV.PinTypes.Value),c=[];this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),h=0;h<f;h++)(0>=Math.round(c[h])||void 0==c[h])&&1<=Math.round(g.getValue(h))?
e.setValue(h,1):0!=e.values[h]&&e.setValue(h,0),1<=Math.round(c[h])&&0>=Math.round(g.getValue(h))?d.setValue(h,1):0!=d.values[h]&&d.setValue(h,0),c[h]=g.getValue(h);e.setSliceCount(f);d.setSliceCount(f)}};VVVV.Nodes.TogEdge.prototype=new VVVV.Core.Node;
VVVV.Nodes.FlipFlop=function(a,b){this.constructor(a,"FlipFlop (Animation)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Set",[0],VVVV.PinTypes.Value),e=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Inverse Output",[1],VVVV.PinTypes.Value),f=!1;this.evaluate=function(){var h=this.getMaxInputSliceCount(),a=d.getSliceCount();if(h>a)for(;a<
h;a++)d.setValue(a,0),c.setValue(a,1);for(a=0;a<h;a++){var b=void 0;1<=Math.round(e.getValue(a))&&(b=0);1<=Math.round(g.getValue(a))&&(b=1);void 0!=b?(d.setValue(a,b),c.setValue(a,1-b)):f||(d.setValue(a,0),c.setValue(a,1))}d.setSliceCount(h);c.setSliceCount(h);f=!0}};VVVV.Nodes.FlipFlop.prototype=new VVVV.Core.Node;
VVVV.Nodes.SampleAndHold=function(a,b){this.constructor(a,"S+H (Animation)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["different output slice count in pure VVVV, if Set pin has only one slice"]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Set",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var c=this.getMaxInputSliceCount();if(e.pinIsChanged()||
g.pinIsChanged()){for(var f=0;f<c;f++)void 0==d.values[f]&&d.setValue(f,0),1<=Math.round(e.getValue(f))&&d.setValue(f,g.getValue(f));d.setSliceCount(c)}}};VVVV.Nodes.SampleAndHold.prototype=new VVVV.Core.Node;
VVVV.Nodes.FrameDelay=function(a,b){this.constructor(a,"FrameDelay (Animation)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["no dynamice pin count"]};this.delays_output=!0;var g=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Default 1",[0],VVVV.PinTypes.Value),d=this.addInputPin("Initialize",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Output 1",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),
h=0;h<f;h++)0.5<d.getValue(h)?c.setValue(h,e.getValue(h)):c.setValue(h,g.getValue(h));c.setSliceCount(f)}};VVVV.Nodes.FrameDelay.prototype=new VVVV.Core.Node;
VVVV.Nodes.Toggle=function(a,b){this.constructor(a,"Toggle (Animation)",b);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)"],original_authors:["VVVV Group"],credits:["Matthias Zauner"],compatibility_issues:[]};this.auto_evaluate=!0;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Inverse Output",[1],VVVV.PinTypes.Value),f=!1;this.evaluate=function(){var h=this.getMaxInputSliceCount(),
a=d.getSliceCount();if(h>a)for(;a<h;a++)d.setValue(a,0),c.setValue(a,1);for(a=0;a<h;a++){var b=void 0;1<=Math.round(e.getValue(a))&&(b=0);1<=Math.round(g.getValue(a))&&(b=1-parseFloat(d.getValue(a)));void 0!=b&&d.getValue(a)!=b?(d.setValue(a,b),c.setValue(a,1-b)):f||(d.setValue(a,0),c.setValue(a,1))}d.setSliceCount(h);c.setSliceCount(h);f=!0}};VVVV.Nodes.Toggle.prototype=new VVVV.Core.Node;
VVVV.Nodes.Counter=function(a,b){this.constructor(a,"Counter (Animation)",b);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)","Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var g=this.addInputPin("Up",[0],VVVV.PinTypes.Value),e=this.addInputPin("Down",[0],VVVV.PinTypes.Value),d=this.addInputPin("Minimum",[0],VVVV.PinTypes.Value),c=this.addInputPin("Maximum",[15],VVVV.PinTypes.Value),f=this.addInputPin("Increment",[1],VVVV.PinTypes.Value),
h=this.addInputPin("Default",[0],VVVV.PinTypes.Value),k=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),m=this.addInputPin("Mode",["Wrap"],VVVV.PinTypes.Value),l=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),p=this.addOutputPin("Underflow",[0],VVVV.PinTypes.Value),j=this.addOutputPin("Overflow",[0],VVVV.PinTypes.Value),n=!1;this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=d.pinIsChanged()||c.pinIsChanged()||h.pinIsChanged()||k.pinIsChanged()||m.pinIsChanged(),s=0;s<a;s++)(1==
j.getValue(s)||!n)&&j.setValue(s,0),(1==p.getValue(s)||!n)&&p.setValue(s,0),n||l.setValue(s,0),b=b||0.5<=g.getValue(s)||0.5<=e.getValue(s);if(b){for(s=0;s<a;s++){var b=parseFloat(f.getValue(s)),q=s>=l.getSliceCount()?0:parseFloat(l.getValue(s)),v=parseFloat(c.getValue(s)),t=parseFloat(d.getValue(s)),w=0;"Unlimited"==m.getValue(s)&&(w=1);"Clamp"==m.getValue(s)&&(w=2);switch(w){case 1:0.5<=g.getValue(s)&&(q+=b);0.5<=e.getValue(s)&&(q-=b);break;case 2:0.5<=g.getValue(s)&&(q+=b);0.5<=e.getValue(s)&&(q-=
b);q>v&&(q=v,j.setValue(s,1));q<t&&(q=t,p.setValue(s,1));break;default:0.5<=g.getValue(s)&&(q+=b),0.5<=e.getValue(s)&&(q-=b),q>v&&(q=t,j.setValue(s,1)),q<t&&(q=v,p.setValue(s,1))}l.getValue(s)!=q&&l.setValue(s,q);0.5<=k.getValue(s)&&l.setValue(s,h.getValue(s))}l.setSliceCount(a);p.setSliceCount(a);j.setSliceCount(a)}n=!0}};VVVV.Nodes.Counter.prototype=new VVVV.Core.Node;VVVV.Nodes.CurrentTimeAstronomy=function(a,b){this.constructor(a,"CurrentTime (Astronomy)",b);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:["http://javascript.about.com/library/bldst.htm"],compatibility_issues:["Time Zone index differs from classic VVVV","Time Zone Name does not work in Firefox"]};this.auto_evaluate=!0;var g=new Date,e=this.addOutputPin("GMT",[],VVVV.PinTypes.Value),d=this.addOutputPin("Time Zone",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Time Zone Name",
[""],VVVV.PinTypes.String);this.addOutputPin("Daylight Saving Time",[g.getTimezoneOffset()<function(c){var f=new Date(c.getFullYear(),0,1);c=new Date(c.getFullYear(),6,1);return Math.max(f.getTimezoneOffset(),c.getTimezoneOffset())}(g)?1:0],VVVV.PinTypes.Value);var f=this.addOutputPin("Current Time",[],VVVV.PinTypes.Value);this.evaluate=function(){var h=new Date,a=36E5*h.getTimezoneOffset(),b=h.getTime();e.setValue(0,b/1E3/60/60/24+25569);d.setValue(0,a/1E3/60/60);h.toString().match(/\((.+)\)$/)?
c.setValue(0,h.toString().match(/\((.+)\)$/)[1]):c.setValue(0,"n/a");f.setValue(0,(b-a)/1E3/60/60/24+25569)}};VVVV.Nodes.CurrentTimeAstronomy.prototype=new VVVV.Core.Node;
VVVV.Nodes.GregorianAstronomySplit=function(a,b){this.constructor(a,"Gregorian (Astronomy Split)",b);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Time",[41491.4301],VVVV.PinTypes.Value),e=this.addOutputPin("Millisecond",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Second",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Minute",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Hour",[0],VVVV.PinTypes.Value),
h=this.addOutputPin("DayOfWeek",[0],VVVV.PinTypes.Value),k=this.addOutputPin("Day",[1],VVVV.PinTypes.Value),m=this.addOutputPin("Month",[1],VVVV.PinTypes.Value),l=this.addOutputPin("Year",[2E3],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var n=864E5*(g.getValue(b)-25569),n=new Date(n);x=n.getMilliseconds();x!=e.values[b]&&e.setValue(b,x);x=n.getSeconds();x!=d.values[b]&&d.setValue(b,x);x=n.getMinutes();x!=c.values[b]&&c.setValue(b,x);x=n.getHours();
x!=f.values[b]&&f.setValue(b,x);x=n.getDay();x!=h.values[b]&&h.setValue(b,x);x=n.getDate();x!=k.values[b]&&k.setValue(b,x);x=n.getMonth()+1;x!=m.values[b]&&m.setValue(b,x);x=n.getYear()+1900;x!=l.values[b]&&l.setValue(b,x)}e.setSliceCount(a);d.setSliceCount(a);c.setSliceCount(a);f.setSliceCount(a);h.setSliceCount(a);k.setSliceCount(a);m.setSliceCount(a);l.setSliceCount(a)}};VVVV.Nodes.GregorianAstronomySplit.prototype=new VVVV.Core.Node;VVVV.Nodes.And=function(a,b){this.constructor(a,"AND (Boolean)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var g=this.addInputPin("Input 1",[1],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[1],VVVV.PinTypes.Value);this.evaluate=function(){if(g.pinIsChanged()||e.pinIsChanged()){for(var c=0;c<this.getMaxInputSliceCount();c++)1<=Math.round(g.getValue(c))&&
1<=Math.round(e.getValue(c))?d.setValue(c,1):d.setValue(c,0);d.setSliceCount(this.getMaxInputSliceCount())}}};VVVV.Nodes.And.prototype=new VVVV.Core.Node;
VVVV.Nodes.Or=function(a,b){this.constructor(a,"OR (Boolean)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var g=this.addInputPin("Input 1",[1],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[1],VVVV.PinTypes.Value);this.evaluate=function(){if(g.pinIsChanged()||e.pinIsChanged()){for(var c=0;c<this.getMaxInputSliceCount();c++)1<=Math.round(g.getValue(c))||
1<=Math.round(e.getValue(c))?d.setValue(c,1):d.setValue(c,0);d.setSliceCount(this.getMaxInputSliceCount())}}};VVVV.Nodes.Or.prototype=new VVVV.Core.Node;
VVVV.Nodes.Not=function(a,b){this.constructor(a,"NOT (Boolean)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[1],VVVV.PinTypes.Value),e=this.addOutputPin("Output",[1],VVVV.PinTypes.Value);this.evaluate=function(){if(g.pinIsChanged()){for(var d=0;d<this.getMaxInputSliceCount();d++)e.setValue(d,1-Math.round(parseFloat(g.getValue(d))));e.setSliceCount(this.getMaxInputSliceCount())}}};
VVVV.Nodes.Not.prototype=new VVVV.Core.Node;
VVVV.Nodes.OrSpectral=function(a,b){this.constructor(a,"OR (Boolean Spectral)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0,h=0,a=!1,b=0;b<c||0<e.getValue(0)&&(0<h||0!=f%e.values.length);b++)0==h&&(a=!1),
a=a||0.5<=g.getValue(b),h++,0<e.getValue(0)?h>=e.getValue(f)&&(d.setValue(f,a?1:0),f++,h=0):d.setValue(0,a?1:0);d.setSliceCount(f+(0<h))}};VVVV.Nodes.OrSpectral.prototype=new VVVV.Core.Node;
VVVV.Nodes.AndSpectral=function(a,b){this.constructor(a,"AND (Boolean Spectral)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0,h=0,a=!1,b=0;b<c||0<e.getValue(0)&&(0<h||0!=f%e.values.length);b++)0==h&&(a=
!0),a=a&&0.5<=g.getValue(b),h++,0<e.getValue(0)?h>=e.getValue(f)&&(d.setValue(f,a?1:0),f++,h=0):d.setValue(0,a?1:0);d.setSliceCount(f+(0<h))}};VVVV.Nodes.AndSpectral.prototype=new VVVV.Core.Node;VVVV.Types.CanvasTexture={imageObject:void 0,loaded:!1};
VVVV.Types.CanvasRenderState=function(){this.fillColor=[1,1,1,1];this.strokeColor=[0,0,0,0];this.lineWidth=1;this.capStyle="butt";this.joinStyle="miter";this.gradient={type:"none"};this.shadowBlur=this.shadowOffsetY=this.shadowOffsetX=0;this.shadowColor=[0,0,0,1];this.blendMode="source-over";this.copy_attributes=function(a){this.fillColor=a.fillColor;this.strokeColor=a.strokeColor;this.lineWidth=a.lineWidth;this.capStyle=a.capStyle;this.joinStyle=a.joinStyle;this.gradient=a.gradient;this.shadowOffsetX=
a.shadowOffsetX;this.shadowOffsetY=a.shadowOffsetY;this.shadowBlur=a.shadowBlur;this.shadowColor=a.shadowColor;this.blendMode=a.blendMode};this.apply=function(a){if("none"!=this.gradient.type){if("linear"==this.gradient.type)var b=a.createLinearGradient(this.gradient.startX,this.gradient.startY,this.gradient.endX,this.gradient.endY);for(var g=Math.max(this.gradient.colors.length,this.gradient.colorPositions.length),e=0;e<g;e++){var d=this.gradient.colors[e];b.addColorStop(this.gradient.colorPositions[e],
"rgba("+parseInt(255*d[0])+","+parseInt(255*d[1])+","+parseInt(255*d[2])+","+d[3]+")")}a.fillStyle=b}else a.fillStyle="rgba("+parseInt(255*this.fillColor[0])+","+parseInt(255*this.fillColor[1])+","+parseInt(255*this.fillColor[2])+","+this.fillColor[3]+")";a.strokeStyle="rgba("+parseInt(255*this.strokeColor[0])+","+parseInt(255*this.strokeColor[1])+","+parseInt(255*this.strokeColor[2])+","+this.strokeColor[3]+")";a.lineWidth=this.lineWidth/a.canvas.height;a.lineCap=this.capStyle;a.lineJoin=this.joinStyle;
a.shadowOffsetX=this.shadowOffsetX;a.shadowOffsetY=this.shadowOffsetY;a.shadowBlur=this.shadowBlur;a.shadowColor="rgba("+parseInt(255*this.shadowColor[0])+","+parseInt(255*this.shadowColor[1])+","+parseInt(255*this.shadowColor[2])+","+this.shadowColor[3]+")";a.globalCompositeOperation=this.blendMode}};var defaultRenderState=new VVVV.Types.CanvasRenderState,invisibleRenderState=new VVVV.Types.CanvasRenderState;invisibleRenderState.fillColor=[0,0,0,0];
VVVV.PinTypes.CanvasRenderState={typeName:"CanvasRenderState",reset_on_disconnect:!0,defaultValue:function(){return defaultRenderState}};var defaultCanvasLayer=function(){this.draw=function(){}};VVVV.PinTypes.CanvasLayer={typeName:"CanvasLayer",reset_on_disconnect:!0,defaultValue:defaultCanvasLayer};
VVVV.Nodes.FillCanvas=function(a,b){this.constructor(a,"Fill (Canvas VVVVjs RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color),d=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),c=[];this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),h=0;h<f;h++)void 0==c[h]&&
(c[h]=new VVVV.Types.CanvasRenderState),c[h].copy_attributes(g.getValue(h)),c[h].fillColor=e.getValue(h).split(","),d.setValue(h,c[h]);d.setSliceCount(f)}};VVVV.Nodes.FillCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.StrokeCanvas=function(a,b){this.constructor(a,"Stroke (Canvas VVVVjs RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color),d=this.addInputPin("Width",[1],VVVV.PinTypes.Value),c=this.addInputPin("Cap Style",["butt"],VVVV.PinTypes.Enum);c.enumOptions=["butt","round","square"];var f=this.addInputPin("Join Style",
["miter"],VVVV.PinTypes.Enum);f.enumOptions=["miter","round","bevel"];var h=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),k=[];this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++)void 0==k[b]&&(k[b]=new VVVV.Types.CanvasRenderState),k[b].copy_attributes(g.getValue(b)),k[b].strokeColor=e.getValue(b).split(","),k[b].lineWidth=d.getValue(b),k[b].capStyle=c.getValue(b),k[b].joinStyle=f.getValue(b),h.setValue(b,k[b]);h.setSliceCount(a)}};
VVVV.Nodes.StrokeCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.ShadowCanvas=function(a,b){this.constructor(a,"Shadow (Canvas VVVVjs RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Color",["0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color),d=this.addInputPin("Offset X",[0],VVVV.PinTypes.Value),c=this.addInputPin("Offset Y",[0],VVVV.PinTypes.Value),f=this.addInputPin("Blur",[0],VVVV.PinTypes.Value),
h=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),k=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==k[a]&&(k[a]=new VVVV.Types.CanvasRenderState),k[a].copy_attributes(g.getValue(a)),k[a].shadowOffsetX=d.getValue(a),k[a].shadowOffsetY=c.getValue(a),k[a].shadowBlur=f.getValue(a),k[a].shadowColor=e.getValue(a).split(","),h.setValue(a,k[a]);h.setSliceCount(b)}};VVVV.Nodes.ShadowCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.BlendCanvas=function(a,b){this.constructor(a,"Blend (Canvas VVVVjs RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Mode",["source-over"],VVVV.PinTypes.Enum);e.enumOptions="source-over source-out source-in source-atop destination-over destination-out destination-in destination-atop copy lighter xor".split(" ");var d=this.addOutputPin("Render State Out",
[],VVVV.PinTypes.CanvasRenderState),c=[];this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),h=0;h<f;h++)void 0==c[h]&&(c[h]=new VVVV.Types.CanvasRenderState),c[h].copy_attributes(g.getValue(h)),c[h].blendMode=e.getValue(h),d.setValue(h,c[h]);d.setSliceCount(f)}};VVVV.Nodes.BlendCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.LinearGradientCanvas=function(a,b){this.constructor(a,"LinearGradient (Canvas VVVVjs RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Start X",[0],VVVV.PinTypes.Value),d=this.addInputPin("Start Y",[0],VVVV.PinTypes.Value),c=this.addInputPin("End X",[0],VVVV.PinTypes.Value),f=this.addInputPin("End Y",[0],VVVV.PinTypes.Value),h=this.addInputPin("Colors",
["1.0, 1.0, 1.0, 1.0","0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color),k=this.addInputPin("Color Positions",[0,1],VVVV.PinTypes.Value),m=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),l=[];this.evaluate=function(){for(var a=Math.max(g.values.length,e.values.length),a=Math.max(a,d.values.length),a=Math.max(a,c.values.length),a=Math.max(a,f.values.length),b=0;b<a;b++){void 0==l[b]&&(l[b]=new VVVV.Types.CanvasRenderState);l[b].copy_attributes(g.getValue(b));l[b].gradient={type:"linear"};
l[b].gradient.startX=e.getValue(b);l[b].gradient.startY=d.getValue(b);l[b].gradient.endX=c.getValue(b);l[b].gradient.endY=f.getValue(b);l[b].gradient.colors=[];l[b].gradient.colorPositions=[];for(var n=Math.max(h.values.length,k.values.length),r=0;r<n;r++)l[b].gradient.colors.push(h.getValue(r).split(",")),l[b].gradient.colorPositions.push(k.getValue(r));m.setValue(b,l[b])}m.setSliceCount(a)}};VVVV.Nodes.LinearGradientCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.ArcCanvas=function(a,b){this.constructor(a,"Arc (Canvas VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),d=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),c=this.addInputPin("Radius",[1],VVVV.PinTypes.Value),f=this.addInputPin("Start Angle",[0],VVVV.PinTypes.Value),h=this.addInputPin("End Angle",
[0.5],VVVV.PinTypes.Value),k=this.addInputPin("Draw Segment",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),l=[],p=function(){this.transform=mat4.create();mat4.identity(this.transform);this.startAngle=0;this.endAngle=0.5;this.strokeColor=[1,1,1,1];this.lineWidth=1;this.renderState=defaultRenderState;this.clippingLayer=void 0;this.drawSegment=!1;this.draw=function(c,f){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&
c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);c.beginPath();f?invisibleRenderState.apply(c):this.renderState.apply(c);this.drawSegment&&(c.moveTo(0,0),c.lineTo(Math.cos(this.startAngle)*this.radius,Math.sin(this.startAngle)*this.radius));c.arc(0,0,this.radius,this.startAngle,this.endAngle,!1);this.drawSegment&&(c.moveTo(Math.cos(this.endAngle)*this.radius,Math.sin(this.endAngle)*this.radius),c.lineTo(0,0));0<this.renderState.fillColor[3]&&
c.fill();0<this.renderState.strokeColor[3]&&c.stroke();c.restore();c.restore()}};this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++)void 0==l[b]&&(l[b]=new p),l[b].transform=e.getValue(b),l[b].radius=parseFloat(c.getValue(b)),l[b].startAngle=2*parseFloat(f.getValue(b))*Math.PI,l[b].endAngle=2*parseFloat(h.getValue(b))*Math.PI,l[b].renderState=g.getValue(b),l[b].drawSegment=1==k.getValue(b),d.isConnected()&&(l[b].clippingLayer=d.getValue(b));for(b=0;b<l.length;b++)m.setValue(b,
l[b]);m.setSliceCount(a)}};VVVV.Nodes.ArcCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.RectangleCanvas=function(a,b){this.constructor(a,"Rectangle (Canvas VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),d=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),c=this.addInputPin("Width",[1],VVVV.PinTypes.Value),f=this.addInputPin("Height",[1],VVVV.PinTypes.Value),h=this.addInputPin("Corner Radius",
[0],VVVV.PinTypes.Value),k=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),m=[],l=function(){this.transform=mat4.create();mat4.identity(this.transform);this.renderState=defaultRenderState;this.clippingLayer=void 0;this.draw=function(c,f){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);c.beginPath();f?invisibleRenderState.apply(c):
this.renderState.apply(c);var d=this.width/2,e=d-this.cornerRadius,h=this.height/2,b=h-this.cornerRadius,a=-d,g=-e,k=-h,l=-b;c.moveTo(g,k);c.lineTo(e,k);c.arc(e,l,this.cornerRadius,1.5*Math.PI,0,!1);c.lineTo(d,b);c.arc(e,b,this.cornerRadius,0,0.5*Math.PI,!1);c.lineTo(g,h);c.arc(g,b,this.cornerRadius,0.5*Math.PI,Math.PI,!1);c.lineTo(a,l);c.arc(g,l,this.cornerRadius,Math.PI,1.5*Math.PI,!1);c.closePath();0<this.renderState.fillColor[3]&&c.fill();0<this.renderState.strokeColor[3]&&c.stroke();c.restore();
c.restore()}};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==m[a]&&(m[a]=new l),m[a].transform=e.getValue(a),m[a].width=c.getValue(a),m[a].height=f.getValue(a),m[a].cornerRadius=h.getValue(a),m[a].renderState=g.getValue(a),d.isConnected()&&(m[a].clippingLayer=d.getValue(a));for(a=0;a<m.length;a++)k.setValue(a,m[a]);k.setSliceCount(b)}};VVVV.Nodes.RectangleCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.TextCanvas=function(a,b){this.constructor(a,"Text (Canvas VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),d=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),c=this.addInputPin("Text",["VVVV.js"],VVVV.PinTypes.String),f=this.addInputPin("Font",["10px sans-serif"],VVVV.PinTypes.String),
h=this.addInputPin("Align",["start"],VVVV.PinTypes.Enum);h.enumOptions=["start","left","end","right","center"];var k=this.addInputPin("Baseline",["alphabetic"],VVVV.PinTypes.Enum);k.enumOptions="top hanging middle alphabetic ideographic bottom".split(" ");var m=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),l=[],p=function(){this.transform=mat4.create();mat4.identity(this.transform);this.text="VVVV.js";this.font="sans-serif";this.align="start";this.baseline="top";this.renderState=defaultRenderState;
this.clippingLayer=void 0;this.draw=function(c,f){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);c.scale(0.01,-0.01);c.font="100px "+this.font;c.textAlign=this.align;c.textBaseline=this.baseline;f?invisibleRenderState.apply(c):this.renderState.apply(c);0<this.renderState.fillColor[3]&&c.fillText(this.text,0,0);0<this.renderState.strokeColor[3]&&
c.strokeText(this.text,0,0);c.restore();c.restore()}};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==l[a]&&(l[a]=new p),l[a].transform=e.getValue(a),l[a].text=c.getValue(a),l[a].font=f.getValue(a),l[a].align=h.getValue(a),l[a].baseline=k.getValue(a),l[a].renderState=g.getValue(a),l[a].clippingLayer=d.getValue(a);for(a=0;a<l.length;a++)m.setValue(a,l[a]);m.setSliceCount(b)}};VVVV.Nodes.TextCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.BezierCurveCanvas=function(a,b){function g(c,f){c.x.splice(f);c.y.splice(f);c.c1x.splice(f);c.c1y.splice(f);c.c2x.splice(f);c.c2y.splice(f)}this.constructor(a,"BezierCurve (Canvas VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var e=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),d=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),c=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),f=this.addInputPin("X",
[0],VVVV.PinTypes.Value),h=this.addInputPin("Y",[0],VVVV.PinTypes.Value),k=this.addInputPin("Control 1 X",[0],VVVV.PinTypes.Value),m=this.addInputPin("Control 1 Y",[0],VVVV.PinTypes.Value),l=this.addInputPin("Control 2 X",[0],VVVV.PinTypes.Value),p=this.addInputPin("Control 2 Y",[0],VVVV.PinTypes.Value),j=this.addInputPin("BinSize",[-1],VVVV.PinTypes.Value),n=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),r=[],u=function(){this.transform=mat4.create();mat4.identity(this.transform);this.x=
[];this.y=[];this.c1x=[];this.c1y=[];this.c2x=[];this.c2y=[];this.strokeColor=[1,1,1,1];this.lineWidth=1;this.fillColor=[1,1,1,1];this.renderState=defaultRenderState;this.clippingLayer=void 0;this.draw=function(c,f){if(!(1>this.x.length)){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());f?invisibleRenderState.apply(c):this.renderState.apply(c);c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);
c.beginPath();c.moveTo(this.x[0],this.y[0]);for(var d=1;d<this.x.length;d++)c.bezierCurveTo(this.c1x[d-1]+this.x[d-1],this.c1y[d-1]+this.y[d-1],this.c2x[d]+this.x[d],this.c2y[d]+this.y[d],this.x[d],this.y[d]);0<this.renderState.fillColor[3]&&c.fill();0<this.renderState.strokeColor[3]&&c.stroke();c.restore();c.restore()}}};this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0,v=0,t=0;t<a||0<j.getValue(0)&&(0<v||0<b%d.getSliceCount());t++)void 0==r[b]&&(r[b]=new u),0==v&&(r[b].renderState=
e.getValue(b),r[b].transform=d.getValue(b),c.isConnected()&&(r[b].clippingLayer=c.getValue(b))),r[b].x[v]=parseFloat(f.getValue(t)),r[b].y[v]=parseFloat(h.getValue(t)),r[b].c1x[v]=parseFloat(k.getValue(t)),r[b].c1y[v]=parseFloat(m.getValue(t)),r[b].c2x[v]=parseFloat(l.getValue(t)),r[b].c2y[v]=parseFloat(p.getValue(t)),v++,0<j.getValue(0)&&v>=j.getValue(b)&&(v<r[b].x.length&&g(r[b],v),b++,v=0);0>j.getValue(0)&&v<r[b].x.length?(g(r[b],v),r.splice(1)):r.splice(b);for(a=0;a<r.length;a++)n.setValue(a,
r[a]);n.setSliceCount(r.length)}};VVVV.Nodes.BezierCurveCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.QuadCanvas=function(a,b){this.constructor(a,"Quad (Canvas VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),e=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),d=this.addInputPin("Texture",[],VVVV.PinTypes.HTML5Texture),c=this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color),f=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),h=[],k=
function(){this.transform=mat4.create();this.clippingLayer=void 0;mat4.identity(this.transform);this.texture=VVVV.PinTypes.HTML5Texture.defaultValue();this.color=[1,1,1,1];this.draw=function(c){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);"Empty Texture"!=this.texture?this.texture.loaded&&(c.globalAlpha=this.color[3],c.save(),
c.translate(-0.5,0.5),this.texture.videoWidth?c.scale(1/this.texture.videoWidth,-1/this.texture.videoHeight):c.scale(1/this.texture.width,-1/this.texture.height),c.drawImage(this.texture,0,0),c.restore(),c.fillStyle="rgba(0, 0, 0, .001)",c.fillRect(-0.5,-0.5,1,1),c.globalAlpha=1):(c.fillStyle="rgba("+parseInt(255*this.color[0])+", "+parseInt(255*this.color[1])+", "+parseInt(255*this.color[2])+", "+this.color[3]+")",c.fillRect(-0.5,-0.5,1,1));c.restore();c.restore()}};this.evaluate=function(){for(var a=
this.getMaxInputSliceCount(),b=0;b<a;b++)void 0==h[b]&&(h[b]=new k),h[b].transform=g.getValue(b),h[b].texture=d.getValue(b),h[b].color=c.getValue(b).split(","),e.isConnected()&&(h[b].clippingLayer=e.getValue(b));for(b=0;b<h.length;b++)f.setValue(b,h[b]);f.setSliceCount(a)}};VVVV.Nodes.QuadCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.GroupCanvas=function(a,b){this.constructor(a,"Group (Canvas VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=[],e=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer);this.initialize=function(){for(var d=0;2>d;d++)g[d]=this.addInputPin("Layer "+(d+1),[],VVVV.PinTypes.CanvasLayer)};this.evaluate=function(){for(var d=0,c=0;2>c;c++)if(g[c].isConnected())for(var f=0;f<g[c].values.length;f++)e.setValue(d++,g[c].getValue(f));
e.setSliceCount(d)}};VVVV.Nodes.GroupCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.RendererCanvas=function(a,b){this.constructor(a,"Renderer (Canvas VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Layers",[],VVVV.PinTypes.CanvasLayer);this.addInputPin("Clear",[1],VVVV.PinTypes.Value);var e=this.addInputPin("Background Color",["0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color),d=this.addInputPin("Backbuffer Width",[0],VVVV.PinTypes.Value),c=this.addInputPin("Backbuffer Height",[0],VVVV.PinTypes.Value),
f=this.addInputPin("View",[],VVVV.PinTypes.Transform),h=this.addOutputPin("Canvas Out",[],this),k,m,l,p=[0,0,0,1],j;this.getContext=function(){var f=this.invisiblePins["Descriptive Name"].getValue(0),f=$(f).get(0);if(!f||"CANVAS"!=f.nodeName){var e=parseInt(d.getValue(0)),b=parseInt(c.getValue(0));j=$('<canvas width="'+(0<e?e:512)+'" height="'+(0<b?b:512)+'" id="vvvv-js-generated-renderer-'+(new Date).getTime()+'" class="vvvv-js-generated-renderer"></canvas>');f||(f="body");$(f).append(j);j=j.get(0)}else j=
f;m=j.width;l=j.height;if(j&&j.getContext){var h=j;$(h).detach("mousemove");$(h).detach("mousedown");$(h).detach("mouseup");VVVV.MousePositions[h.id]={x:0,y:0,wheel:0,lb:0,mb:0,rb:0};$(h).mousemove(function(c){var f=2*(c.pageX-$(this).offset().left)/$(this).width()-1;c=-(2*(c.pageY-$(this).offset().top)/$(this).height()-1);VVVV.MousePositions._all.x=f;VVVV.MousePositions._all.y=c;VVVV.MousePositions[h.id].x=f;VVVV.MousePositions[h.id].y=c});$(h).bind("mousewheel",function(c){c=c.originalEvent.wheelDelta/
120;VVVV.MousePositions[h.id].wheel+=c;VVVV.MousePositions._all.wheel+=c});$(h).bind("DOMMouseScroll",function(c){c=-c.originalEvent.detail/3;VVVV.MousePositions[h.id].wheel+=c;VVVV.MousePositions._all.wheel+=c});$(h).mousedown(function(c){switch(c.which){case 1:VVVV.MousePositions._all.lb=1;VVVV.MousePositions[h.id].lb=1;break;case 2:VVVV.MousePositions._all.mb=1;VVVV.MousePositions[h.id].mb=1;break;case 3:VVVV.MousePositions._all.rb=1,VVVV.MousePositions[h.id].rb=1}});$(h).mouseup(function(c){switch(c.which){case 1:VVVV.MousePositions._all.lb=
0;VVVV.MousePositions[h.id].lb=0;break;case 2:VVVV.MousePositions._all.mb=0;VVVV.MousePositions[h.id].mb=0;break;case 3:VVVV.MousePositions._all.rb=0,VVVV.MousePositions[h.id].rb=0}});k=j.getContext("2d");j.ctx=k}};this.evaluate=function(){this.invisiblePins["Descriptive Name"].pinIsChanged()&&($(j).hasClass("vvvv-js-generated-renderer")&&$(j).remove(),this.getContext());if(k){if(d.pinIsChanged()){var b=parseInt(d.getValue(0));0<b&&(m=b,$(j).attr("width",m))}c.pinIsChanged()&&(b=parseInt(c.getValue(0)),
0<b&&(l=b,$(j).attr("height",l)));e.pinIsChanged()&&(p=e.getValue(0).split(","),p[0]=parseInt(255*p[0]),p[1]=parseInt(255*p[1]),p[2]=parseInt(255*p[2]));defaultRenderState.apply(k);k.clearRect(0,0,m,l);k.save();k.translate(m/2,l/2);k.scale(m/2,-l/2);f.isConnected()&&(b=f.getValue(0),k.transform(b[0],b[1],b[4],b[5],b[12],b[13]));if(g.isConnected())for(b=0;b<g.values.length;b++)g.getValue(b).draw(k);k.restore();defaultRenderState.apply(k);k.globalCompositeOperation="destination-over";k.fillStyle="rgba("+
p[0]+","+p[1]+","+p[2]+","+p[3]+")";k.fillRect(0,0,m,l);h.setValue(0,j);j.loaded=!0}}};VVVV.Nodes.RendererCanvas.prototype=new VVVV.Core.Node;VVVV.PinTypes.Color={typeName:"Color",reset_on_disconnect:!1,defaultValue:function(){return"1.0, 1.0, 1.0, 1.0"},primitive:!0,hsvToRgb:function(a,b,g){a*=360;var e=Math.floor(a/60),d=a/60-e;a=g*(1-b);var c=g*(1-b*d);b=g*(1-b*(1-d));switch(e){case 1:return[c,g,a];case 2:return[a,g,b];case 3:return[a,c,g];case 4:return[b,a,g];case 5:return[g,a,c];default:return[g,b,a]}},rgbToHsv:function(a,b,g){var e=Math.max(a,Math.max(b,g)),d=Math.min(a,Math.min(b,g)),c;e==d?c=0:e==a?c=60*(0+(b-g)/(e-d)):e==b?c=60*
(2+(g-a)/(e-d)):e==g&&(c=60*(4+(a-b)/(e-d)));0>c&&(c+=360);a=0;0!=e&&(a=(e-d)/e);return[c/360,a,e]}};
VVVV.Nodes.RGBJoin=function(a,b){this.constructor(a,"RGB (Color Join)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Red",[1],VVVV.PinTypes.Value),e=this.addInputPin("Green",[1],VVVV.PinTypes.Value),d=this.addInputPin("Blue",[1],VVVV.PinTypes.Value),c=this.addInputPin("Alpha",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",["1.0,1.0,1.0,1.0"],VVVV.PinTypes.Color);this.evaluate=function(){if(g.pinIsChanged()||
e.pinIsChanged||d.pinIsChanged()||c.pinIsChanged()){for(var h=this.getMaxInputSliceCount(),b=0;b<h;b++){var a=g.getValue(b)||0,l=e.getValue(b)||0,p=d.getValue(b)||0,j=c.getValue(b)||0;f.setValue(b,a+","+l+","+p+","+j)}f.setSliceCount(h)}}};VVVV.Nodes.RGBJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.HSVJoin=function(a,b){this.constructor(a,"HSV (Color Join)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Hue",[0.33],VVVV.PinTypes.Value),e=this.addInputPin("Saturation",[0],VVVV.PinTypes.Value),d=this.addInputPin("Value",[1],VVVV.PinTypes.Value),c=this.addInputPin("Alpha",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",["1.0,1.0,1.0,1.0"],VVVV.PinTypes.Color);this.evaluate=function(){for(var b=
this.getMaxInputSliceCount(),a=0;a<b;a++){var m=g.getValue(a),l=e.getValue(a),p=d.getValue(a),j=c.getValue(a),m=VVVV.PinTypes.Color.hsvToRgb(m,l,p);f.setValue(a,m[0]+","+m[1]+","+m[2]+","+j)}f.setSliceCount(b)}};VVVV.Nodes.HSVJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.IOBoxColor=function(a,b){this.constructor(a,"IOBox (Color)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Color Input",["0.0, 1.0, 0.0, 1.0"],VVVV.PinTypes.Color),e=this.addOutputPin("Color Output",["0.0, 1.0, 0.0, 1.0"],VVVV.PinTypes.Color);this.addInvisiblePin("Rows",[1],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d;c++)e.setValue(c,
g.getValue(c));e.setSliceCount(d)}};VVVV.Nodes.IOBoxColor.prototype=new VVVV.Core.Node;
VVVV.Nodes.SetAlphaColor=function(a,b){this.constructor(a,"SetAlpha (Color)",b);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",["0.0, 0.0, 0.0, 0.0"],VVVV.PinTypes.Color),e=this.addInputPin("Alpha",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",["0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c;f++){var b=g.getValue(f),a=e.getValue(f);
d.setValue(f,b.replace(/[^, ]+$/,a))}d.setSliceCount(c)}};VVVV.Nodes.SetAlphaColor.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchColorInput=function(a,b){this.constructor(a,"Switch (Color Input)",b);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=[];e[0]=this.addInputPin("Input 1",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);e[1]=this.addInputPin("Input 2",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);var d=this.addOutputPin("Output",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);this.addInvisiblePin("Input Count",
[2],VVVV.PinTypes.Value);this.evaluate=function(){var c=this.getMaxInputSliceCount();if(this.hasNilInputs())d.setSliceCount(0);else{for(var f=0;f<c;f++)d.setValue(f,e[Math.round(Math.abs(g.getValue(f)))%e.length].getValue(f));d.setSliceCount(c)}}};VVVV.Nodes.SwitchColorInput.prototype=new VVVV.Core.Node;VVVV.Nodes.Abs=function(a,b){this.constructor(a,"Abs (Complex)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input Real",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input Imagiary",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c;f++)d.setValue(f,Math.sqrt(Math.pow(parseFloat(g.getValue(f)),2)+Math.pow(parseFloat(e.getValue(f)),
2)));d.setSliceCount(c)}};VVVV.Nodes.Abs.prototype=new VVVV.Core.Node;VVVV.Nodes.String2Enum=function(a,b){this.constructor(a,"String2Enum (Enumerations)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Validation check does not work"]};var g=this.addInputPin("String Value",[],VVVV.PinTypes.String),e=this.addOutputPin("Enum",[],VVVV.PinTypes.Enum);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d;c++)e.setValue(c,g.getValue(c));e.setSliceCount(d)}};VVVV.Nodes.String2Enum.prototype=new VVVV.Core.Node;VVVV.PinTypes.HTML5Texture={typeName:"HTML5Texture",reset_on_disconnect:!0,defaultValue:function(){return"Empty Texture"}};
VVVV.Nodes.FileTextureCanvas=function(a,b){this.constructor(a,"FileTexture (HTML5 VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var g=this.addInputPin("Filename",[],VVVV.PinTypes.String),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.HTML5Texture),d=this.addOutputPin("Width",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Height",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Up and Running",[0],VVVV.PinTypes.Value),
h=[],k=!1;this.evaluate=function(){var b=this.getMaxInputSliceCount();if(g.pinIsChanged()){for(var a=0;a<b;a++){var p=VVVV.Helpers.prepareFilePath(g.getValue(a),this.parentPatch);0===p.indexOf("http://")&&void 0!==VVVV.ImageProxyPrefix&&(p=VVVV.ImageProxyPrefix+encodeURI(p));if(void 0==h[a]||h[a].origSrc!=p)h[a]=new Image,h[a].loaded=!1,h[a].origSrc=p,h[a].onload=function(c){return function(){k=h[c].loaded=!0}}(a),h[a].src=p,f.setValue(a,0),e.setValue(a,h[a])}h.length=b;e.setSliceCount(b);d.setSliceCount(b);
c.setSliceCount(b);f.setSliceCount(b)}if(k){for(a=0;a<b;a++)e.setValue(a,h[a]),d.setValue(a,h[a].width),c.setValue(a,h[a].height),f.setValue(a,h[a].loaded?1:0);k=!1}}};VVVV.Nodes.FileTextureCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.FileStreamCanvas=function(a,b){this.constructor(a,"FileStream (HTML5 VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var g=["NETWORK_EMPTY","NETWORK_IDLE","NETWORK_LOADING","NETWORK_NO_SOURCE"],e=["HAVE_NOTHING","HAVE_METADATA","HAVE_FUTURE_DATA","HAVE_ENOUGH_DATA","HAVE_CURRENT_DATA"],d=this.addInputPin("Play",[1],VVVV.PinTypes.Value),c=this.addInputPin("Loop",[0],VVVV.PinTypes.Value),f=this.addInputPin("Start Time",
[0],VVVV.PinTypes.Value),h=this.addInputPin("End Time",[-1],VVVV.PinTypes.Value),k=this.addInputPin("Do Seek",[0],VVVV.PinTypes.Value),m=this.addInputPin("Seek Position",[0],VVVV.PinTypes.Value),l=this.addInputPin("Filename",["http://html5doctor.com/demos/video-canvas-magic/video.ogg"],VVVV.PinTypes.String),p=this.addOutputPin("Video",[],this),j=this.addOutputPin("Audio",[],this),n=this.addOutputPin("Duration",[0],VVVV.PinTypes.Value),r=this.addOutputPin("Position",[0],VVVV.PinTypes.Value),u=this.addOutputPin("Video Width",
[0],VVVV.PinTypes.Value),s=this.addOutputPin("Video Height",[0],VVVV.PinTypes.Value),q=this.addOutputPin("Network Status",[""],VVVV.PinTypes.String),v=this.addOutputPin("Ready Status",[""],VVVV.PinTypes.String),t=[];this.evaluate=function(){var b=this.getMaxInputSliceCount();if(l.pinIsChanged())for(var a=0;a<b;a++){filename=VVVV.Helpers.prepareFilePath(l.getValue(a),this.parentPatch);if(void 0==t[a]){var y=$('<video style="display:none"><source src="" type=video/ogg></video>');$("body").append(y);
t[a]=y[0];t[a].volume=0;y=function(){return function(){}}(a);t[a].onprogress=y;t[a].oncanplay=y;t[a].oncanplaythrough=y}filename!=t[a].currentSrc&&($(t[a]).find("source").first().attr("src",filename),t[a].load(),0.5<d.getValue(a)?t[a].play():t[a].pause(),t[a].loaded=!0,p.setValue(a,t[a]),j.setValue(a,t[a]))}if(d.pinIsChanged())for(a=0;a<b;a++)0.5<d.getValue(a)?t[a].play():t[a].pause();if(k.pinIsChanged())for(a=0;a<b;a++)t[a%t.length].loaded&&0.5<=k.getValue(a)&&(t[a%t.length].currentTime=parseFloat(m.getValue(a)),
0.5<d.getValue(a)&&t[a].play());for(a=0;a<b;a++){if(!t[a].paused){p.setValue(a,t[a]);j.setValue(a,t[a]);n.getValue(a)!=t[a].duration&&n.setValue(a,t[a].duration);r.setValue(a,t[a].currentTime);var y=parseFloat(h.getValue(a)),F=parseFloat(f.getValue(a));t[a].currentTime<F&&(t[a].currentTime=F);if(t[a].currentTime>=t[a].duration||0<=y&&t[a].currentTime>=y)0.5<=c.getValue(a)?t[a].currentTime=F:t[a].pause()}if(t[a].videoWidth!=u.getValue(a)||t[a].videoHeight!=s.getValue(a))u.setValue(a,t[a].videoWidth),
s.setValue(a,t[a].videoHeight);q.getValue(a)!=g[t[a].networkState]&&q.setValue(a,g[t[a].networkState]);v.getValue(a)!=e[t[a].readyState]&&v.setValue(a,e[t[a].readyState])}p.setSliceCount(b);j.setSliceCount(b)}};VVVV.Nodes.FileStreamCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.AudioOutHTML5=function(a,b){this.constructor(a,"AudioOut (HTML5 VVVVjs)",b);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var g=this.addInputPin("Audio",[],this),e=this.addInputPin("Volume",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){var d=this.getMaxInputSliceCount();if(e.pinIsChanged())for(var c=0;c<d;c++)g.getValue(c).volume=Math.max(0,Math.min(1,parseFloat(e.getValue(c))))}};VVVV.Nodes.AudioOutHTML5.prototype=new VVVV.Core.Node;VVVV.Nodes.HTTPGet=function(a,b){this.constructor(a,"HTTP (Network Get)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Doesnt handle get variables yet","Doesnt support proxies","No header output pin yet"]};this.auto_evaluate=!0;var g=this.addInputPin("URL",["http://localhost"],VVVV.PinTypes.String),e=this.addInputPin("Name",[""],VVVV.PinTypes.String),d=this.addInputPin("Value",[""],VVVV.PinTypes.String),c=this.addInputPin("Refresh",[0],
VVVV.PinTypes.Value),f=this.addOutputPin("Status",[""],VVVV.PinTypes.String),h=this.addOutputPin("Body",[""],VVVV.PinTypes.String),k=this.addOutputPin("Fail",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Success",[0],VVVV.PinTypes.Value),l,p,j,n=!1;this.evaluate=function(){this.getMaxInputSliceCount();var a=g.pinIsChanged()||e.pinIsChanged()||d.pinIsChanged()||c.pinIsChanged()&&1==c.getValue(0);1==m.getValue(0)&&m.setValue(0,0);1==k.getValue(0)&&k.setValue(0,0);n&&(h.setValue(0,l),f.setValue(0,void 0),
m.setValue(0,p),k.setValue(0,j),n=!1);a&&(void 0==g.getValue(0)?(h.setValue(0,""),f.setValue(0,"")):$.ajax({url:g.getValue(0),type:"get",success:function(c){l=c;p=1;n=!0},error:function(){l="";j=1;n=!0}}))}};VVVV.Nodes.HTTPGet.prototype=new VVVV.Core.Node;VVVV.PinTypes.Node={typeName:"Node"};
VVVV.Nodes.IOBoxNode=function(a,b){this.constructor(a,"IOBox (Node)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input Node",[],VVVV.PinTypes.Node),e=this.addOutputPin("Output Node",[],VVVV.PinTypes.Node);this.initialize=function(){g.connectionChangedHandlers.nodepin=function(){if(this.isConnected()){var d;0<this.links.length?d=this.links[0].fromPin:this.masterPin&&(d=this.masterPin);this.setType(VVVV.PinTypes[d.typeName]);
e.setType(VVVV.PinTypes[d.typeName]);e.slavePin&&e.slavePin.setType(VVVV.PinTypes[d.typeName])}else e.isConnected()||(this.setType(VVVV.PinTypes.Node),e.setType(VVVV.PinTypes.Node),e.slavePin&&e.slavePin.setType(VVVV.PinTypes.Node))};e.connectionChangedHandlers.nodepin=function(){if(this.isConnected()){var d;0<this.links.length?d=this.links[0].toPin:this.slavePin&&(d=this.slavePin);this.setType(VVVV.PinTypes[d.typeName]);g.setType(VVVV.PinTypes[d.typeName]);g.masterPin&&g.masterPin.setType(VVVV.PinTypes[d.typeName])}else g.isConnected()||
(this.setType(VVVV.PinTypes.Node),g.setType(VVVV.PinTypes.Node),g.masterPin&&g.masterPin.setType(VVVV.PinTypes.Node))}};this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d;c++)e.setValue(c,g.getValue(c));e.setSliceCount(d)}};VVVV.Nodes.IOBoxNode.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchNodeInput=function(a,b){this.constructor(a,"Switch (Node Input)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var g=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),d=[],c=this.addOutputPin("Output",[0],VVVV.PinTypes.Node);this.initialize=function(){for(var c=e.getValue(0),a=d.length;a<c;a++)d[a]=this.addInputPin("Input "+(a+1),
[],VVVV.PinTypes.Node);d.length=c};this.evaluate=function(){e.pinIsChanged()&&this.initialize();if(void 0==g.getValue(0))c.setValue(0,void 0);else{for(var f=d[Math.round(Math.abs(g.getValue(0)))%d.length],a=f.getSliceCount(),b=0;b<a;b++)c.setValue(b,f.getValue(b));c.setSliceCount(a)}}};VVVV.Nodes.SwitchNodeInput.prototype=new VVVV.Core.Node;VVVV.Nodes.BoundsSpectral=function(a,b){this.constructor(a,"Bounds (Spectral)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value),d=this.addOutputPin("Center",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Width",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Minimum",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Maximum",
[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0,l=0,p,j,n,r=0;r<a||0<e.getValue(0)&&(0<l||0!=b%e.values.length);r++)p=g.getValue(r),0==l&&(center=j=n=p,width=0),j=Math.min(p,j),n=Math.max(p,n),l++,0<e.getValue(0)&&l>=e.getValue(b)&&(f.setValue(b,j),h.setValue(b,n),d.setValue(b,j+(n-j)/2),c.setValue(b,Math.abs(n-j)),b++,l=0);-1==e.getValue(0)&&(f.setValue(b,j),h.setValue(b,n),d.setValue(b,j+(n-j)/2),c.setValue(b,Math.abs(n-j)));d.setSliceCount(b+(0<l));
c.setSliceCount(b+(0<l));f.setSliceCount(b+(0<l));h.setSliceCount(b+(0<l))}};VVVV.Nodes.BoundsSpectral.prototype=new VVVV.Core.Node;VVVV.Nodes.GetSliceSpreads=function(a,b){this.constructor(a,"GetSlice (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Bin Size not implemented"]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addInputPin("Bin Size",[1],VVVV.PinTypes.Value);this.addInputPin("Index",[0],VVVV.PinTypes.Value);this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.inputPins.Index.values.length,b=0;b<a;b++)this.outputPins.Output.setValue(b,
parseFloat(this.inputPins.Input.getValue(Math.round(this.inputPins.Index.getValue(b)))));this.outputPins.Output.setSliceCount(a)}};VVVV.Nodes.GetSliceSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.SetSliceSpreads=function(a,b){this.constructor(a,"SetSlice (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Spread",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input",[0],VVVV.PinTypes.Value),d=this.addInputPin("Index",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var f=g.getSliceCount(),a=0;a<f;a++)c.setValue(a,
g.getValue(a));size=Math.max(e.getSliceCount(),d.getSliceCount());for(a=0;a<size;a++)c.setValue(d.getValue(a)%f,e.getValue(a));c.setSliceCount(f)}};VVVV.Nodes.SetSliceSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.RandomSpread=function(a,b){function g(a){for(var d=[],c=0,f=0,b=0;256>b;b++)d[b]=b;for(var g=0,b=0;256>b;b++){var g=(g+d[b]+a.charCodeAt(b%a.length))%256,m=d[b];d[b]=d[g];d[g]=m}this.getRandomNumber=function(){for(var a=0,b=1,e=0;8>e;e++){c=(c+1)%256;f=(f+d[c])%256;var h=d[c];d[c]=d[f];d[f]=h;a+=d[(d[c]+d[f])%256]*b;b*=256}return a/1.8446744073709552E19}}this.constructor(a,"RandomSpread (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:["http://www.webdeveloper.com/forum/showthread.php?t=140572"],
compatibility_issues:["Doesnt handle spreaded inputs","random result will differ from original vvvv node because of different algorithm"]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addInputPin("Width",[1],VVVV.PinTypes.Value);this.addInputPin("Random Seed",[0],VVVV.PinTypes.Value);this.addInputPin("Spread Count",[1],VVVV.PinTypes.Value);this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var a=parseInt(this.inputPins["Spread Count"].getValue(0)),d=parseFloat(this.inputPins.Input.getValue(0)),
c=parseFloat(this.inputPins.Width.getValue(0)),f=parseInt(this.inputPins["Random Seed"].getValue(0));rng=new g(f.toString());this.outputPins.Output.setSliceCount(a);for(f=0;f<a;f++)this.outputPins.Output.setValue(f,rng.getRandomNumber()*c-c/2+d)}};VVVV.Nodes.RandomSpread.prototype=new VVVV.Core.Node;
VVVV.Nodes.SortSpreads=function(a,b){this.constructor(a,"Sort (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.addOutputPin("Former Index",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=_(this.inputPins.Input.values).map(function(a,c){return[a,c]}),a=_(a).sortBy(function(a){return a[0]}),b=0;b<a.length;b++)this.outputPins.Output.setValue(b,
a[b][0]),this.outputPins["Former Index"].setValue(b,a[b][1]);this.outputPins.Output.setSliceCount(a.length);this.outputPins["Former Index"].setSliceCount(a.length)}};VVVV.Nodes.SortSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.LinearSpread=function(a,b){this.constructor(a,"LinearSpread (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["phase does not work with Block alignment"]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Width",[1],VVVV.PinTypes.Value),d=this.addInputPin("Alignment",["Centered"],VVVV.PinTypes.Enum);d.enumOptions=["Centered","Block","LeftJustified","RightJustified"];var c=this.addInputPin("Phase",
[0],VVVV.PinTypes.Value),f=this.addInputPin("Spread Count",[1],VVVV.PinTypes.Value),h=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var a=parseInt(f.getValue(0)),b=parseFloat(e.getValue(0)),l=parseFloat(c.getValue(0)),p=parseFloat(g.getValue(0)),j=d.getValue(0);""==j&&(j="Centered");var n=b/a;"Block"==j&&(n=b/(a-1));var r=n/2;if("Block"==j||"LeftJustified"==j)r=0;"RightJustified"==j&&(r=n);for(var u,s=0;s<a;s++)u=s*n+r,"Block"!=j&&0!=b&&(u=(u+l*b)%b),u=p-b/2+u,h.setValue(s,
u.toFixed(4));h.setSliceCount(a)}};VVVV.Nodes.LinearSpread.prototype=new VVVV.Core.Node;
VVVV.Nodes.AvoidNil=function(a,b){this.constructor(a,"AvoidNIL (Spreads)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["Kalle"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Default",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){if(g.pinIsChanged()||e.pinIsChanged()){var c=g;void 0==g.values[0]&&(c=e);for(var f=0;f<c.values.length;f++)d.setValue(f,
c.getValue(f));d.setSliceCount(c.getSliceCount())}}};VVVV.Nodes.AvoidNil.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwapDim=function(a,b){this.constructor(a,"SwapDim (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["BinSize not implemented"]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Column Count",[0],VVVV.PinTypes.Value),d=this.addInputPin("Row Count",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var f=parseInt(e.getValue(0)),a=parseInt(d.getValue(0)),
b=f*a,m=0;m<b;m++)c.setValue(m%f*a+parseInt(m/f),g.getValue(m));c.setSliceCount(b)}};VVVV.Nodes.SwapDim.prototype=new VVVV.Core.Node;
VVVV.Nodes.I=function(a,b){this.constructor(a,"I (Spreads)",b);this.meta={authors:["M\u00f3r\u00e1sz D\u00e1vid (micro.D)"],original_authors:["VVVV Group"],credits:["Matthias Zauner"],compatibility_issues:["This has no phase pin.",'Smaller "from" than "to" isn\'t working yet']};var g=this.addInputPin("[ From ..",[0],VVVV.PinTypes.Value),e=this.addInputPin(".. To [",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var c=Math.round(g.getValue(0)),
f=Math.round(e.getValue(0)),a=0;if(c<=f){for(var b=c;b<f;b++,a++)d.setValue(a,b);d.setSliceCount(f-c)}else{for(b=c;b>f;b--,a++)d.setValue(a,b);d.setSliceCount(c-f)}}};VVVV.Nodes.I.prototype=new VVVV.Core.Node;
VVVV.Nodes.CircularSpread=function(a,b){this.constructor(a,"CircularSpread (Spreads)",b);this.meta={authors:["Matija Miloslavich"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["only x and y inputs are spreadable"]};this.inpxin=this.addInputPin("Input X",[0],VVVV.PinTypes.Value);this.inpyin=this.addInputPin("Input Y",[0],VVVV.PinTypes.Value);this.widhin=this.addInputPin("Width",[1],VVVV.PinTypes.Value);this.heightin=this.addInputPin("Height",[1],VVVV.PinTypes.Value);this.factorin=
this.addInputPin("Factor",[1],VVVV.PinTypes.Value);this.phasein=this.addInputPin("Phase",[0],VVVV.PinTypes.Value);this.sprcntin=this.addInputPin("Spread Count",[1],VVVV.PinTypes.Value);this.xout=this.addOutputPin("Output X",[0],VVVV.PinTypes.Value);this.yout=this.addOutputPin("Output Y",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=0.5*parseFloat(this.widhin.getValue(0)),b=0.5*parseFloat(this.heightin.getValue(0)),d=parseFloat(this.factorin.getValue(0)),c=parseFloat(this.phasein.getValue(0)),
f=parseInt(this.sprcntin.getValue(0)),h=2*Math.PI,c=h*c,k=0,m=Math.max(this.inpyin.getSliceCount(),this.inpxin.getSliceCount()),l=0;l<m*f;l++)for(var p=parseFloat(this.inpxin.getValue(l)),j=parseFloat(this.inpyin.getValue(l)),n=0;n<f;n++){var r=c+h*(n/f)*d,u=p+Math.cos(r)*a,r=j+Math.sin(r)*b;this.xout.setValue(k,u);this.yout.setValue(k,r);k++}this.xout.setSliceCount(f*m);this.yout.setSliceCount(f*m)}};VVVV.Nodes.CircularSpread.prototype=new VVVV.Core.Node;
VVVV.Nodes.ReverseSpreads=function(a,b){this.constructor(a,"Reverse (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=g.getSliceCount(),c=0;c<a;c++){var f=g.getValue(c);e.setValue(a-c-1,f)}e.setSliceCount(a)}};VVVV.Nodes.ReverseSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.IntegralSpreads=function(a,b){this.constructor(a,"Integral (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Offset",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var c=g.getSliceCount(),f=parseFloat(e.getValue(0));d.setValue(0,f);for(var a=0;a<c;a++){var b=parseFloat(g.getValue(a)),
f=f+b;d.setValue(a+1,f)}d.setSliceCount(c+1)}};VVVV.Nodes.IntegralSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.ConsSpreads=function(a,b){this.constructor(a,"Cons (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=[],e=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),d=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value);this.initialize=function(){for(var c=d.getValue(0),f=g.length;f<c;f++)g[f]=this.addInputPin("Input "+(f+1),[0],VVVV.PinTypes.Value);g.length=c};this.evaluate=function(){d.pinIsChanged()&&
this.initialize();for(var c=0,f=0;f<g.length;f++)for(var a=0;a<g[f].getSliceCount();a++)e.setValue(c++,g[f].getValue(a));e.setSliceCount(c)}};VVVV.Nodes.ConsSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.IntervalSpreads=function(a,b){this.constructor(a,"Interval (Spreads)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Intervals",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Index",[0],VVVV.PinTypes.Value),c=0;this.evaluate=function(){var f=g.getSliceCount(),a=e.getSliceCount();if(e.pinIsChanged()){c=void 0;for(var b=0;b<a;b++)if(e.getValue(b)<
c||void 0==c)c=e.getValue(b)}for(b=0;b<f;b++){var m=g.getValue(b);if(m<c)d.setValue(b,-1);else{for(var l=0;l<a-1&&!(m>=e.getValue(l)&&m<e.getValue(l+1));l++);d.setValue(b,l)}}d.setSliceCount(f)}};VVVV.Nodes.IntervalSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.QueueSpreads=function(a,b){this.constructor(a,"Queue (Spreads)",b);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Insert",[0],VVVV.PinTypes.Value),d=this.addInputPin("Frame Count",[1],VVVV.PinTypes.Value),c=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[],VVVV.PinTypes.Value),h=this.addOutputPin("Output Bin Size",
[],VVVV.PinTypes.Value);this.evaluate=function(){var a=e.getValue(0),b=d.getValue(0),l=c.getValue(0),p=!1;if(0.5<=a&&0.5>l){a=g.getSliceCount();for(p=a-1;0<=p;p--)f.values.unshift(g.getValue(p));h.values.unshift(a);p=!0}if(d.pinIsChanged()||p){for(p=currFrameCount=h.values.length;p>b;p--)f.values.splice(-h.values[p-1]);h.values.splice(b);p=!0}if(p){for(p=0;p<f.values.length;p++)f.setValue(p,f.values[p]);for(p=0;p<h.values.length;p++)h.setValue(p,h.values[p])}0.5<=l&&(f.setSliceCount(0),h.setSliceCount(0))}};
VVVV.Nodes.QueueSpreads.prototype=new VVVV.Core.Node;VVVV.Nodes.IOBoxString=function(a,b){this.constructor(a,"IOBox (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInvisiblePin("Rows",[1],VVVV.PinTypes.Value);this.addInputPin("SliceOffset",[0],VVVV.PinTypes.Value);this.addInputPin("Input String",[""],VVVV.PinTypes.String);this.addOutputPin("Output String",[""],VVVV.PinTypes.String);this.evaluate=function(){this.outputPins["Output String"].setSliceCount(this.inputPins["Input String"].getSliceCount());
for(var a=0;a<this.inputPins["Input String"].getSliceCount();a++)this.outputPins["Output String"].setValue(a,this.inputPins["Input String"].values[a])}};VVVV.Nodes.IOBoxString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchStringInput=function(a,b){this.constructor(a,"Switch (String Input)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var g=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=[];e[0]=this.addInputPin("Input 1",["text"],VVVV.PinTypes.String);e[1]=this.addInputPin("Input 2",["text"],VVVV.PinTypes.String);var d=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.evaluate=function(){var c=
this.getMaxInputSliceCount();if(void 0==g.getValue(0))d.setValue(0,void 0);else{for(var f=0;f<c;f++)d.setValue(f,e[g.getValue(f)%e.length].getValue(f));d.setSliceCount(c)}}};VVVV.Nodes.SwitchStringInput.prototype=new VVVV.Core.Node;
VVVV.Nodes.AddString=function(a,b){this.constructor(a,"Add (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet","Intersperse *Enum* not implemented"]};var g=[];g[0]=this.addInputPin("Input 1",["text"],VVVV.PinTypes.String);g[1]=this.addInputPin("Input 2",["text"],VVVV.PinTypes.String);var e=this.addInputPin("Intersperse String",[""],VVVV.PinTypes.String),d=this.addOutputPin("Output",["texttext"],VVVV.PinTypes.String);
this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c;f++){var a=[],b=e.getValue(f);void 0==b&&(b="");for(var m=0;m<g.length;m++)a.push(g[m].getValue(f));d.setValue(f,a.join(b))}d.setSliceCount(c)}};VVVV.Nodes.AddString.prototype=new VVVV.Core.Node;
VVVV.Nodes.GetSliceString=function(a,b){this.constructor(a,"GetSlice (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Bin Size not implemented"]};var g=this.addInputPin("Input",["text"],VVVV.PinTypes.String);this.addInputPin("Bin Size",[1],VVVV.PinTypes.Value);var e=this.addInputPin("Index",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.evaluate=function(){for(var c=0;c<e.values.length;c++)d.setValue(c,
g.getValue(Math.round(e.getValue(c))));d.setSliceCount(e.getSliceCount())}};VVVV.Nodes.GetSliceString.prototype=new VVVV.Core.Node;
VVVV.Nodes.AsValue=function(a,b){this.constructor(a,"AsValue (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[],VVVV.PinTypes.String),e=this.addInputPin("Default",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c;f++){var a=g.getValue(f);/^\s*-?[0-9.e]+\s*$/.test(a)?d.setValue(f,parseFloat(a)):d.setValue(f,
parseFloat(e.getValue(f)))}d.setSliceCount(c)}};VVVV.Nodes.AsValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SortString=function(a,b){this.constructor(a,"Sort (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",["text"],VVVV.PinTypes.String);this.addInputPin("Reverse Sorting",[0],VVVV.PinTypes.Value);var e=this.addOutputPin("Output",["text"],VVVV.PinTypes.String),d=this.addOutputPin("Former Index",[0],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){xxx=
g.values;for(var c=_(g.values).map(function(c,f){return[c,f]}),c=_(c).sortBy(function(c){return c[0]}),f=0;f<c.length;f++)e.setValue(f,c[f][0]),d.setValue(f,c[f][1]);e.setSliceCount(c.length);d.setSliceCount(c.length)}};VVVV.Nodes.SortString.prototype=new VVVV.Core.Node;
VVVV.Nodes.LengthString=function(a,b){this.constructor(a,"Length (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addOutputPin("Count",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),c=0;c<a;c++){var f=g.getValue(c);e.setValue(c,f.length)}e.setSliceCount(a)}};VVVV.Nodes.LengthString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SiftString=function(a,b){this.constructor(a,"Sift (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("Filter",["text"],VVVV.PinTypes.String),d=this.addInputPin("Comparison",["Matches"],VVVV.PinTypes.Enum);d.enumOptions=["Matches","Contains","MatchesAny","ContainsAny"];var c=this.addInputPin("Case Sensitive",[0],VVVV.PinTypes.Value),
f=this.addOutputPin("Hits",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Input Index",[0],VVVV.PinTypes.Value),k=this.addOutputPin("Filter Index",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Found At Position",[0],VVVV.PinTypes.Value);this.evaluate=function(){var a=this.getMaxInputSliceCount();f.setSliceCount(a);var b=d.getValue(0);c.getValue(0);for(var j=0,n=0;n<a;n++){var r=g.getValue(n),u=1;if("MatchesAny"==b||"ContainsAny"==b)u=e.getSliceCount();for(var s=0,q=0;q<u;q++){var v=e.getValue(q+n),
t=[];if("Matches"==b||"MatchesAny"==b)v==r&&t.push(-1);else for(var v=RegExp(v,"gi"),w;w=v.exec(r);)t.push(w.index);for(v=0;v<t.length;v++)h.setValue(j,n%g.getSliceCount()),k.setValue(j,(n+q)%e.getSliceCount()),m.setValue(j,t[v]+1),j++,s++}f.setValue(n,s)}h.setSliceCount(j);k.setSliceCount(j);m.setSliceCount(j)}};VVVV.Nodes.SiftString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SeparateString=function(a,b){this.constructor(a,"Separate (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Quotes don't work"]};this.auto_evaluate=!1;var g=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("Intersperse",["None"],VVVV.PinTypes.Enum);e.enumOptions="None Space Comma CommaPlusSpace Semicolon Colon Pipe UnixPath DosPath Dash NewLineAutoDetection Dot UnderScore Minus".split(" ");var d=
this.addInputPin("Intersperse String",[""],VVVV.PinTypes.String),c=this.addInputPin("Ignore between",["Double"],VVVV.PinTypes.Enum);c.enumOptions=["Single","Double"];var f=this.addInputPin("Keep Quotes",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Output",["text"],VVVV.PinTypes.String),k=this.addOutputPin("Former Index",[0],VVVV.PinTypes.Value),m={None:"",Space:" ",Comma:",",CommaPlusSpace:", ",Semicolon:";",Colon:":",Pipe:"|",UnixPath:"/",DosPath:"\\",Dash:"-",NewLineAutoDetection:"\n",Dot:".",
UnderScore:"_",Minus:"-"},l={Single:"'",Double:'"'};this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0,n=0;n<a;n++){var r=g.getValue(n),u=m[e.getValue(n)],s=d.getValue(n),q=l[c.getValue(n)],v=f.getValue(n);""==u&&(u=s);""==u&&(u=void 0);r=r.split(u);u=r.length;q=RegExp("[^"+q+"]*","g");for(s=0;s<u;s++)1==v?h.setValue(b,r[s]):h.setValue(b,r[s].match(q).join("")),k.setValue(b,n),b++}h.setSliceCount(b);k.setSliceCount(b)}};VVVV.Nodes.SeparateString.prototype=new VVVV.Core.Node;
VVVV.Nodes.EQString=function(a,b){this.constructor(a,"EQ (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input 1",[""],VVVV.PinTypes.String),e=this.addInputPin("Input 2",[""],VVVV.PinTypes.String),d=this.addInputPin("Case Sensitive",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Inverse Output",[0],VVVV.PinTypes.Value);this.evaluate=
function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var m=g.getValue(b),l=e.getValue(b),p=d.getValue(b),m=m==l||0==p&&m.toLowerCase()==l.toLowerCase()?1:0;c.setValue(b,m);f.setValue(b,1-m)}c.setSliceCount(a);f.setSliceCount(a)}};VVVV.Nodes.EQString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SelectString=function(a,b){this.constructor(a,"Select (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[""],VVVV.PinTypes.String),e=this.addInputPin("Select",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[""],VVVV.PinTypes.String),c=this.addOutputPin("Former Slice",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),a=0,b=0;b<f;b++)for(var m=
0;m<e.getValue(b);m++)d.setValue(a,g.getValue(b)),c.setValue(a,b),a++;d.setSliceCount(a);c.setSliceCount(a)}};VVVV.Nodes.SelectString.prototype=new VVVV.Core.Node;
VVVV.Nodes.CountString=function(a,b){this.constructor(a,"Count (String)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[""],VVVV.PinTypes.String);this.addOutputPin("Count",[1],VVVV.PinTypes.Value);this.addOutputPin("High",[0],VVVV.PinTypes.Value);this.evaluate=function(){this.inputPins.Input.pinIsChanged()&&(this.outputPins.Count.setValue(0,this.inputPins.Input.values.length),this.outputPins.High.setValue(0,
this.inputPins.Input.values.length-1))}};VVVV.Nodes.CountString.prototype=new VVVV.Core.Node;
VVVV.Nodes.CleanString=function(a,b){this.constructor(a,"Clean (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),c=0;c<a;c++)g.getValue(c)?e.setValue(c,g.getValue(c).trim()):e.setValue(c,void 0);e.setSliceCount(a)}};
VVVV.Nodes.CleanString.prototype=new VVVV.Core.Node;
VVVV.Nodes.AvoidNilString=function(a,b){this.constructor(a,"AvoidNIL (String)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["Kalle"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("Default",["text"],VVVV.PinTypes.String),d=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.evaluate=function(){if(g.pinIsChanged()||e.pinIsChanged()){var c=g;void 0==g.values[0]&&(c=e);for(var f=0;f<c.values.length;f++)d.setValue(f,
c.getValue(f));d.setSliceCount(c.getSliceCount())}}};VVVV.Nodes.AvoidNilString.prototype=new VVVV.Core.Node;
VVVV.Nodes.FormatValueString=function(a,b){this.constructor(a,"FormatValue (String)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:["pad function: http://stackoverflow.com/a/10073788","thousands separator regex: http://stackoverflow.com/a/2901298"],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Characters before Comma",[1],VVVV.PinTypes.Value),d=this.addInputPin("Characters after Comma",
[0],VVVV.PinTypes.Value),c=this.addInputPin("Thousands Symbol",["None"],VVVV.PinTypes.Enum);c.enumOptions=["None","Dot","Comma","Space"];var f=this.addInputPin("Comma Symbol",["Dot"],VVVV.PinTypes.Enum);f.enumOptions=["Dot","Comma"];var h=this.addInputPin("Leading Zeroes",[0],VVVV.PinTypes.Value),k=this.addOutputPin("Output",["0"],VVVV.PinTypes.String),m={Dot:".",Comma:",",None:"",Space:" "};this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var j=g.getValue(b),n=parseInt(e.getValue(b)),
r=parseInt(d.getValue(b)),u=c.getValue(b),s=f.getValue(b),q=h.getValue(b),n=n+r+(0<r),j=parseFloat(j).toFixed(r),q=q=0.5<=q?"0":" ",j=j+"",j=j.length>=n?j:Array(n-j.length+1).join(q)+j,j=j.replace(".",m[s]).replace(/\B(?=(\d{3})+(?!\d))/g,m[u]);k.setValue(b,j)}k.setSliceCount(a)}};VVVV.Nodes.FormatValueString.prototype=new VVVV.Core.Node;VVVV.Nodes.MouseGlobal=function(a,b){this.constructor(a,"Mouse (System Global)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Cyclic mode not supported","No Mouse Wheel pin","No Left Button Pin","No Right Button Pin","No Middle Button Pin"]};this.auto_evaluate=!0;var g=this.addOutputPin("X",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Mouse Wheel",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Left Button",
[0],VVVV.PinTypes.Value),f=this.addOutputPin("Middle Button",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Right Button",[0],VVVV.PinTypes.Value),k=0,m=0,l=0,p=0,j=0,n=0;$(document).mousemove(function(c){k=2*c.pageX/parseInt($("body").css("width"))-1;m=-(2*c.pageY/parseInt($("body").css("height"))-1)});$(document).bind("mousewheel",function(c){l+=c.originalEvent.wheelDelta/120});$(document).bind("DOMMouseScroll",function(c){l+=-c.originalEvent.detail/3});$(document).mousedown(function(c){switch(c.which){case 1:p=
1;break;case 2:j=1;break;case 3:n=1}});$(document).mouseup(function(c){switch(c.which){case 1:p=0;break;case 2:j=0;break;case 3:n=0}});this.evaluate=function(){g.getValue(0)!=k&&g.setValue(0,k);e.getValue(0)!=m&&e.setValue(0,m);d.getValue(0)!=l&&d.setValue(0,l);c.getValue(0)!=p&&c.setValue(0,p);f.getValue(0)!=j&&f.setValue(0,j);h.getValue(0)!=n&&h.setValue(0,n)}};VVVV.Nodes.MouseGlobal.prototype=new VVVV.Core.Node;
VVVV.Nodes.MouseWindow=function(a,b){this.constructor(a,"Mouse (System Window)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Cyclic mode not supported","No Mouse Wheel pin","No Left Button Pin","No Right Button Pin","No Middle Button Pin"]};this.auto_evaluate=!0;var g=this.addOutputPin("X",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Mouse Wheel",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Left Button",
[0],VVVV.PinTypes.Value),f=this.addOutputPin("Middle Button",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Right Button",[0],VVVV.PinTypes.Value);this.evaluate=function(){g.getValue(0)!=VVVV.MousePositions._all.x&&g.setValue(0,VVVV.MousePositions._all.x);e.getValue(0)!=VVVV.MousePositions._all.y&&e.setValue(0,VVVV.MousePositions._all.y);d.getValue(0)!=VVVV.MousePositions._all.wheel&&d.setValue(0,VVVV.MousePositions._all.wheel);c.getValue(0)!=VVVV.MousePositions._all.lb&&c.setValue(0,VVVV.MousePositions._all.lb);
f.getValue(0)!=VVVV.MousePositions._all.mb&&f.setValue(0,VVVV.MousePositions._all.mb);h.getValue(0)!=VVVV.MousePositions._all.rb&&h.setValue(0,VVVV.MousePositions._all.rb)}};VVVV.Nodes.MouseWindow.prototype=new VVVV.Core.Node;
VVVV.Nodes.ShellExecute=function(a,b){this.constructor(a,"ShellExecute (Windows)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["This actually does something completely different from the original node: the origin node executes a shell command, this node evals javascript code"]};var g=this.addInputPin("File",[0],VVVV.PinTypes.String),e=this.addInputPin("Do Execute",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Result",[""],VVVV.PinTypes.String);
this.evaluate=function(){if(1<=Math.round(e.getValue(0))){var c=eval(g.getValue(0));!(c instanceof Array)&&!(c instanceof Object)&&(c=[c]);if(void 0!=c)for(var f=0;f<c.length;f++)d.setValue(f,c[f])}}};VVVV.Nodes.ShellExecute.prototype=new VVVV.Core.Node;
VVVV.Nodes.ScreenInfo=function(a,b){this.constructor(a,"ScreenInfo (Windows)",b);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)"],original_authors:["VVVV Group"],credits:["Matthias Zauner"],compatibility_issues:["Outputs the window size (ResolutionXY) and the document size (Working AreaXY) only","no Bits per pixel"]};var g=this.addOutputPin("ResolutionXY",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Working AreaXY",[0],VVVV.PinTypes.Value),d=0,c=0,f=0,h=0;$(document).ready(function(){c=$(window).height();
d=$(window).width();h=$(document).height();f=$(document).width()});$(window).resize(function(){c=$(window).height();d=$(window).width();h=$(document).height();f=$(document).width()});this.evaluate=function(){if(g.getValue(0)!=d||g.getValue(1)!=c)g.setValue(0,d),g.setValue(1,c);if(e.getValue(0)!=f||e.getValue(1)!=h)e.setValue(0,f),e.setValue(1,h)}};VVVV.Nodes.ScreenInfo.prototype=new VVVV.Core.Node;VVVV.PinTypes.Transform={typeName:"Transform",reset_on_disconnect:!0,defaultValue:function(){return mat4.identity(mat4.create())}};
VVVV.Nodes.Rotate=function(a,b){this.constructor(a,"Rotate (Transform)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};mat4.identity(mat4.create());this.trIn=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.xIn=this.addInputPin("X",[0],VVVV.PinTypes.Value);this.yIn=this.addInputPin("Y",[0],VVVV.PinTypes.Value);this.zIn=this.addInputPin("Z",[0],VVVV.PinTypes.Value);this.trOut=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){for(var a=this.trIn.isConnected()?this.getMaxInputSliceCount():Math.max(this.xIn.getSliceCount(),this.yIn.getSliceCount(),this.zIn.getSliceCount()),b=0;b<a;b++){var d=this.inputPins["Transform In"].getValue(b),c=parseFloat(this.inputPins.X.getValue(b)),f=parseFloat(this.inputPins.Y.getValue(b)),h=parseFloat(this.inputPins.Z.getValue(b)),k=mat4.create();mat4.identity(k);mat4.rotate(k,2*f*Math.PI,[0,1,0]);mat4.rotate(k,2*c*Math.PI,[1,0,0]);mat4.rotate(k,2*h*Math.PI,[0,0,1]);
this.trIn.isConnected()&&mat4.multiply(d,k,k);this.trOut.setValue(b,k)}this.trOut.setSliceCount(a)}};VVVV.Nodes.Rotate.prototype=new VVVV.Core.Node;
VVVV.Nodes.Translate=function(a,b){this.constructor(a,"Translate (Transform)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};mat4.identity(mat4.create());this.trIn=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.xIn=this.addInputPin("X",[0],VVVV.PinTypes.Value);this.yIn=this.addInputPin("Y",[0],VVVV.PinTypes.Value);this.zIn=this.addInputPin("Z",[0],VVVV.PinTypes.Value);this.trOut=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){for(var a=this.trIn.isConnected()?this.getMaxInputSliceCount():Math.max(this.xIn.getSliceCount(),this.yIn.getSliceCount(),this.zIn.getSliceCount()),b=0;b<a;b++){var d=parseFloat(this.xIn.getValue(b)),c=parseFloat(this.yIn.getValue(b)),f=parseFloat(this.zIn.getValue(b)),h=mat4.create();mat4.identity(h);mat4.translate(h,[d,c,f]);this.trIn.isConnected()&&(d=this.trIn.getValue(b),mat4.multiply(d,h,h));this.trOut.setValue(b,h)}this.trOut.setSliceCount(a)}};
VVVV.Nodes.Translate.prototype=new VVVV.Core.Node;
VVVV.Nodes.Scale=function(a,b){this.constructor(a,"Scale (Transform)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};mat4.identity(mat4.create());this.trIn=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.xIn=this.addInputPin("X",[1],VVVV.PinTypes.Value);this.yIn=this.addInputPin("Y",[1],VVVV.PinTypes.Value);this.zIn=this.addInputPin("Z",[1],VVVV.PinTypes.Value);this.trOut=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){for(var a=this.trIn.isConnected()?this.getMaxInputSliceCount():Math.max(this.xIn.getSliceCount(),this.yIn.getSliceCount(),this.zIn.getSliceCount()),b=0;b<a;b++){var d=parseFloat(this.inputPins.X.getValue(b)),c=parseFloat(this.inputPins.Y.getValue(b)),f=parseFloat(this.inputPins.Z.getValue(b)),h=mat4.create();mat4.identity(h);mat4.scale(h,[d,c,f]);this.inputPins["Transform In"].isConnected()&&(d=this.inputPins["Transform In"].getValue(b),mat4.multiply(d,h,h));this.trOut.setValue(b,
h)}this.trOut.setSliceCount(a)}};VVVV.Nodes.Scale.prototype=new VVVV.Core.Node;
VVVV.Nodes.Perspective=function(a,b){this.constructor(a,"Perspective (Transform)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Not spreadable"]};mat4.identity(mat4.create());this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.addInputPin("FOV",[0.25],VVVV.PinTypes.Value);this.addInputPin("Near Plane",[0.05],VVVV.PinTypes.Value);this.addInputPin("Far Plane",[100],VVVV.PinTypes.Value);this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){var a=parseFloat(this.inputPins.FOV.getValue(0)),b=parseFloat(this.inputPins["Near Plane"].getValue(0)),d=parseFloat(this.inputPins["Far Plane"].getValue(0)),c=mat4.create();mat4.identity(c);mat4.perspective(360*a,1,b,d,c);this.inputPins["Transform In"].isConnected()&&(a=this.inputPins["Transform In"].getValue(i),mat4.multiply(a,c,c));this.outputPins["Transform Out"].setValue(0,c)}};VVVV.Nodes.Perspective.prototype=new VVVV.Core.Node;
VVVV.Nodes.InverseTransform=function(a,b){this.constructor(a,"Inverse (Transform)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform),e=this.addInputPin("Source",[],VVVV.PinTypes.Transform),d=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),f=0;f<c;f++){var a=mat4.create();mat4.set(e.getValue(f),a);
mat4.multiply(g.getValue(f),mat4.inverse(a,a),a);d.setValue(f,a)}d.setSliceCount(c)}};VVVV.Nodes.InverseTransform.prototype=new VVVV.Core.Node;VVVV.Nodes.AddValue=function(a,b){this.constructor(a,"Add (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],d;this.initialize=function(){d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);for(var c=g.getValue(0),a=0;a<c;a++){var b=this.addInputPin("Input "+(a+1),[0],VVVV.PinTypes.Value);e[a]=b}};this.evaluate=function(){var c=this.getMaxInputSliceCount();
d.setSliceCount(c);for(var a=0;a<c;a++){for(var b=parseFloat(e[0].getValue(a)),g=1;g<e.length;g++)b+=parseFloat(e[g].getValue(a));d.setValue(a,b)}}};VVVV.Nodes.AddValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SubtractValue=function(a,b){this.constructor(a,"Subtract (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],d;this.initialize=function(){d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);for(var c=g.getValue(0),a=0;a<c;a++){var b=this.addInputPin("Input "+(a+1),[0],VVVV.PinTypes.Value);e[a]=b}};this.evaluate=function(){var c=this.getMaxInputSliceCount();
d.setSliceCount(c);for(var a=0;a<c;a++){for(var b=parseFloat(e[0].getValue(a)),g=1;g<e.length;g++)b-=parseFloat(e[g].getValue(a));d.setValue(a,b)}}};VVVV.Nodes.SubtractValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.EqValue=function(a,b){this.constructor(a,"EQ (Value)",b);this.meta={authors:["Matthias Zauner","Fibo"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),d=this.addInputPin("Epsilon",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Inverse Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),
b=0;b<a;b++){var m=0;Math.abs(g.getValue(b)-e.getValue(b))<=Math.abs(d.getValue(b))&&(m=1);c.setValue(b,m);f.setValue(b,1-m)}c.setSliceCount(a);f.setSliceCount(a)}};VVVV.Nodes.EqValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.GtValue=function(a,b){this.constructor(a,"GT (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var g=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){var b=0;parseFloat(g.getValue(a))>parseFloat(e.getValue(a))&&
(b=1);d.setValue(a,b)}d.setSliceCount(c)}};VVVV.Nodes.GtValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.LtValue=function(a,b){this.constructor(a,"LT (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var g=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){var b=0;parseFloat(g.getValue(a))<parseFloat(e.getValue(a))&&
(b=1);d.setValue(a,b)}d.setSliceCount(c)}};VVVV.Nodes.LtValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MultiplyValue=function(a,b){this.constructor(a,"Multiply (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],d;this.initialize=function(){d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);for(var c=g.getValue(0),a=0;a<c;a++){var b=this.addInputPin("Input "+(a+1),[0],VVVV.PinTypes.Value);e[a]=b}};this.evaluate=function(){var c=this.getMaxInputSliceCount();
d.setSliceCount(c);for(var a=0;a<c;a++){for(var b=parseFloat(e[0].getValue(a)),g=1;g<e.length;g++)b*=parseFloat(e[g].getValue(a));d.setValue(a,b)}}};VVVV.Nodes.MultiplyValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.DivideValue=function(a,b){this.constructor(a,"Divide (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInvisiblePin("Inputs Count",[2],VVVV.PinTypes.Value);var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),
a=0;a<c;a++)0==e.getValue(a)?d.setValue(a,1):d.setValue(a,g.getValue(a)/e.getValue(a));d.setSliceCount(c)}};VVVV.Nodes.DivideValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.IOBoxValueAdvanced=function(a,b){this.constructor(a,"IOBox (Value Advanced)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Y Input Value",[0],VVVV.PinTypes.Value);this.addInvisiblePin("Rows",[1],VVVV.PinTypes.Value);this.addOutputPin("Y Output Value",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.inputPins["Y Input Value"].getSliceCount(),b,d=0;d<a;d++)b=parseFloat(this.inputPins["Y Input Value"].getValue(d)),
isFinite(b)||(b=0),this.outputPins["Y Output Value"].setValue(d,b);this.outputPins["Y Output Value"].setSliceCount(this.inputPins["Y Input Value"].getSliceCount())}};VVVV.Nodes.IOBoxValueAdvanced.prototype=new VVVV.Core.Node;
VVVV.Nodes.CountValue=function(a,b){this.constructor(a,"Count (Value)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addOutputPin("Count",[1],VVVV.PinTypes.Value);this.addOutputPin("High",[0],VVVV.PinTypes.Value);this.evaluate=function(){this.inputPins.Input.pinIsChanged()&&(this.outputPins.Count.setValue(0,this.inputPins.Input.values.length),this.outputPins.High.setValue(0,
this.inputPins.Input.values.length-1))}};VVVV.Nodes.CountValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchValueInput=function(a,b){this.constructor(a,"Switch (Value Input)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var g=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=[];e[0]=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value);e[1]=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value);var d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),
a=0;a<c;a++)d.setValue(a,e[Math.round(Math.abs(g.getValue(a)))%e.length].getValue(a));d.setSliceCount(c)}};VVVV.Nodes.SwitchValueInput.prototype=new VVVV.Core.Node;
VVVV.Nodes.SelectValue=function(a,b){this.constructor(a,"Select (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Select",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Former Slice",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0,k=0;k<a;k++)for(var m=0;m<e.getValue(k);m++)d.setValue(b,
g.getValue(k)),c.setValue(b,k),b++;d.setSliceCount(b);c.setSliceCount(b)}};VVVV.Nodes.SelectValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.AsString=function(a,b){this.constructor(a,"AsString (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["SubType not implemented, always returns float formatting"]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("SubType",["Real (MinFloat .. MaxFloat)"],VVVV.PinTypes.Enum);e.enumOptions=["Real (MinFloat .. MaxFloat)","Integer (MinInt .. MaxInt)"];var d=this.addOutputPin("Output",[0],VVVV.PinTypes.String);
this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){subtype=e.getValue(a).match(/^(.+) \(/)[1];var b;switch(subtype){case "Real":b=parseFloat(g.getValue(a)).toFixed(4);break;case "Integer":b=parseInt(g.getValue(a)).toFixed(0)}d.setValue(a,b)}d.setSliceCount(c)}};VVVV.Nodes.AsString.prototype=new VVVV.Core.Node;
VVVV.Nodes.Frac=function(a,b){this.constructor(a,"Frac (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Whole Part",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Real Part",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){var b=parseFloat(g.getValue(a));e.setValue(a,Math.floor(b));d.setValue(a,b-Math.floor(b))}e.setSliceCount(c);
d.setSliceCount(c)}};VVVV.Nodes.Frac.prototype=new VVVV.Core.Node;
VVVV.Nodes.AddValueSpectral=function(a,b){this.constructor(a,"Add (Value Spectral)",b);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)","Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value);this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0,d=0,c=0;c<a||0<this.inputPins["Bin Size"].getValue(0)&&
(0<d||0!=b%this.inputPins["Bin Size"].values.length);c++){if(0==d)var f=0;f+=parseFloat(this.inputPins.Input.getValue(c));d++;0<this.inputPins["Bin Size"].getValue(0)?d>=this.inputPins["Bin Size"].getValue(b)&&(this.outputPins.Output.setValue(b,f),b++,d=0):this.outputPins.Output.setValue(0,f)}this.outputPins.Output.setSliceCount(b+(0<d))}};VVVV.Nodes.AddValueSpectral.prototype=new VVVV.Core.Node;
VVVV.Nodes.WaveShaperValue=function(a,b){this.constructor(a,"WaveShaper (Value)",b);this.meta={authors:["sebl"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Shape",["Linear"],VVVV.PinTypes.Enum);e.enumOptions=["Linear","Inverse","Triangle","Sine","Rectangle"];var d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){for(var c=
this.getMaxInputSliceCount(),a=0;a<c;a++){var b=g.getValue(a);switch(e.getValue(a)){case "Linear":d.setValue(a,b);break;case "Inverse":d.setValue(a,1-b);break;case "Triangle":0.5>b?d.setValue(a,2*b):d.setValue(a,2*(1-b));break;case "Sine":inp=6.28318530717959*((b+0.25)%1);d.setValue(a,Math.sin(inp)/2+0.5);break;case "Rectangle":0.5>b?d.setValue(a,0):d.setValue(a,1)}}d.setSliceCount(c)}};VVVV.Nodes.WaveShaperValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MapValue=function(a,b){this.constructor(a,"Map (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Mirror Mapping Mode not implemented"]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Source Minimum",[0],VVVV.PinTypes.Value),d=this.addInputPin("Source Maximum",[1],VVVV.PinTypes.Value),c=this.addInputPin("Destination Minimum",[0],VVVV.PinTypes.Value),f=this.addInputPin("Destination Maximum",
[1],VVVV.PinTypes.Value),h=this.addInputPin("Mapping",["Float"],VVVV.PinTypes.Enum);h.enumOptions=["Float","Wrap","Clamp"];var k=this.addOutputPin("Output",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var p=parseFloat(g.getValue(b)),j=parseFloat(e.getValue(b)),n=parseFloat(d.getValue(b)),r=parseFloat(c.getValue(b)),u=parseFloat(f.getValue(b)),s=h.getValue(b);if(n==j)k.setValue(b,r);else{p-=j;n-=j;switch(s){case "Clamp":p=Math.max(0,Math.min(n,
p));break;case "Wrap":p=(n+p%n)%n}k.setValue(b,p*((u-r)/n)+r)}}k.setSliceCount(a)}};VVVV.Nodes.MapValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MinValue=function(a,b){this.constructor(a,"Min (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[0],VVVV.PinTypes.Value),d=[];this.initialize=function(){for(var c=Math.max(2,e.getValue(0)),a=d.length;a<c;a++)d[a]=this.addInputPin("Input "+(a+1),[0],VVVV.PinTypes.Value);d.length=c};this.evaluate=function(){e.pinIsChanged()&&
this.initialize();for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){for(var b=void 0,k=0;k<d.length;k++)if(void 0==b||d[k].getValue(a)<b)b=d[k].getValue(a);g.setValue(a,b)}g.setSliceCount(c)}};VVVV.Nodes.MinValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MaxValue=function(a,b){this.constructor(a,"Max (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[0],VVVV.PinTypes.Value),d=[];this.initialize=function(){for(var c=Math.max(2,e.getValue(0)),a=d.length;a<c;a++)d[a]=this.addInputPin("Input "+(a+1),[0],VVVV.PinTypes.Value);d.length=c};this.evaluate=function(){e.pinIsChanged()&&
this.initialize();for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){for(var b=void 0,k=0;k<d.length;k++)if(void 0==b||d[k].getValue(a)>b)b=d[k].getValue(a);g.setValue(a,b)}g.setSliceCount(c)}};VVVV.Nodes.MaxValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.ModValue=function(a,b){this.constructor(a,"Mod (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[0],VVVV.PinTypes.Value),d=[];this.initialize=function(){for(var c=Math.max(2,e.getValue(0)),a=d.length;a<c;a++)d[a]=this.addInputPin("Input "+(a+1),[0],VVVV.PinTypes.Value);d.length=c};this.evaluate=function(){e.pinIsChanged()&&
this.initialize();for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){for(var b=d[0].getValue(a),k=1;k<d.length;k++)b=0==d[k].getValue(a)?0:b%d[k].getValue(a);g.setValue(a,b)}g.setSliceCount(c)}};VVVV.Nodes.ModValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.PowerValue=function(a,b){this.constructor(a,"Power (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[0],VVVV.PinTypes.Value),d=[];this.initialize=function(){for(var c=Math.max(2,e.getValue(0)),a=d.length;a<c;a++)d[a]=this.addInputPin("Input "+(a+1),[1],VVVV.PinTypes.Value);d.length=c};this.evaluate=function(){e.pinIsChanged()&&
this.initialize();for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){for(var b=d[0].getValue(a),k=1;k<d.length;k++)b=Math.pow(b,d[k].getValue(a));g.setValue(a,b)}g.setSliceCount(c)}};VVVV.Nodes.PowerValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.RandomValue=function(a,b){this.constructor(a,"Random (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var g=this.addInputPin("Enabled",[1],VVVV.PinTypes.Value),e=this.addInputPin("Is Integer",[0],VVVV.PinTypes.Value),d=this.addInputPin("Scale",[1],VVVV.PinTypes.Value),c=this.addInputPin("Prevent from doubles",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=
function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var m=g.getValue(b),l=e.getValue(b),p=d.getValue(b),j=c.getValue(b),n=f.values[b];void 0==n&&f.setValue(b,0);if(0.5<=m){n=f.values[b];do m=Math.random()*p,0.5<=l&&(m=Math.round(m));while(0.5<=j&&m==n);f.setValue(b,m)}}f.setSliceCount(a)}};VVVV.Nodes.RandomValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SignValue=function(a,b){this.constructor(a,"Sign (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Sign Part",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Absolute Part",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),a=0;a<c;a++){var b=g.getValue(a);e.setValue(a,0==b?0:b/Math.abs(b));
d.setValue(a,Math.abs(b))}d.setSliceCount(c)}};VVVV.Nodes.SignValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.InputMorphValue=function(a,b){this.constructor(a,"InputMorph (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),d=this.addInvisiblePin("Input Count",[0],VVVV.PinTypes.Value),c=[];this.initialize=function(){for(var a=Math.max(2,d.getValue(0)),b=c.length;b<a;b++)c[b]=this.addInputPin("Input "+
(b+1),[0],VVVV.PinTypes.Value);c.length=a};this.evaluate=function(){d.pinIsChanged()&&this.initialize();for(var a=this.getMaxInputSliceCount(),b,k,m,l=0;l<a;l++)b=g.getValue(l),k=((Math.floor(b)+c.length)%c.length+c.length)%c.length,m=((Math.ceil(b)+c.length)%c.length+c.length)%c.length,b-=Math.floor(b),e.setValue(l,(1-b)*c[k].getValue(l)+b*c[m].getValue(l));e.setSliceCount(a)}};VVVV.Nodes.InputMorphValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.Sift=function(a,b){this.constructor(a,"Sift (Value)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var g=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Filter",[0],VVVV.PinTypes.Value),d=this.addInputPin("Epsilon",[0],VVVV.PinTypes.Value),c=this.addInputPin("Find",["First"],VVVV.PinTypes.Enum);c.enumOptions=["First","Last","All"];var f=this.addOutputPin("Hits",[0],VVVV.PinTypes.Value),
h=this.addOutputPin("Input Index",[0],VVVV.PinTypes.Value),k=this.addOutputPin("Filter Index",[0],VVVV.PinTypes.Value);this.evaluate=function(){this.getMaxInputSliceCount();var a=g.getSliceCount(),b=e.getSliceCount();f.setSliceCount(a);d.getValue(0);for(var p=c.getValue(0),j={},n=0,r=0;r<a;r++){var u=r;"Last"==p&&(u=a-r-1);var s=g.getValue(u);if("All"!=p){if(j[s]){f.setValue(u,0);continue}j[s]=!0}for(var q=0,v=0;v<b;v++)if(filter=e.getValue(v),filter==s){h.setValue(n,u);k.setValue(n,v);n++;q++;break}f.setValue(u,
q)}h.setSliceCount(n);k.setSliceCount(n)}};VVVV.Nodes.Sift.prototype=new VVVV.Core.Node;VVVV.Nodes.Join2dVector=function(a,b){this.constructor(a,"Vector (2d Join)",b);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),d=this.addOutputPin("XY",[0,0],VVVV.PinTypes.Value);this.evaluate=function(){var c=this.getMaxInputSliceCount();d.setSliceCount(2*c);for(var a=0;a<c;a++)d.setValue(2*a,g.getValue(a)),d.setValue(2*a+1,e.getValue(a))}};
VVVV.Nodes.Join2dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Join3dVector=function(a,b){this.constructor(a,"Vector (3d Join)",b);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),d=this.addInputPin("Z",[0],VVVV.PinTypes.Value),c=this.addOutputPin("XYZ",[0,0,0],VVVV.PinTypes.Value);this.evaluate=function(){var a=this.getMaxInputSliceCount();c.setSliceCount(3*a);for(var b=0;b<a;b++)c.setValue(3*
b,g.getValue(b)),c.setValue(3*b+1,e.getValue(b)),c.setValue(3*b+2,d.getValue(b))}};VVVV.Nodes.Join3dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Join4dVector=function(a,b){this.constructor(a,"Vector (4d Join)",b);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),d=this.addInputPin("Z",[0],VVVV.PinTypes.Value),c=this.addInputPin("W",[0],VVVV.PinTypes.Value),f=this.addOutputPin("XYZW",[0,0,0,1],VVVV.PinTypes.Value);this.evaluate=function(){var a=this.getMaxInputSliceCount();
f.setSliceCount(4*a);for(var b=0;b<a;b++)f.setValue(4*b,g.getValue(b)),f.setValue(4*b+1,e.getValue(b)),f.setValue(4*b+2,d.getValue(b)),f.setValue(4*b+3,c.getValue(b))}};VVVV.Nodes.Join4dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Split2dVector=function(a,b){this.constructor(a,"Vector (2d Split)",b);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInputPin("XY",[0],VVVV.PinTypes.Value),e=this.addOutputPin("X",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Y",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),a=0,b=0;b<c;b+=2)e.setValue(a,g.getValue(b)),d.setValue(a,g.getValue(b+1)),a++;e.setSliceCount(a);
d.setSliceCount(a)}};VVVV.Nodes.Split2dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Split3dVector=function(a,b){this.constructor(a,"Vector (3d Split)",b);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInputPin("XYZ",[0],VVVV.PinTypes.Value),e=this.addOutputPin("X",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Z",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0,k=0;k<a;k+=3)e.setValue(b,g.getValue(k)),d.setValue(b,
g.getValue(k+1)),c.setValue(b,g.getValue(k+2)),b++;e.setSliceCount(b);d.setSliceCount(b);c.setSliceCount(b)}};VVVV.Nodes.Split3dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Split4dVector=function(a,b){this.constructor(a,"Vector (4d Split)",b);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var g=this.addInputPin("XYZW",[0,0,0,1],VVVV.PinTypes.Value),e=this.addOutputPin("X",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Z",[0],VVVV.PinTypes.Value),f=this.addOutputPin("W",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),
b=0,m=0;m<a;m+=4)e.setValue(b,g.getValue(m)),d.setValue(b,g.getValue(m+1)),c.setValue(b,g.getValue(m+2)),f.setValue(b,g.getValue(m+3)),b++;e.setSliceCount(b);d.setSliceCount(b);c.setSliceCount(b);f.setSliceCount(b)}};VVVV.Nodes.Split4dVector.prototype=new VVVV.Core.Node;VVVV.ShaderCodeResources={};VVVV.Types.ShaderCodeResource=function(){var a="";this.relatedNodes=[];this.definingNode=void 0;this.setSourceCode=function(b){a=b;for(b=0;b<this.relatedNodes.length;b++)this.relatedNodes[b].shaderSourceUpdated(a)};this.addRelatedNode=function(b){this.relatedNodes.push(b);""!=a&&b.shaderSourceUpdated(a)}};var identity=mat4.identity(mat4.create());
VVVV.Types.WebGlRenderState=function(){this.alphaBlending=!0;this.srcBlendMode="SRC_ALPHA";this.destBlendMode="ONE_MINUS_SRC_ALPHA";this.enableZWrite=!0;this.depthFunc="LEQUAL";this.depthOffset=0;this.polygonDrawMode="TRIANGLES";this.copy_attributes=function(a){this.alphaBlending=a.alphaBlending;this.alphaFunc=a.alphaFunc;this.srcBlendMode=a.srcBlendMode;this.destBlendMode=a.destBlendMode;this.enableZwrite=a.enableZWrite;this.depthFunc=a.depthFunc;this.depthOffset=a.depthOffset;this.polygonDrawMode=
a.polygonDrawMode};this.apply=function(a){this.alphaBlending?a.enable(a.BLEND):a.disable(a.BLEND);a.blendFunc(a[this.srcBlendMode],a[this.destBlendMode]);a.depthMask(this.enableZWrite)}};
VVVV.Types.VertexBuffer=function(a,b){this.vbo=void 0;this.subBuffers={};this.length=0;this.setSubBuffer=function(a,b,d){this.subBuffers[a]={usage:a,data:new Float32Array(d),size:b,offset:this.length};this.length+=this.subBuffers[a].data.byteLength};this.setSubBuffer("POSITION",3,b);this.create=function(){this.vbo=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.vbo);a.bufferData(a.ARRAY_BUFFER,this.length,a.STATIC_DRAW);_(this.subBuffers).each(function(b){a.bufferSubData(a.ARRAY_BUFFER,b.offset,
b.data)})}};VVVV.Types.Mesh=function(a,b,g){this.vertexBuffer=b;this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(g),a.STATIC_DRAW);this.numIndices=g.length};VVVV.Types.Layer=function(){this.mesh=null;this.textures=[];this.shader=null;this.uniforms={};this.uniformNames=[];this.renderState=defaultWebGlRenderState;this.toString=function(){return"Layer"}};
VVVV.PinTypes.WebGlResource={typeName:"WebGlResource",reset_on_disconnect:!0,connectionChangedHandlers:{webglresource:function(){function a(a){return"WebGlResource"==a||"WebGlTexture"==a}if(this.direction!=PinDirection.Input){var b=this.node,g=b.findDownstreamNodes("Renderer (EX9)");b.renderContexts||(b.renderContexts=[]);void 0==b.contextChanged&&(b.contextChanged=!1);for(var e=0;e<g.length;e++)b.contextChanged|=!b.renderContexts[e]||b.renderContexts[e].canvas.id!=g[e].ctxt.id,b.renderContexts[e]=
g[e].ctxt,b.dirty=!0;b.renderContexts.length!=g.length&&(b.renderContexts.length=g.length,b.contextChanged=!0,b.dirty=!0);b.isSubpatch||_(b.inputPins).each(function(d){var c;d.markPinAsChanged();"Renderer (EX9)"!=b.nodename&&d.isConnected()&&(0<d.links.length?c=d.links[0].fromPin:0<d.masterPin.links[0].fromPin.links.length&&(c=d.masterPin.links[0].fromPin),c&&a(c.typeName)&&c.connectionChanged())});this.masterPin&&a(this.masterPin.typeName)&&this.masterPin.connectionChanged()}}},defaultValue:function(){return new VVVV.Types.Layer}};
VVVV.PinTypes.WebGlTexture={typeName:"WebGlTexture",reset_on_disconnect:!0,connectionChangedHandlers:{webglresource:VVVV.PinTypes.WebGlResource.connectionChangedHandlers.webglresource},defaultValue:function(){return VVVV.DefaultTexture}};var defaultWebGlRenderState=new VVVV.Types.WebGlRenderState;VVVV.PinTypes.WebGlRenderState={typeName:"WebGlRenderState",reset_on_disconnect:!0,defaultValue:function(){return defaultWebGlRenderState}};VVVV.DefaultTexture="Empty Texture";
VVVV.Types.ShaderProgram=function(){this.uniformSpecs={};this.attributeSpecs={};this.attribSemanticMap={};this.uniformSemanticMap={};var a="",b="",g,e;this.isSetup=!1;this.shaderProgram=void 0;this.log="";var d=this;this.extractSemantics=function(c){d.attributeSpecs={};d.attribSemanticMap={};d.uniformSpecs={};d.uniformSemanticMap={};for(var a=/(uniform|attribute) ([a-zA-Z]+)([0-9xD]*) ([a-zA-Z0-9_]+)( : ([A-Z0-9]+))?( = \{?([^;\}]+)\}?)?;/g,b;b=a.exec(c);)"attribute"==b[1]&&!d.attributeSpecs[b[4]]?
(d.attributeSpecs[b[4]]={varname:b[4],semantic:b[6],position:0},void 0!=b[6]&&(d.attribSemanticMap[b[6]]=b[4])):"uniform"==b[1]&&!d.uniformSpecs[b[4]]&&(d.uniformSpecs[b[4]]={varname:b[4],semantic:b[6],position:0,type:b[2],defaultValue:b[8],dimension:""==b[3]?1:b[3]},void 0!=b[6]&&(d.uniformSemanticMap[b[6]]=b[4]))};this.setVertexShader=function(c){a=c};this.setFragmentShader=function(c){b=c};this.setup=function(c){this.log="";g=c.createShader(c.VERTEX_SHADER);c.shaderSource(g,a.replace(/((uniform|attribute) [a-zA-Z0-9]+ [a-zA-Z0-9_]+)[^;]*/g,
"$1"));c.compileShader(g);c.getShaderParameter(g,c.COMPILE_STATUS)||(this.log=c.getShaderInfoLog(g),console.log(this.log));e=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(e,b.replace(/((uniform|attribute) [a-zA-Z0-9]+ [a-zA-Z0-9_]+)[^;]*/g,"$1"));c.compileShader(e);c.getShaderParameter(e,c.COMPILE_STATUS)||(this.log=c.getShaderInfoLog(e),console.log(this.log));this.shaderProgram=c.createProgram();c.attachShader(this.shaderProgram,g);c.attachShader(this.shaderProgram,e);c.linkProgram(this.shaderProgram);
c.getProgramParameter(this.shaderProgram,c.LINK_STATUS)||console.log("Could not initialise shaders");_(this.attributeSpecs).each(function(a){a.position=c.getAttribLocation(d.shaderProgram,a.varname)});_(this.uniformSpecs).each(function(a){a.position=c.getUniformLocation(d.shaderProgram,a.varname)});this.isSetup=!0;return""==this.log}};
VVVV.Nodes.FileTexture=function(a,b){this.constructor(a,"FileTexture (EX9.Texture)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Always loads in background","No reload pin","No preload pin (preloading handled by browser)","No up and running pin","No texture info outputs"]};this.auto_evaluate=!1;var g=this.addInputPin("Filename",[""],VVVV.PinTypes.String),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.WebGlTexture),
d=[];this.evaluate=function(){if(this.renderContexts){var c=this.renderContexts[0];if(c){if(g.pinIsChanged()||this.contextChanged){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){var k=VVVV.Helpers.prepareFilePath(g.getValue(b),this.parentPatch);0===k.indexOf("http://")&&void 0!==VVVV.ImageProxyPrefix&&(k=VVVV.ImageProxyPrefix+encodeURI(k));d[b]=c.createTexture();d[b].image=new Image;d[b].image.onload=function(a){return function(){c.bindTexture(c.TEXTURE_2D,d[a]);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,
c.RGBA,c.UNSIGNED_BYTE,d[a].image);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.bindTexture(c.TEXTURE_2D,null);e.markPinAsChanged()}}(b);d[b].image.src=k;e.setValue(b,d[b])}e.setSliceCount(a)}this.contextChanged=!1}}}};VVVV.Nodes.FileTexture.prototype=new VVVV.Core.Node;
VVVV.Nodes.DX9Texture=function(a,b){this.constructor(a,"DX9Texture (EX9.Texture)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Using WebGL renderer as source doesnt work correctly in Chrome."]};var g=this.addInputPin("Source",[],VVVV.PinTypes.WebGlResource),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.WebGlTexture),d;this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a)if(g.isConnected()){var b=
g.getValue(0);b&&((0!=(b.width&b.width-1)||0!=(b.height&b.height-1))&&console.log("Warning: Source renderer's width/height is not a power of 2. DX9Texture will most likely not work."),b instanceof WebGLTexture?e.setValue(0,b):(void 0==d&&(d=a.createTexture()),a.bindTexture(a.TEXTURE_2D,d),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.bindTexture(a.TEXTURE_2D,null),
e.setValue(0,d)))}else delete d,a.deleteTexture(d),e.setValue(0,void 0)}}};VVVV.Nodes.DX9Texture.prototype=new VVVV.Core.Node;
VVVV.Nodes.VideoTexture=function(a,b){this.constructor(a,"VideoTexture (EX9.Texture VMR9)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Only supports power-of-2 sized videos","Has no output pins for meta data"]};var g=this.addInputPin("Video",[],this),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.WebGlTexture),d;this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a)if(g.isConnected()){var b=
g.getValue(0);(0!=(b.videoWidth&b.videoWidth-1)||0!=(b.videoHeight&b.videoHeight-1))&&console.log("Warning: Video width/height is not a power of 2. VideoTexture will most likely not work.");if(void 0==d||this.contextChanged)d=a.createTexture();a.bindTexture(a.TEXTURE_2D,d);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.bindTexture(a.TEXTURE_2D,null);e.setValue(0,
d);this.contextChanged=!1}else delete d,a.deleteTexture(d),e.setValue(0,void 0)}}};VVVV.Nodes.VideoTexture.prototype=new VVVV.Core.Node;
VVVV.Nodes.VertexBufferJoin=function(a,b){this.constructor(a,"VertexBuffer (EX9.Geometry Join)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Position XYZ",[0,0,0],VVVV.PinTypes.Value),e=this.addInputPin("Normal XYZ",[0,0,0],VVVV.PinTypes.Value),d=this.addInputPin("Texture Coordinate 0 XY",[0,0],VVVV.PinTypes.Value),c=this.addInputPin("Apply",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Vertex Buffer",
[],VVVV.PinTypes.WebGlResource),h=null;this.evaluate=function(){var a=this.renderContexts[0];if(a&&0.5<=c.getValue(0)){for(var b=[],l=[],p=[],j=0;j<this.getMaxInputSliceCount();j++)b[j]=parseFloat(g.getValue(j)),l[j]=parseFloat(d.getValue(j)),p[j]=parseFloat(e.getValue(j));h=new VVVV.Types.VertexBuffer(a,b);h.setSubBuffer("TEXCOORD0",2,l);h.setSubBuffer("NORMAL",3,p);h.create();f.setValue(0,h)}}};VVVV.Nodes.VertexBufferJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.MeshJoin=function(a,b){this.constructor(a,"Mesh (EX9.Geometry Join)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Vertex Buffer",[],this),e=this.addInputPin("Indices",[0],VVVV.PinTypes.Value),d=this.addInputPin("Apply",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),f=null;this.evaluate=function(){var a=this.renderContexts[0];a&&0.5<=d.getValue(0)&&
(g.isConnected()?(f=new VVVV.Types.Mesh(a,g.getValue(0),e.values),c.setValue(0,f)):(c.setValue(0,void 0),delete f))}};VVVV.Nodes.MeshJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.Grid=function(a,b){this.constructor(a,"Grid (EX9.Geometry)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Resolution X",[2],VVVV.PinTypes.Value),e=this.addInputPin("Resolution Y",[2],VVVV.PinTypes.Value),d=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),c=null;this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a){for(var b=parseInt(g.getValue(0)),
k=parseInt(e.getValue(0)),m=[],l=[],p=[],j=0,n=0;n<k;n++)for(var r=0;r<b;r++)m.push(parseFloat(r)/(b-1)-0.5),m.push(0.5-parseFloat(n)/(k-1)),m.push(0),j++,l.push(0),l.push(0),l.push(1),p.push(parseFloat(r)/(b-1)),p.push(parseFloat(n)/(k-1));m=new VVVV.Types.VertexBuffer(a,m);m.setSubBuffer("TEXCOORD0",2,p);m.setSubBuffer("NORMAL",3,l);m.create();l=[];for(n=0;n<k-1;n++)for(r=0;r<b-1;r++)p=r+b*n,l.push(p),l.push(p+1),l.push(p+b+1),l.push(p+b+1),l.push(p+b),l.push(p);c=new VVVV.Types.Mesh(a,m,l);d.setValue(0,
c)}}}};VVVV.Nodes.Grid.prototype=new VVVV.Core.Node;
VVVV.Nodes.Sphere=function(a,b){this.constructor(a,"Sphere (EX9.Geometry)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Radius",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Resolution X",[15],VVVV.PinTypes.Value),d=this.addInputPin("Resolution Y",[15],VVVV.PinTypes.Value),c=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),f=null;this.evaluate=function(){if(this.renderContexts){var a=
this.renderContexts[0];if(a){for(var b=parseInt(e.getValue(0)),m=parseInt(d.getValue(0)),l=parseFloat(g.getValue(0)),p=[],j=[],n=[],r=0;r<m+1;r++)for(var u=Math.cos(-parseFloat(r)/m*Math.PI),s=0;s<b;s++){var q=Math.cos(2*(parseFloat(s)/b)*Math.PI)*Math.cos(Math.asin(u)),v=Math.sin(2*(parseFloat(s)/b)*Math.PI)*Math.cos(Math.asin(u));p.push(q*l);p.push(u*l);p.push(v*l);j.push(q);j.push(u);j.push(v);n.push(parseFloat(s)/b);n.push(parseFloat(r)/m)}l=new VVVV.Types.VertexBuffer(a,p);l.setSubBuffer("TEXCOORD0",
2,n);l.setSubBuffer("NORMAL",3,j);l.create();j=[];for(r=0;r<m;r++)for(s=0;s<b;s++)n=b*r,p=s+n,j.push(p),j.push((p+1)%b+n),j.push((p+1)%b+b+n),j.push((p+1)%b+b+n),j.push(p+b),j.push(p);f=new VVVV.Types.Mesh(a,l,j);c.setValue(0,f)}}}};VVVV.Nodes.Sphere.prototype=new VVVV.Core.Node;
VVVV.Nodes.Cylinder=function(a,b){this.constructor(a,"Cylinder (EX9.Geometry)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=this.addInputPin("Radius 1",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Radius 2",[0.5],VVVV.PinTypes.Value),d=this.addInputPin("Length",[1],VVVV.PinTypes.Value),c=this.addInputPin("Cycles",[1],VVVV.PinTypes.Value),f=this.addInputPin("Caps",[1],VVVV.PinTypes.Value),h=this.addInputPin("Resolution X",
[15],VVVV.PinTypes.Value),k=this.addInputPin("Resolution Y",[1],VVVV.PinTypes.Value),m=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),l=null;this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a){var b=parseInt(h.getValue(0)),n=parseInt(k.getValue(0)),r=parseFloat(g.getValue(0)),u=parseFloat(e.getValue(0)),s=parseFloat(d.getValue(0)),q=parseFloat(c.getValue(0)),v=[],t=[],w=[];v.push(0);v.push(s/2);v.push(0);t.push(0);t.push(1);t.push(0);w.push(0);w.push(0);v.push(0);
v.push(-s/2);v.push(0);t.push(0);t.push(-1);t.push(0);w.push(0);w.push(0);for(var D=0;D<n+1;D++)for(var y=parseFloat(D)/n,F=(y-0.5)*-s,z=0;z<b+1;z++){var B=Math.cos(2*(parseFloat(z)/b)*Math.PI*q-Math.PI*q-Math.PI/2),C=Math.sin(2*(parseFloat(z)/b)*Math.PI*q-Math.PI*q-Math.PI/2),E=y*u+(1-y)*r;v.push(B*E);v.push(F);v.push(C*E);t.push(B);t.push(0);t.push(C);w.push(parseFloat(z)/b);w.push(parseFloat(D)/n)}r=new VVVV.Types.VertexBuffer(a,v);r.setSubBuffer("TEXCOORD0",2,w);r.setSubBuffer("NORMAL",3,t);r.create();
t=[];if(0.5<f.getValue(0))for(y=0;2>y;y++)for(z=0;z<b;z++)t.push(y),t.push(2+z+y+y*n*(b+1)),t.push(2+z+(1-y)+y*n*(b+1));for(D=0;D<n;D++)for(z=0;z<b;z++)y=z+b*D+2,t.push(y),t.push(y+1),t.push(y+b+2),t.push(y+b+2),t.push(y+b+1),t.push(y);l=new VVVV.Types.Mesh(a,r,t);m.setValue(0,l)}}}};VVVV.Nodes.Cylinder.prototype=new VVVV.Core.Node;
VVVV.Nodes.BlendWebGLAdvanced=function(a,b){function g(a){switch(a){case "One":return"ONE";case "Zero":return"ZERO";case "SrcAlpha":return"SRC_ALPHA";case "InvSrcAlpha":return"ONE_MINUS_SRC_ALPHA";case "DestAlpha":return"DST_ALPHA";case "InvDestAlpha":return"ONE_MINUS_DST_ALPHA";case "SrcColor":return"SRC_COLOR";case "InvSrcColor":return"ONE_MINUS_SRC_COLOR";case "DestColor":return"DST_COLOR";case "InvDestColor":return"ONE_MINUS_DST_COLOR"}return null}this.constructor(a,"Blend (EX9.RenderState Advanced)",
b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var e=this.addInputPin("Render State In",[],VVVV.PinTypes.WebGlRenderState),d=this.addInputPin("Alpha Blending",[1],VVVV.PinTypes.Value),c=this.addInputPin("Source Blend Mode",["SrcAlpha"],VVVV.PinTypes.Enum),f=this.addInputPin("Destination Blend Mode",["SrcAlpha"],VVVV.PinTypes.Enum);c.enumOptions=f.enumOptions="One Zero SrcAlpha InvSrcAlpha DestAlpha InvDestAlpha SrcColor InvSrcColor DestColor InvDestColor".split(" ");
var h=this.addOutputPin("Render State Out",[],VVVV.PinTypes.WebGlRenderState),k=[];this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++)void 0==k[b]&&(k[b]=new VVVV.Types.WebGlRenderState),k[b].copy_attributes(e.getValue(b)),k[b].alphaBlending=0.5<parseFloat(d.getValue(b)),k[b].srcBlendMode=g(c.getValue(b)),k[b].destBlendMode=g(f.getValue(b)),h.setValue(b,k[b]);h.setSliceCount(a)}};VVVV.Nodes.BlendWebGLAdvanced.prototype=new VVVV.Core.Node;
VVVV.Nodes.BlendWebGL=function(a,b){this.constructor(a,"Blend (EX9.RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["results differ from VVVV","Multiply mode not supported"]};var g=this.addInputPin("Render State In",[],VVVV.PinTypes.WebGlRenderState),e=this.addInputPin("Draw Mode",["Blend"],VVVV.PinTypes.Enum);e.enumOptions=["Add","Multiply","Blend","ColorAsAlphaAdd","ColorAsAlphaBlend"];var d=this.addOutputPin("Render State Out",
[],VVVV.PinTypes.WebGlRenderState),c=[];this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){void 0==c[b]&&(c[b]=new VVVV.Types.WebGlRenderState);c[b].copy_attributes(g.getValue(b));switch(e.getValue(b)){case "Add":c[b].srcBlendMode="SRC_ALPHA";c[b].destBlendMode="ONE";break;case "Multiply":console.log("Multiply Blend Mode not supported (or we just missed it)");case "Blend":c[b].srcBlendMode="SRC_ALPHA";c[b].destBlendMode="ONE_MINUS_SRC_ALPHA";break;case "ColorAsAlphaAdd":c[b].srcBlendMode=
"SRC_COLOR";c[b].destBlendMode="ONE";break;case "ColorAsAlphaBlend":c[b].srcBlendMode="SRC_COLOR",c[b].destBlendMode="ONE_MINUS_SRC_COLOR"}d.setValue(b,c[b])}d.setSliceCount(a)}};VVVV.Nodes.BlendWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.FillWebGL=function(a,b){this.constructor(a,"Fill (EX9.RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["does not actually draw wireframe, because this is not supported in WebGL, but makes renderer use gl.LINE instead of gl.TRIANGLES when drawing"]};var g=this.addInputPin("Render State In",[],VVVV.PinTypes.WebGlRenderState),e=this.addInputPin("Fill Mode",["Solid"],VVVV.PinTypes.Enum);e.enumOptions=["Point","Solid","WireFrame"];
var d=this.addOutputPin("Render State Out",[],VVVV.PinTypes.WebGlRenderState),c=[];this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++){void 0==c[b]&&(c[b]=new VVVV.Types.WebGlRenderState);c[b].copy_attributes(g.getValue(b));switch(e.getValue(b)){case "Point":c[b].polygonDrawMode="POINTS";break;case "Solid":c[b].polygonDrawMode="TRIANGLES";break;case "WireFrame":c[b].polygonDrawMode="LINES"}d.setValue(b,c[b])}d.setSliceCount(a)}};VVVV.Nodes.FillWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.ZWriteEnableWebGL=function(a,b){function g(a){switch(a){case "Never":return"NEVER";case "Less":return"LESS";case "LessEqual":return"LEQUAL";case "Equal":return"EQUAL";case "NotEqual":return"NOTEQUAL";case "Greater":return"GREATER";case "GreaterEqual":return"GEQUAL";case "Always":return"ALWAYS"}return null}this.constructor(a,"ZWriteEnable (EX9.RenderState)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var e=this.addInputPin("Render State In",
[],VVVV.PinTypes.WebGlRenderState),d=this.addInputPin("ZWrite Enable",[1],VVVV.PinTypes.Value),c=this.addInputPin("Compare Function",["Always"],VVVV.PinTypes.Enum);c.enumOptions="Never Less LessEqual Equal NotEqual Greater GreaterEqual Always".split(" ");var f=this.addInputPin("Depth Bias",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Render State Out",[],VVVV.PinTypes.WebGlRenderState),k=[];this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++)void 0==k[b]&&(k[b]=new VVVV.Types.WebGlRenderState),
k[b].copy_attributes(e.getValue(b)),k[b].enableZWrite=0.5<parseFloat(d.getValue(b)),k[b].depthFunc=g(c.getValue(b)),k[b].depthOffset=parseFloat(f.getValue(0)),h.setValue(b,k[b]);h.setSliceCount(a)}};VVVV.Nodes.ZWriteEnableWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.GenericShader=function(a,b){this.constructor(a,"GenericShader (EX9.Effect)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.shaderFile="";var g=this.addInputPin("Render State",[],VVVV.PinTypes.WebGlRenderState),e=this.addInputPin("Mesh",[],VVVV.PinTypes.WebGlResource),d=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),c=this.addInputPin("Technique",[""],VVVV.PinTypes.Enum);c.enumOptions=[""];this.addOutputPin("Layer",
[],VVVV.PinTypes.WebGlResource);var f=[],h=null,k,m=!1,l=[],p=this;this.initialize=function(){var b=["Render State","Mesh","Transform","Technique"];_(p.inputPins).each(function(a){0>b.indexOf(a.pinname)&&(a.unvalidated=!0,l.push(a))});void 0==VVVV.ShaderCodeResources[p.shaderFile]?(VVVV.ShaderCodeResources[p.shaderFile]=new VVVV.Types.ShaderCodeResource,VVVV.ShaderCodeResources[p.shaderFile].addRelatedNode(p),$.ajax({url:VVVV.Helpers.prepareFilePath(p.shaderFile,p.parentPatch),async:!1,dataType:"text",
success:function(a){VVVV.ShaderCodeResources[p.shaderFile].setSourceCode(a)},error:function(){console.log("ERROR: Could not load shader file "+p.shaderFile.replace("%VVVV%",VVVV.Root));VVVV.onNotImplemented("Could not load shader file "+p.shaderFile.replace("%VVVV%",VVVV.Root))}})):VVVV.ShaderCodeResources[p.shaderFile].addRelatedNode(p)};this.shaderSourceUpdated=function(a){k=a;h||(h=new VVVV.Types.ShaderProgram);p.addUniformPins();p.setupShader();_(p.inputPins).each(function(a){a.markPinAsChanged()});
m=!0;this.parentPatch.afterUpdate()};this.addUniformPins=function(){h.extractSemantics(k);for(var a=[],b=0;b<l.length;b++)h.uniformSpecs[l[b].pinname.replace(/ /g,"_")]||(p.removeInputPin(l[b].pinname),a.push(b));for(b=0;b<a.length;b++)l.splice(a[b],1);_(h.uniformSpecs).each(function(a){if(!("VIEW"==a.semantic||"PROJECTION"==a.semantic||"WORLD"==a.semantic)){var b=VVVV.PinTypes.Value,c=[];switch(a.type){case "mat":b=VVVV.PinTypes.Transform;break;case "sampler":b=VVVV.PinTypes.WebGlTexture;break;default:"COLOR"==
a.semantic?(b=VVVV.PinTypes.Color,c=["1.0, 1.0, 1.0, 1.0"]):c=[0],a.defaultValue&&(c="COLOR"!=a.semantic?_(a.defaultValue.split(",")).map(function(a){return parseFloat(a)}):[a.defaultValue])}for(var d=0;d<l.length;d++)if(l[d].pinname==a.varname.replace(/_/g," ")){l[d].dimensions=a.dimension;if(l[d].typeName!=b.typeName){c=l[d].values.slice();l[d].setType(b);if(l[d].unvalidated&&("mat"!=a.type&&"sampler"!=a.type||l[d].isConnected()))l[d].values=c;l[d].isConnected()&&!l[d].unvalidated&&(l[d].connectionChanged(),
l[d].links[0].destroy());l[d].unvalidated=!1}return}b=p.addInputPin(a.varname.replace(/_/g," "),c,p,b);b.dimensions=a.dimension;l.push(b)}})};this.setupShader=function(){var a=c.getValue(0),a=a.replace(/^\s*/,"").replace(/\s*$/,""),b=RegExp(/(vertex_shader|fragment_shader)\{([^\}]+)\}/g);c.enumOptions=[];for(var d;null!=(d=b.exec(k));)c.enumOptions=c.enumOptions.concat(d[2].replace(/\s/g,"").split(","));c.enumOptions=c.enumOptions.filter(function(a,b,c){return c.indexOf(a)===b});0==c.enumOptions.length&&
c.enumOptions.push("");if(""==a||0>c.enumOptions.indexOf(a))a=c.enumOptions[0],c.setValue(0,a);var f=RegExp("vertex_shader(\\{([a-zA-Z0-9]+,\\s*)*"+a+"(,\\s*[a-zA-Z0-9]+)*\\})?:([\\s\\S]*?)(vertex_shader|fragment_shader)"),b=RegExp("fragment_shader(\\{([a-zA-Z0-9]+,\\s*)*"+a+"(,\\s*[a-zA-Z0-9]+)*\\})?:([\\s\\S]*?)(vertex_shader|fragment_shader)");d=/STARTOFSTRING((\r?\n|.)*?)(vertex_shader|fragment_shader)/.exec("STARTOFSTRING"+k);var e=d[1];void 0==(d=f.exec(k+"\nfragment_shader"))?console.log("ERROR: No vertex shader code for technique "+
a+" found"):(f=d[4],void 0==(d=b.exec(k+"\nfragment_shader"))?console.log("ERROR: No fragment shader code for technique "+a+" found"):(h.setFragmentShader(e+d[4]),h.setVertexShader(e+f)))};this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a&&h){if(!h.isSetup||this.contextChanged||c.pinIsChanged())this.setupShader(),h.setup(a)?VVVV.ShaderCodeResources[p.shaderFile].definingNode&&VVVV.ShaderCodeResources[p.shaderFile].definingNode.showStatus("success","Successfully compiled"):
VVVV.ShaderCodeResources[p.shaderFile].definingNode&&VVVV.ShaderCodeResources[p.shaderFile].definingNode.showStatus("error",h.log);var b=0;_(this.inputPins).each(function(a){var c=a.getSliceCount();a=a.pinname.replace(/ /g,"_");h.uniformSpecs[a]&&("vec"==h.uniformSpecs[a].type&&"COLOR"!=h.uniformSpecs[a].semantic)&&(c=parseInt(c/h.uniformSpecs[a].dimension));c>b&&(b=c)});if(!e.isConnected()||void 0==e.getValue(0))b=0;var k=f.length;if(this.contextChanged||m)k=0;b<k&&f.splice(b,k-b);for(var u=k;u<
b;u++)f[u]=new VVVV.Types.Layer,f[u].mesh=e.getValue(0),f[u].shader=h,_(h.uniformSpecs).each(function(a){f[u].uniformNames.push(a.varname);f[u].uniforms[a.varname]={uniformSpec:a,value:void 0}});if(e.pinIsChanged())for(u=0;u<b;u++)f[u].mesh=e.getValue(0);for(u=0;u<b;u++)f[u].shader=h;for(a=0;a<l.length;a++){var s=l[a].pinname.replace(/ /g,"_");if(l[a].pinIsChanged()||k<b)for(u=0;u<b;u++)if("vec"==h.uniformSpecs[s].type){var q="COLOR"==h.uniformSpecs[s].semantic?_(l[a].getValue(u).split(",")).map(function(a){return parseFloat(a)}):
l[a].getValue(u,l[a].dimensions);f[u].uniforms[s].value=new Float32Array(q)}else q=l[a].getValue(u),f[u].uniforms[s].value=q}if(g.pinIsChanged()||k<b)for(a=0;a<b;a++)f[a].renderState=g.isConnected()?g.getValue(a):VVVV.DefaultRenderState;if(d.pinIsChanged()||k<b)for(a=0;a<b;a++)k=this.inputPins.Transform.getValue(a),f[a].uniforms[f[a].shader.uniformSemanticMap.WORLD].value=k;this.outputPins.Layer.setSliceCount(b);for(a=0;a<b;a++)this.outputPins.Layer.setValue(a,f[a]);m=this.contextChanged=!1}}};this.openUIWindow=
function(){VVVV.ShaderCodeResources[p.shaderFile].definingNode&&VVVV.ShaderCodeResources[p.shaderFile].definingNode.openUIWindow()}};VVVV.Nodes.GenericShader.prototype=new VVVV.Core.Node;
VVVV.Nodes.Quad=function(a,b){this.constructor(a,"Quad (DX9)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No Sampler States","No texture coord mapping","No enable pin","Transprent pixels are discarded by default"]};this.auto_evaluate=!1;var g=this.addInputPin("Render State",[],VVVV.PinTypes.WebGlRenderState);this.addInputPin("Transform",[],VVVV.PinTypes.Transform);this.addInputPin("Texture",[],VVVV.PinTypes.WebGlTexture);
this.addInputPin("Texture Transform",[],VVVV.PinTypes.Transform);this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);this.addOutputPin("Layer",[],VVVV.PinTypes.WebGlResource);var e=[],d=null,c=null;this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a){if(this.contextChanged){var b=new VVVV.Types.VertexBuffer(a,[0.5,0.5,0,-0.5,0.5,0,0.5,-0.5,0,-0.5,-0.5,0]);b.setSubBuffer("TEXCOORD0",2,[1,0,0,0,1,1,0,1]);b.create();d=new VVVV.Types.Mesh(a,b,[0,1,2,1,3,
2]);b="#ifdef GL_ES\nprecision highp float;\n#endif\n";b+="uniform vec4 col : COLOR = {1.0, 1.0, 1.0, 1.0}; varying vec2 vs2psTexCd; uniform sampler2D Samp0; void main(void) { gl_FragColor = col*texture2D(Samp0, vs2psTexCd); if (gl_FragColor.a==0.0) discard;  }";c=new VVVV.Types.ShaderProgram;c.extractSemantics(b+"attribute vec3 PosO : POSITION; attribute vec2 TexCd : TEXCOORD0; uniform mat4 tW : WORLD; uniform mat4 tV : VIEW; uniform mat4 tP : PROJECTION; uniform mat4 tTex; varying vec2 vs2psTexCd; void main(void) { gl_Position = tP * tV * tW * vec4(PosO, 1.0); vs2psTexCd = (tTex * vec4(TexCd.xy-.5, 0.0, 1.0)).xy+.5; }");
c.setFragmentShader(b);c.setVertexShader("attribute vec3 PosO : POSITION; attribute vec2 TexCd : TEXCOORD0; uniform mat4 tW : WORLD; uniform mat4 tV : VIEW; uniform mat4 tP : PROJECTION; uniform mat4 tTex; varying vec2 vs2psTexCd; void main(void) { gl_Position = tP * tV * tW * vec4(PosO, 1.0); vs2psTexCd = (tTex * vec4(TexCd.xy-.5, 0.0, 1.0)).xy+.5; }");c.setup(a)}a=this.getMaxInputSliceCount();b=e.length;this.contextChanged&&(b=0);a<b&&e.splice(a,b-a);for(var k=b;k<a;k++)e[k]=new VVVV.Types.Layer,
e[k].mesh=d,e[k].shader=c,_(c.uniformSpecs).each(function(a){e[k].uniformNames.push(a.varname);e[k].uniforms[a.varname]={uniformSpec:a,value:void 0}});var m=this.inputPins.Color.pinIsChanged(),l=this.inputPins.Transform.pinIsChanged(),p=this.inputPins.Texture.pinIsChanged(),j=this.inputPins["Texture Transform"].pinIsChanged();if(m||b<a)for(m=0;m<a;m++){var n=this.inputPins.Color.getValue(m),n=_(n.split(",")).map(function(a){return parseFloat(a)});e[m].uniforms.col.value=new Float32Array(n)}if(g.pinIsChanged()||
b<a)for(m=0;m<a;m++)e[m].renderState=g.isConnected()?g.getValue(m):VVVV.DefaultRenderState;if(l||b<a)for(m=0;m<a;m++)l=this.inputPins.Transform.getValue(m),e[m].uniforms[e[m].shader.uniformSemanticMap.WORLD].value=l;if(p||b<a)for(m=0;m<a;m++)e[m].uniforms.Samp0.value=this.inputPins.Texture.getValue(m);if(j||b<a)for(m=0;m<a;m++)l=this.inputPins["Texture Transform"].getValue(m),e[m].uniforms.tTex.value=l;this.outputPins.Layer.setSliceCount(a);for(m=0;m<a;m++)this.outputPins.Layer.setValue(m,e[m]);this.contextChanged=
!1}}}};VVVV.Nodes.Quad.prototype=new VVVV.Core.Node;
VVVV.Nodes.Group=function(a,b){this.constructor(a,"Group (EX9)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var g=[],e=this.addInputPin("Enabled",[1],VVVV.PinTypes.Value),d=this.addInvisiblePin("Layer Template Count",[2],VVVV.PinTypes.Value),c=this.addOutputPin("Layer",[],VVVV.PinTypes.WebGlResource);this.initialize=function(){for(var a=d.getValue(0),c=g.length;c<a;c++)g[c]=this.addInputPin("Layer "+(c+1),[],VVVV.PinTypes.WebGlResource);
for(c=a;c<g.length;c++)this.removeInputPin(g[c].pinname);g.length=a;b.afterUpdate()};this.evaluate=function(){d.pinIsChanged()&&this.initialize();var a=0;if(0.5<e.getValue(0))for(var b=0;b<g.length;b++)for(var k=0;k<g[b].getSliceCount();k++)c.setValue(a++,g[b].getValue(k));c.setSliceCount(a)}};VVVV.Nodes.Group.prototype=new VVVV.Core.Node;
VVVV.Nodes.RendererWebGL=function(a,b){this.constructor(a,"Renderer (EX9)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Disabling Clear doesn't work in Chrome","No Fullscreen","No Enable Pin","No Aspect Ration and Viewport transform","No mouse output"]};this.addInputPin("Layers",[],VVVV.PinTypes.WebGlResource);var g=this.addInputPin("Clear",[1],VVVV.PinTypes.Value),e=this.addInputPin("Background Color",["0.0, 0.0, 0.0, 1.0"],
VVVV.PinTypes.Color),d=this.addInputPin("Backbuffer Width",[0],VVVV.PinTypes.Value),c=this.addInputPin("Backbuffer Height",[0],VVVV.PinTypes.Value),f=this.addInputPin("View",[],VVVV.PinTypes.Transform),h=this.addInputPin("Projection",[],VVVV.PinTypes.Transform),k=this.addInvisiblePin("Windowed Depthbuffer Format",["NONE"],VVVV.PinTypes.Enum);k.enumOptions=["NONE","DX16"];var m=this.addOutputPin("Actual Backbuffer Width",[0],VVVV.PinTypes.Value),l=this.addOutputPin("Actual Backbuffer Height",[0],VVVV.PinTypes.Value),
p=this.addOutputPin("EX9 Out",[],VVVV.PinTypes.WebGlResource),j=0,n=0,r,u,s=this.ctxt=void 0,q,v,t;this.getContexts=function(){if(this.invisiblePins["Descriptive Name"]){var a=this.invisiblePins["Descriptive Name"].getValue(0),a=$(a).get(0),b;if(!a||"CANVAS"!=a.nodeName){b=parseInt(d.getValue(0));var k=parseInt(c.getValue(0));b=$('<canvas width="'+(0<b?b:512)+'" height="'+(0<k?k:512)+'" id="vvvv-js-generated-renderer-'+(new Date).getTime()+'" class="vvvv-js-generated-renderer"></canvas>');a||(a="body");
$(a).append(b)}else b=$(a);if(b){var l=b;$(l).detach("mousemove");$(l).detach("mousedown");$(l).detach("mouseup");VVVV.MousePositions[l.id]={x:0,y:0,wheel:0,lb:0,mb:0,rb:0};$(l).mousemove(function(a){var b=2*(a.pageX-$(this).offset().left)/$(this).width()-1;a=-(2*(a.pageY-$(this).offset().top)/$(this).height()-1);VVVV.MousePositions._all.x=b;VVVV.MousePositions._all.y=a;VVVV.MousePositions[l.id].x=b;VVVV.MousePositions[l.id].y=a});$(l).bind("mousewheel",function(a){a=a.originalEvent.wheelDelta/120;
VVVV.MousePositions[l.id].wheel+=a;VVVV.MousePositions._all.wheel+=a});$(l).bind("DOMMouseScroll",function(a){a=-a.originalEvent.detail/3;VVVV.MousePositions[l.id].wheel+=a;VVVV.MousePositions._all.wheel+=a});$(l).mousedown(function(a){switch(a.which){case 1:VVVV.MousePositions._all.lb=1;VVVV.MousePositions[l.id].lb=1;break;case 2:VVVV.MousePositions._all.mb=1;VVVV.MousePositions[l.id].mb=1;break;case 3:VVVV.MousePositions._all.rb=1,VVVV.MousePositions[l.id].rb=1}});$(l).mouseup(function(a){switch(a.which){case 1:VVVV.MousePositions._all.lb=
0;VVVV.MousePositions[l.id].lb=0;break;case 2:VVVV.MousePositions._all.mb=0;VVVV.MousePositions[l.id].mb=0;break;case 3:VVVV.MousePositions._all.rb=0,VVVV.MousePositions[l.id].rb=0}});try{s=b.get(0).getContext("experimental-webgl",{preserveDrawingBuffer:!0}),s.viewportWidth=parseInt(b.get(0).width),s.viewportHeight=parseInt(b.get(0).height)}catch(m){console.log(m)}this.ctxt=s;p.isConnected()&&this.renderContexts&&this.renderContexts[0]?(q=this.ctxt=this.renderContexts[0],v=q.createFramebuffer(),q.bindFramebuffer(q.FRAMEBUFFER,
v),v.width=b.get(0).width,v.height=b.get(0).height,t=q.createTexture(),q.bindTexture(q.TEXTURE_2D,t),q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!0),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR_MIPMAP_NEAREST),q.texImage2D(q.TEXTURE_2D,0,q.RGBA,v.width,v.height,0,q.RGBA,q.UNSIGNED_BYTE,null),q.generateMipmap(q.TEXTURE_2D),a=q.createRenderbuffer(),q.bindRenderbuffer(q.RENDERBUFFER,a),q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_COMPONENT16,
v.width,v.height),q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_2D,t,0),q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_ATTACHMENT,q.RENDERBUFFER,a),q.bindTexture(q.TEXTURE_2D,null),q.bindRenderbuffer(q.RENDERBUFFER,null),q.bindFramebuffer(q.FRAMEBUFFER,null)):this.renderContexts&&this.renderContexts[0]&&(this.renderContexts[0].deleteTexture(t),t=void 0);this.ctxt&&(j=parseInt(b.get(0).width),n=parseInt(b.get(0).height),q=this.ctxt,a=new Uint8Array([255,255,255]),q.DefaultTexture=
q.createTexture(),q.bindTexture(q.TEXTURE_2D,q.DefaultTexture),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.NEAREST),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.NEAREST),q.pixelStorei(q.UNPACK_ALIGNMENT,1),q.texImage2D(q.TEXTURE_2D,0,q.RGB,1,1,0,q.RGB,q.UNSIGNED_BYTE,a),q.bindTexture(q.TEXTURE_2D,null),this.inputPins.Layers.markPinAsChanged(),g.markPinAsChanged(),
e.markPinAsChanged(),f.markPinAsChanged(),h.markPinAsChanged())}}};var w=!1;this.evaluate=function(){q=this.ctxt;if(this.invisiblePins["Descriptive Name"].pinIsChanged()||this.contextChanged)s&&$(s.canvas).hasClass("vvvv-js-generated-renderer")&&$(s.canvas).remove(),this.getContexts(),this.inputPins.Layers.isConnected()&&this.inputPins.Layers.links[0].fromPin.connectionChanged();w||(m.setValue(0,j),l.setValue(0,n),w=!0);if(void 0!=q){if(d.pinIsChanged()&&(!this.renderContexts||!this.renderContexts[0])){var a=
parseInt(d.getValue(0));0<a&&(j=a,$(s.canvas).attr("width",j),m.setValue(0,j))}if(c.pinIsChanged()&&(!this.renderContexts||!this.renderContexts[0]))a=parseInt(c.getValue(0)),0<a&&(n=a,$(s.canvas).attr("height",n),l.setValue(0,n));this.renderContexts&&this.renderContexts[0]&&q==this.renderContexts[0]?q.bindFramebuffer(q.FRAMEBUFFER,v):q.bindFramebuffer(q.FRAMEBUFFER,null);a=_(e.getValue(0).split(",")).map(function(a){return parseFloat(a)});q.clearColor(a[0],a[1],a[2],a[3]);q.clear(q.COLOR_BUFFER_BIT|
q.DEPTH_BUFFER_BIT);"NONE"==k.getValue(0)?q.disable(q.DEPTH_TEST):q.enable(q.DEPTH_TEST);h.pinIsChanged()&&(h.isConnected()?(r=mat4.create(),mat4.set(h.getValue(0),r)):(r=mat4.create(),mat4.ortho(-1,1,-1,1,-100,100,r)),mat4.scale(r,[1,1,-1]),this.renderContexts&&this.renderContexts[0]&&mat4.scale(r,[1,-1,1]));f.pinIsChanged()&&(u=f.getValue(0));if(this.contextChanged)this.contextChanged=!1;else{q.viewport(0,0,j,n);var b=a=null,g=null;if(this.inputPins.Layers.isConnected())for(var z=this.inputPins.Layers.values,
B=0;B<z.length;B++)if(layer=z[B],void 0!=layer.shader){a!=layer.shader.shaderProgram&&(q.useProgram(layer.shader.shaderProgram),q.uniformMatrix4fv(layer.shader.uniformSpecs[layer.shader.uniformSemanticMap.PROJECTION].position,!1,r),q.uniformMatrix4fv(layer.shader.uniformSpecs[layer.shader.uniformSemanticMap.VIEW].position,!1,u));var C=layer.renderState;C||(C=defaultWebGlRenderState);C!=b&&C.apply(q);if(layer.mesh!=g||layer.shader.shaderProgram!=a)q.bindBuffer(q.ARRAY_BUFFER,layer.mesh.vertexBuffer.vbo),
_(layer.mesh.vertexBuffer.subBuffers).each(function(a){layer.shader.attributeSpecs[layer.shader.attribSemanticMap[a.usage]]&&(q.enableVertexAttribArray(layer.shader.attributeSpecs[layer.shader.attribSemanticMap[a.usage]].position),q.vertexAttribPointer(layer.shader.attributeSpecs[layer.shader.attribSemanticMap[a.usage]].position,a.size,q.FLOAT,!1,0,a.offset))}),q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,layer.mesh.indexBuffer);for(var b=layer.uniformNames.length,E=g=0;E<b;E++){var A=layer.uniforms[layer.uniformNames[E]];
if(void 0!=A.value&&!(0<B&&layer.shader.shaderProgram==a&&z[B-1].uniforms[layer.uniformNames[E]]&&A.value==z[B-1].uniforms[layer.uniformNames[E]].value)){start=(new Date).getTime();switch(A.uniformSpec.type){case "mat":q["uniformMatrix"+A.uniformSpec.dimension+"fv"](A.uniformSpec.position,!1,A.value);break;case "vec":q["uniform"+A.uniformSpec.dimension+"fv"](A.uniformSpec.position,A.value);break;case "int":q["uniform"+A.uniformSpec.dimension+"i"](A.uniformSpec.position,A.value);break;case "float":q["uniform"+
A.uniformSpec.dimension+"f"](A.uniformSpec.position,A.value);break;case "sampler":var G=A.value;G==VVVV.DefaultTexture&&(G=q.DefaultTexture);q.activeTexture(q["TEXTURE"+g]);q.bindTexture(q["TEXTURE_"+A.uniformSpec.dimension],G);q.uniform1i(A.uniformSpec.position,g);g++}loopstart=(new Date).getTime()}}q.drawElements(q[C.polygonDrawMode],layer.mesh.numIndices,q.UNSIGNED_SHORT,0);a=layer.shader.shaderProgram;b=C;g=layer.mesh}this.renderContexts&&this.renderContexts[0]&&(q.bindTexture(q.TEXTURE_2D,t),
q.generateMipmap(q.TEXTURE_2D),q.bindTexture(this.renderContexts[0].TEXTURE_2D,null));p.setValue(0,t)}}}};VVVV.Nodes.RendererWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.DefineEffect=function(a,b){this.constructor(a,"DefineEffect (DX9)",b);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["Matthias Zauner"],credits:[],compatibility_issues:["Not available in classic VVVV"]};this.auto_evaluate=!1;var g=this.addInputPin("Effect Descriptor",[""],VVVV.PinTypes.String),e=this.addInvisiblePin("Source Code",["#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 tW : WORLD;\nuniform mat4 tV : VIEW;\nuniform mat4 tP : PROJECTION;\n\nuniform vec4 Color : COLOR = {1.0, 1.0, 1.0, 1.0};\nuniform sampler2D Texture;\nuniform mat4 Texture_Transform;\nuniform float Alpha = 1.0;\n\nvarying vec2 vs2psTexCd;\n\nvertex_shader:\n\nattribute vec3 PosO : POSITION;\nattribute vec2 TexCd : TEXCOORD0;\n\nvoid main(void) {\n  gl_Position = tP * tV * tW * vec4(PosO, 1.0);\n  vs2psTexCd = (Texture_Transform * vec4(TexCd, 0, 1)).xy;\n}\n\n\nfragment_shader:\n\nvoid main(void) {\n  gl_FragColor = Color * texture2D(Texture, vs2psTexCd) * vec4(1.0, 1.0, 1.0, Alpha);\n}"],
VVVV.PinTypes.String),d="",c;this.evaluate=function(){if(""!=g.getValue(0)){if(g.pinIsChanged()){var a=g.getValue(0);if(""==a)return;""==d?void 0==VVVV.ShaderCodeResources["./"+a+".vvvvjs.fx"]&&(VVVV.ShaderCodeResources["./"+a+".vvvvjs.fx"]=new VVVV.Types.ShaderCodeResource):VVVV.ShaderCodeResources["./"+a+".vvvvjs.fx"]=VVVV.ShaderCodeResources[d];d="./"+a+".vvvvjs.fx";VVVV.ShaderCodeResources[d].definingNode=this;VVVV.ShaderCodeResources[d].setSourceCode(e.getValue(0));c&&$("#path",c.document).text((this.parentPatch.nodename||
"root")+" / "+(""!=d?d:"Untitled"))}e.pinIsChanged()&&VVVV.ShaderCodeResources[d]&&VVVV.ShaderCodeResources[d].setSourceCode(e.getValue(0))}};this.openUIWindow=function(){c=window.open("code_editor.html",d+" / VVVV.js Effect Editor","location=no, width=800, height=800, toolbar=no");var a=this;window.setTimeout(function(){c.document.title=d+" / VVVV.js Effect Editor";var b=a.parentPatch.nodename||"root",g=""!=d?d:"Untitled";$("#path",c.document).text(b+" / "+g);$("textarea",c.document).text(e.getValue(0));
$("#compile_button",c.document).click(function(){""==d?a.showStatus("error","Please provide a name for this shader first"):(e.setValue(0,$("textarea",c.document).val()),0<VVVV.ShaderCodeResources[d].relatedNodes.length?a.showStatus("notice","Compiling ..."):a.showStatus("notice","No instance of this shader found. Create a node (./"+d+") and connect it to a Renderer (EX9) to compile."))});c.focus()},500)};this.showStatus=function(a,b){c&&($("#status",c.document).text(b),$("#status",c.document).attr("class",
a))}};VVVV.Nodes.DefineEffect.prototype=new VVVV.Core.Node;VVVV.Nodes.XPathXML=function(a,b){this.constructor(a,"XPath (XML)",b);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["XML Index Output Pin not implemented","Query Index Output Pin not implemented"]};this.auto_evaluate=!1;var g=this.addInputPin("XML Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("XPath Query",["text"],VVVV.PinTypes.String),d=this.addInputPin("Base Element",["text"],VVVV.PinTypes.String),c=this.addOutputPin("Output",
["text"],VVVV.PinTypes.String),f=this.addOutputPin("XML Index",[0],VVVV.PinTypes.Value),h=this.addOutputPin("Query Index",[0],VVVV.PinTypes.Value),k;this.evaluate=function(){var a=g.getValue(0),b=e.getValue(0);d.getValue(0);g.pinIsChanged()&&(k=(new DOMParser).parseFromString(a,"text/xml"));for(var a=k.evaluate(b,k,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),b=0,p;p=a.iterateNext();)p.value?c.setValue(b,p.value):p.data?c.setValue(b,p.data):c.setValue(b,""),b++;f.setValue(b,0);h.setValue(b,0);
c.setSliceCount(b);f.setSliceCount(1);h.setSliceCount(1)}};VVVV.Nodes.XPathXML.prototype=new VVVV.Core.Node;var UIState={Idle:0,Connecting:1,Moving:2,Creating:3,Changing:4,AreaSelecting:5};
VVVV.PinTypes.Value.makeLabel=VVVV.PinTypes.String.makeLabel=function(a,b){var g=b.IOBoxRows();b.IOBoxInputPin().getSliceCount();d3.select(a).selectAll(".vvvv-node-label").remove();for(var e=0;e<g;e++)d3.select(a).append("svg:text").text(b.IOBoxInputPin().getValue(e)).attr("class","vvvv-node-label").attr("shape-rendering","crispEdges").attr("dy",function(){return 12*e+12}).attr("dx",4).attr("font-size",10).attr("font-family","Lucida Sans Unicode")};
VVVV.PinTypes.Value.openInputBox=VVVV.PinTypes.String.openInputBox=function(a,b,g,e){$inputbox=$("<input type='text' value='"+g.getValue(e)+"' class='pininputbox value resettable'/>");$inputbox.css("position",b.css("position"));$inputbox.css("width",b.css("width"));$inputbox.css("height",b.css("height"));$inputbox.css("left",b.css("left"));$inputbox.css("top",b.css("top"));b.replaceWith($inputbox);$inputbox.get(0).select();$inputbox.change(function(){g.setValue(e,$(this).val());g.node.parentPatch.editor.update(g.node.parentPatch,
"<PATCH><NODE id='"+g.node.id+"'><PIN pinname='"+g.pinname+"' values='"+_(g.values).map(function(a){return"|"+a+"|"}).join(",")+"'/></NODE>")});$inputbox.keydown(function(a){13==a.which&&($(this).change(),$(this).remove())});if("Value"==this.typeName){var d=function(a,b,d){var e=$(a).val()%1;if(!isNaN(e)){var g;g=1;if(d.altKey||0!==e)g=0.01;b*=g;$(a).val(parseFloat($(a).val())+b);$(a).change()}};$inputbox.bind("mousewheel",function(a){d(this,a.originalEvent.wheelDelta/120,a);a.preventDefault();return!1});
$inputbox.bind("DOMMouseScroll",function(a){d(this,-a.originalEvent.detail/3,a);a.preventDefault();return!1})}$inputbox.bind("paste",function(a){a.stopPropagation()});$inputbox.bind("copy",function(a){a.stopPropagation()})};
VVVV.PinTypes.Enum.openInputBox=function(a,b,g,e){$inputbox=$("<select class='pininputbox value resettable'>");for(a=0;a<g.enumOptions.length;a++)$opt=$('<option value="'+g.enumOptions[a]+'">'+g.enumOptions[a]+"</option>"),g.getValue(e)==g.enumOptions[a]&&$opt.attr("selected",!0),$inputbox.append($opt);$inputbox.css("position",b.css("position"));$inputbox.css("width",b.css("width"));$inputbox.css("height",b.css("height"));$inputbox.css("left",b.css("left"));$inputbox.css("top",b.css("top"));b.replaceWith($inputbox);
$inputbox.change(function(){g.setValue(e,$(this).val());g.node.parentPatch.editor.update(g.node.parentPatch,"<PATCH><NODE id='"+g.node.id+"'><PIN pinname='"+g.pinname+"' values='"+_(g.values).map(function(a){return"|"+a+"|"}).join(",")+"'/></NODE>")})};
VVVV.PinTypes.Color.makeLabel=function(a,b){var g=b.IOBoxRows();b.IOBoxInputPin().getSliceCount();d3.select(a).selectAll(".vvvv-node-label").remove();for(var e=0;e<g;e++)d3.select(a).append("svg:rect").attr("class","vvvv-node-label").attr("height",b.getHeight()/g-8).attr("width",b.getWidth()).attr("y",12*e+4).attr("fill",function(){for(var a=b.IOBoxInputPin().getValue(e).split(","),c=0;c<a.length;c++)a[c]=parseInt(256*a[c]);return"rgba("+a.join(",")+")"})};
VVVV.PinTypes.Color.openInputBox=function(a,b,g,e){function d(a){f=a.altKey&&a.shiftKey?3:a.altKey?1:a.shiftKey?2:0}function c(a){var b=g.getValue(e).split(","),c=VVVV.PinTypes.Color.rgbToHsv(b[0],b[1],b[2]);c[3]=parseFloat(b[3]);c[f]+=0.01*a;0!=f&&(c[f]=Math.min(1,Math.max(0,c[f])));b=VVVV.PinTypes.Color.hsvToRgb(c[0],c[1],c[2]);b[3]=c[3];$inputbox.css("background-color","rgba("+_(b).map(function(a){return parseInt(255*a)}).join(",")+")");ibx=$inputbox;b.join(",");g.setValue(e,b.join(","));g.node.parentPatch.editor.update(g.node.parentPatch,
"<PATCH><NODE id='"+g.node.id+"'><PIN pinname='"+g.pinname+"' values='"+_(g.values).map(function(a){return"|"+a+"|"}).join(",")+"'/></NODE>")}var f=0;$(a.window.document).keydown(d).keyup(d);$inputbox=$('<div class="pininputbox color resettable"></div>');$inputbox.css("position",b.css("position"));$inputbox.css("width",b.css("width"));$inputbox.css("height",b.css("height"));$inputbox.css("left",b.css("left"));$inputbox.css("top",b.offset().top-8+"px");a=g.getValue(e).split(",");for(var h=0;h<a.length;h++)a[h]=
parseInt(256*a[h]);$inputbox.css("background-color","rgba("+a.join(",")+")");b.replaceWith($inputbox);$inputbox.on("mousewheel",function(a){c(a.originalEvent.wheelDelta/120);a.preventDefault();return!1});$inputbox.bind("DOMMouseScroll",function(a){c(-a.originalEvent.detail/3);a.preventDefault();return!1})};VVVV.Editors.BrowserEditor={};
VVVV.Editors.BrowserEditor.PatchWindow=function(a,b){var g;function e(){f.selectAll(".vvvv-node.selected").attr("class",function(a){return a.isIOBox?"vvvv-node vvvv-iobox":"vvvv-node"});j=[]}this.state=UIState.Idle;var d=0,c=0,f,h,k,m,l,p=void 0,j=[],n=a,r=0,u=VVVV.Root+"/patch.html";g=!1;var s=0,q=0,v=0,t=0;a.isSubpatch&&(u="patch.html");this.window=window.open(u,a.nodename,"location=no, width="+a.windowWidth+", height="+a.windowHeight+", toolbar=no");var w=this;window.setTimeout(function(){function k(a){g=
a.shiftKey}for(var l=0;l<n.nodeList.length;l++)r=Math.max(r,n.nodeList[l].id);w.window.document.title=a.nodename;root=d3.select(w.window.document.body);$("body",w.window.document).on("copy",function(a){for(var b=$("<PATCH>"),c=[],d=_(j).map(function(a){return a.id}),e=0;e<j.length;e++)b.append(j[e].serialize()),_(j[e].inputPins).each(function(a){for(var b=0;b<a.links.length;b++)0<=d.indexOf(a.links[b].fromPin.node.id)&&c.push(a.links[b])});for(e=0;e<c.length;e++)b.append(c[e].serialize());b='<!DOCTYPE PATCH  SYSTEM "http://vvvv.org/versions/vvvv45beta28.1.dtd" >\r\n'+
b.wrapAll("<d></d>").parent().html();b=b.replace(/<patch/g,"<PATCH");b=b.replace(/<\/patch>/g,"\n  </PATCH>");b=b.replace(/<node/g,"\n  <NODE");b=b.replace(/<\/node>/g,"\n  </NODE>");b=b.replace(/<bounds/g,"\n  <BOUNDS");b=b.replace(/<\/bounds>/g,"\n  </BOUNDS>");b=b.replace(/<pin/g,"\n  <PIN");b=b.replace(/<\/pin>/g,"\n  </PIN>");b=b.replace(/<lonk/g,"\n  <LINK");b=b.replace(/<\/lonk>/g,"\n  </LINK>");a.originalEvent.clipboardData.setData("text/plain",b);a.preventDefault();return!1});var m=0,u=0;
$("body",w.window.document).mousemove(function(a){m=a.pageX;u=a.pageY});$("body",w.window.document).on("paste",function(a){a=a.originalEvent.clipboardData.getData("text/plain");if(!a.match(/^<!DOCTYPE PATCH/))return!1;$patch=$(a);var c=void 0,d=void 0;$patch.find("node bounds").each(function(){var a=parseInt($(this).attr("left")),b=parseInt($(this).attr("top"));if(!c||a<c)c=a;if(!d||b<d)d=b});var g={};$patch.find("node").each(function(){r++;g[$(this).attr("id")]=r;$(this).attr("createme","pronto");
$(this).attr("id",r);var a=parseInt($(this).find("bounds").attr("left"))-c+15*m,b=parseInt($(this).find("bounds").attr("top"))-d+15*u;$(this).find("bounds").attr("left",a);$(this).find("bounds").attr("top",b)});$patch.find("link").each(function(){$(this).attr("createme","pronto");var a=$(this).attr("srcnodeid"),b=$(this).attr("dstnodeid");$(this).attr("srcnodeid",g[a]);$(this).attr("dstnodeid",g[b])});a=$patch.wrapAll("<d></d>").parent().html();b.update(n,a);e();var h=_(g).map(function(a){return a});
f.selectAll(".vvvv-node").each(function(a){0<=h.indexOf(parseInt(a.id))&&(j.push(a),d3.select(this).attr("class","vvvv-node selected"))})});f=root.append("svg:svg").attr("class","chart").attr("width",Math.max(n.windowWidth,n.boundingBox.width)).attr("height",Math.max(n.windowHeight,n.boundingBox.height)).on("mousemove",function(){if(w.state==UIState.Connecting)f.select(".vvvv-link.current-link").attr("x2",function(){return d3.event.pageX+(d3.select(this).attr("x1")<d3.event.pageX?-1:1)}).attr("y2",
function(){return d3.event.pageY+(d3.select(this).attr("y1")<d3.event.pageY?-1:1)});else if(w.state==UIState.Moving){var a=d3.event.pageX-d,b=d3.event.pageY-c;f.selectAll(".vvvv-node.selected").attr("transform",function(c){return"translate("+(c.x+a)+","+(c.y+b)+")"});for(var g=0;g<j.length;g++){var h=j[g];f.selectAll(".vvvv-link line").filter(function(a){return a.fromPin.node.id==h.id}).attr("x1",function(b){return b.fromPin.x+b.fromPin.node.x+a}).attr("y1",function(a){return a.fromPin.y+a.fromPin.node.y+
b});f.selectAll(".vvvv-link line").filter(function(a){return a.toPin.node.id==h.id}).attr("x2",function(b){return b.toPin.x+b.toPin.node.x+a}).attr("y2",function(a){return a.toPin.y+a.toPin.node.y+b})}}else w.state==UIState.AreaSelecting&&(v=d3.event.pageX,t=d3.event.pageY,f.select(".selection-area").attr("transform","translate("+Math.min(s,v)+", "+Math.min(q,t)+")").attr("width",Math.abs(v-s)).attr("height",Math.abs(t-q)),e(),f.selectAll(".vvvv-node").each(function(a){for(var b=[a.x,a.x+a.getWidth()],
c=[a.y,a.y+a.getHeight()],d=!1,e=0;2>e;e++)for(var f=0;2>f;f++)b[e]>=Math.min(s,v)&&(b[e]<=Math.max(s,v)&&c[f]>=Math.min(q,t)&&c[f]<=Math.max(q,t))&&(d=!0);d&&(d3.select(this).attr("class","vvvv-node selected"),j.push(a))}))}).on("contextmenu",function(){w.state==UIState.Connecting&&(f.select(".vvvv-link.current-link").remove(),w.state=UIState.Idle);d3.event.stopPropagation();d3.event.preventDefault();return!1}).on("mouseup",function(){if(w.state==UIState.Moving){w.state=UIState.Idle;for(var a=d3.event.pageX-
d,e=d3.event.pageY-c,g="<PATCH>",h=0;h<j.length;h++)var l=j[h],g=g+("<NODE componentmode='Node' id='"+l.id+"'><BOUNDS type='Node' left='"+15*(a+l.x)+"' top='"+15*(e+l.y)+"' width='"+l.width+"' height='"+l.height+"'/></NODE>");b.update(n,g+"</PATCH>")}w.state==UIState.AreaSelecting&&(f.select(".selection-area").remove(),w.state=UIState.Idle)}).on("dblclick",function(){function a(){g.empty();for(var b=f.find("#node_filter").val().toLowerCase(),c=VVVV.NodeNames.concat(_(VVVV.ShaderCodeResources).map(function(a,
b){return b.replace("%VVVV%/effects/","")})),c=_(_(c).filter(function(a){return 0<=VVVV.Helpers.translateOperators(a).toLowerCase().indexOf(b)})).sortBy(function(a){return a.toLowerCase().indexOf(b)}),d=0;d<c.length;d++)g.append($("<option>"+c[d]+"</option>"));g.find("option").first().attr("selected",!0)}function c(){var a=f.find("#node_filter").val(),g=f.find("#new_node option:selected").val(),h="";if(!g&&(a.match(/\.fx$/)||a.match(/\.v4p$/)))g=a;if(g){var j;(j=g.match(/^(.*\/([^\.]+))(\.vvvvjs)?\.fx$/))?
(g=j[2]+" (EX9.Effect)",h=j[1]+".fx"):(j=g.match("([^.]+)(.vvvvjs)?.fx$"))?(g=j[1]+" (EX9.Effect)",h="%VVVV%/effects/"+j[1]+".fx"):g.match("[^/].v4p$")&&(h=g=a);r++;g="<PATCH>"+("<NODE componentmode='Hidden' id='"+r+"' nodename='"+g+"' systemname='"+g+"' "+(""!=h?"filename='"+h+"'":"")+">");g+="<BOUNDS type='Node' left='"+15*d+"' top='"+15*e+"' width='100' height='100'/>"}else r++,g="<PATCH>"+("<NODE componentmode='Hidden' id='"+r+"' nodename='IOBox (String)' systemname='IOBox (String)'>"),g+="<BOUNDS type='Node' left='"+
15*d+"' top='"+15*e+"' width='100' height='100'/>",g+="<PIN pinname='Input String' values='|"+a+"|'/>";b.update(n,g+"</NODE>");f.remove()}$("#node_selection",w.window.document).remove();var d=d3.event.pageX,e=d3.event.pageY,f=$('<div id="node_selection"><input type="text" id="node_filter"/></div>'),g=$('<select id="new_node" size="8">');f.append(g);f.css("left",d);f.css("top",e);$("body",w.window.document).append(f);f.find("input").bind("paste",function(a){a.stopPropagation()});f.find("#node_filter").get(0).focus();
a();f.find("#node_filter").keyup(function(b){if(13==b.which)c();else{if(40==b.which)return g.find("option:selected").first().next().attr("selected",!0),!1;if(38==b.which)return g.find("option:selected").first().prev().attr("selected",!0),!1;a()}});f.find("#new_node").click(c)}).on("mousedown",function(){w.state==UIState.Idle&&(w.state=UIState.AreaSelecting,s=v=d3.event.pageX+1,q=t=d3.event.pageY+1,f.append("svg:rect").attr("class","selection-area").attr("stroke","#000").attr("stroke-dasharray","2,2").attr("stroke-width",
1).attr("fill","rgba(0,0,0,0)").attr("transform","translate("+s+", "+q+")").attr("width",0).attr("height",0),e())});f.append("svg:rect").attr("class","background").attr("width",Math.max(n.windowWidth,n.boundingBox.width)).attr("height",Math.max(n.windowHeight,n.boundingBox.height)).on("click",function(){w.state=UIState.Idle;$(".resettable",w.window.document).remove();$("#node_selection",w.window.document).remove();e();p=void 0});$(w.window.document).keydown(k);$(w.window.document).keyup(k);$(w.window.document).keydown(function(a){if(46==
a.which&&0<j.length){var c="<PATCH>";for(a=0;a<j.length;a++){var d=j[a],c=c+("<NODE id='"+j[a].id+"' deleteme='pronto'/>");_(d.inputPins).each(function(a){_(a.links).each(function(a){c+="<LINK deleteme='pronto' srcnodeid='"+a.fromPin.node.id+"' srcpinname='"+a.fromPin.pinname+"' dstnodeid='"+a.toPin.node.id+"' dstpinname='"+a.toPin.pinname+"'/>"})});_(d.outputPins).each(function(a){_(a.links).each(function(a){c+="<LINK deleteme='pronto' srcnodeid='"+a.fromPin.node.id+"' srcpinname='"+a.fromPin.pinname+
"' dstnodeid='"+a.toPin.node.id+"' dstpinname='"+a.toPin.pinname+"'/>"})})}c+="</PATCH>";b.update(n,c);j=[]}else{if((115==a.which||83==a.which)&&a.ctrlKey)return b.save(n.nodename,n.toXML()),a.preventDefault(),!1;if(73==a.which&&a.ctrlKey)return b.inspector?b.inspector.win.focus():b.openInspector("."),a.preventDefault(),!1;if(65==a.which&&a.ctrlKey)return e(),f.selectAll(".vvvv-node").each(function(a){j.push(a);d3.select(this).attr("class","vvvv-node selected")}),a.preventDefault(),!1}});$(w.window).resize(function(){n.windowWidth=
$(this).width();n.windowHeight=$(this).height();n.boundingBox.width=Math.max(n.windowWidth,n.boundingBox.width);n.boundingBox.height=Math.max(n.windowHeight,n.boundingBox.height);n.afterUpdate()});w.drawComplete();n.afterUpdate=function(){w.drawComplete();b.inspector&&window.setTimeout(b.inspector.update,100)};n.afterEvaluate=function(){h.filter(function(a){return a.isIOBox&&VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel}).each(function(a){VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel(this,
a)})}},1E3);this.close=function(){this.window.close()};this.drawComplete=function(){h&&h.remove();l&&l.remove();(n.windowWidth!=$(w.window).width()||n.windowHeight!=$(w.window).height())&&w.window.resizeTo(n.windowWidth,n.windowHeight);f.attr("width",Math.max(n.windowWidth,n.boundingBox.width)).attr("height",Math.max(n.windowHeight,n.boundingBox.height));f.selectAll(".background").attr("width",Math.max(n.windowWidth,n.boundingBox.width)).attr("height",Math.max(n.windowHeight,n.boundingBox.height));
var a=f.append("svg:g").attr("class","link-group");h=f.selectAll("g.vvvv-node").data(n.nodeList).enter().append("svg:g").attr("class",function(a){var b="vvvv-node";a.isIOBox&&(b+=" vvvv-iobox");0<=j.indexOf(a)&&(b+=" selected");return b}).attr("id",function(a){return"vvvv-node-"+a.id}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"});h.append("svg:rect").attr("class","vvvv-node-background").attr("height",function(a){return a.getHeight()}).attr("width",function(a){return a.getWidth()}).attr("fill",
function(a){return a.isComment()?"rgba(0,0,0,0)":a.not_implemented?"rgba(255,0,0,1)":"#cdcdcd"});h.append("svg:rect").attr("class","vvvv-node-pinbar").attr("height",function(a){return a.isIOBox?2:4}).attr("fill",function(a){return a.isIOBox?"#dddddd":"#9a9a9a"}).attr("width",function(a){return a.getWidth()});h.append("svg:rect").attr("class","vvvv-node-pinbar").attr("y",function(a){return a.isIOBox?a.getHeight()-2:a.getHeight()-4}).attr("height",function(a){return a.isIOBox?2:4}).attr("fill",function(a){return a.isIOBox?
"#dddddd":"#9a9a9a"}).attr("width",function(a){return a.getWidth()});h.append("svg:g").attr("class","descriptive-name-bg");h.append("svg:text").text(function(a){return a.invisiblePins["Descriptive Name"]?a.invisiblePins["Descriptive Name"].getValue(0):null}).attr("class","vvvv-node-descriptive-name").attr("shape-rendering","crispEdges").attr("dy",function(a){return a.getHeight()+12}).attr("dx",2).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","white");h.selectAll("g.descriptive-name-bg").append("svg:rect").attr("fill",
function(a){return void 0==a.invisiblePins["Descriptive Name"]||""==a.invisiblePins["Descriptive Name"].getValue(0)?"rgba(0,0,0,0)":"rgba(0,0,0,1)"}).attr("y",function(a){return a.getHeight()}).attr("width",5).attr("height",14);h.each(function(a){if(a.isIOBox&&VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel){VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel(this,a);for(var b=a.IOBoxRows(),c=a.IOBoxInputPin().getSliceCount(),d=this,e=0;e<b;e++)(function(e){d3.select(d).append("svg:rect").attr("width",
a.getWidth()+2).attr("height",a.getHeight()/b-4).attr("y",12*e+2).attr("fill","rgba(0,0,0,0)").on("contextmenu",function(a){if(void 0!=a.IOBoxInputPin().getValue(0)&&!a.IOBoxInputPin().isConnected()){$(".resettable",w.window.document).remove();var d=$("<input type='text'/>");$("body",w.window.document).append(d);d.css("position","absolute");d.css("left",$(this).offset().left);d.css("top",$(this).offset().top+2);d.css("width",a.getWidth());d.css("height",a.getHeight()/b-4);VVVV.PinTypes[a.IOBoxInputPin().typeName].openInputBox(w.window,
d,a.IOBoxInputPin(),e%c)}d3.event.stopPropagation();d3.event.preventDefault();return!1})})(e)}else d3.select(this).append("svg:text").text(function(a){return a.label()}).attr("class","vvvv-node-label").attr("shape-rendering","crispEdges").attr("dy",function(a,b){return 12*b+12}).attr("dx",4).attr("font-size",10).attr("font-family","Lucida Sans Unicode")});k=h.selectAll("g.vvvv-input-pin").data(function(a){return a.isSubpatch?_(a.inputPins).sortBy(function(a){return a.slavePin?a.slavePin.node.x:1}).map(function(a){return a}):
_(a.inputPins).map(function(a){return a})}).enter().append("svg:g").attr("class","vvvv-input-pin").attr("transform",function(a,b){pinOffset=0;1<_(a.node.inputPins).size()&&(pinOffset=(a.node.getWidth()-4)/(_(a.node.inputPins).size()-1));a.y=0;a.x=b*pinOffset;return"translate("+a.x+", 0)"});k.append("svg:rect").attr("width",4).attr("height",4).attr("fill",function(a){return a.node.isComment()?"rgba(0,0,0,0)":"#666666"}).on("mouseover",function(a,b){f.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-input-pin").filter(function(a,
c){return c==b}).each(function(){d3.select(this).append("svg:rect").attr("class","vvvv-input-pin-highlight").attr("width",4).attr("height",4).attr("fill","rgba(0,0,0,1)").attr("y",-4);d3.select(this).append("svg:text").text(function(a){return 1<a.getSliceCount()?a.pinname+"("+a.getSliceCount()+"): "+a.getValue(0):a.pinname+": "+a.getValue(0)}).attr("dy",30).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","rgba(0,0,0,1)")})}).on("mouseout",function(a){f.selectAll("#vvvv-node-"+
a.node.id+" g.vvvv-input-pin text").remove();f.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-input-pin rect.vvvv-input-pin-highlight").remove()});m=h.selectAll("g.vvvv-output-pin").data(function(a){return _(a.outputPins).map(function(a){return a})}).enter().append("svg:g").attr("class","vvvv-output-pin").attr("transform",function(a,b){pinOffset=0;1<_(a.node.outputPins).size()&&(pinOffset=(a.node.getWidth()-4)/(_(a.node.outputPins).size()-1));a.y=a.node.getHeight()-4;a.x=b*pinOffset;return"translate("+
a.x+", "+a.y+")"});m.append("svg:rect").attr("width",4).attr("height",4).attr("fill",function(a){return a.node.isComment()?"rgba(0,0,0,0)":"#666666"}).on("mouseover",function(a,b){f.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-output-pin").filter(function(a,c){return c==b}).each(function(){d3.select(this).append("svg:rect").attr("class","vvvv-output-pin-highlight").attr("width",4).attr("height",4).attr("fill","rgba(0,0,0,1)").attr("y",-4);d3.select(this).append("svg:text").text(function(a){return 1<
a.getSliceCount()?a.pinname+"("+a.getSliceCount()+"): "+a.getValue(0):a.pinname+": "+a.getValue(0)}).attr("dy",30).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","rgba(0,0,0,1)")})}).on("mouseout",function(a){f.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-output-pin text").remove();f.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-output-pin rect.vvvv-output-pin-highlight").remove()});l=a.selectAll("g.vvvv-link").data(n.linkList).enter().append("svg:g").attr("class","vvvv-link");
l.append("svg:line").attr("stroke","rgba(0, 0, 0, 0)").attr("stroke-width",4).attr("x1",function(a){return a.fromPin.x+a.fromPin.node.x+2+0.5}).attr("y1",function(a){return a.fromPin.y+a.fromPin.node.y+4+0.5}).attr("x2",function(a){return a.toPin.x+a.toPin.node.x+2+0.5}).attr("y2",function(a){return a.toPin.y+a.toPin.node.y+0.5});l.append("svg:line").attr("stroke","#000").attr("stroke-width",1).attr("x1",function(a){return a.fromPin.x+a.fromPin.node.x+2+0.5}).attr("y1",function(a){return a.fromPin.y+
a.fromPin.node.y+4+0.5}).attr("x2",function(a){return a.toPin.x+a.toPin.node.x+2+0.5}).attr("y2",function(a){return a.toPin.y+a.toPin.node.y+0.5});$(".descriptive-name-bg rect",w.window.document).each(function(){$(this,w.window.document).attr("width",$(this,w.window.document).parent().next().get(0).getBBox().width+4)});f.selectAll("g.vvvv-input-pin").on("contextmenu",function(a){if(VVVV.PinTypes[a.typeName].openInputBox&&void 0!=a.getValue(0)){$(".resettable",w.window.document).remove();var b=$("<input type='text'/>");
$("body",w.window.document).append(b);b.css("position","absolute");b.css("left",$(this).offset().left);b.css("top",$(this).offset().top-3);b.css("width",50);b.css("height",14);VVVV.PinTypes[a.typeName].openInputBox(w,b,a,0)}d3.event.stopPropagation();d3.event.preventDefault();return!1});f.selectAll("g.vvvv-input-pin, g.vvvv-output-pin").on("click",function(a){if(w.state!=UIState.Connecting){p=a;w.state=UIState.Connecting;f.append("svg:line").attr("class","vvvv-link current-link resettable").attr("stroke",
"#000").attr("stroke-width",1).attr("x1",a.x+a.node.x+2+0.5).attr("y1",a.y+a.node.y+2+0.5).attr("x2",a.x+a.node.x+2+0.5).attr("y2",a.y+a.node.y+2+0.5);var c=p.direction==PinDirection.Output?"input":"output",d=p.node.getUpstreamNodes();f.selectAll("g.vvvv-"+c+"-pin").filter(function(a){return a.typeName!=p.typeName&&("Node"!=p.typeName||VVVV.PinTypes[a.typeName].primitive&&("Node"!=a.typeName||VVVV.PinTypes[p.typeName].primitive))||0<=d.indexOf(a.node)||a.node==p.node?!1:!0}).append("svg:rect").attr("class",
"vvvv-connection-highlight").attr("width",4).attr("height",3).attr("fill","rgba(0,0,0,1)").attr("y",function(a){return a.direction==PinDirection.Input?-3:3})}else{p.direction==PinDirection.Input?(c=a,a=p):c=p;if(c.typeName==a.typeName||"Node"==c.typeName&&!VVVV.PinTypes[a.typeName].primitive||"Node"==a.typeName&&!VVVV.PinTypes[c.typeName].primitive){var e="<PATCH>";_(a.links).each(function(a){e+="<LINK deleteme='pronto' srcnodeid='"+a.fromPin.node.id+"' srcpinname='"+a.fromPin.pinname+"' dstnodeid='"+
a.toPin.node.id+"' dstpinname='"+a.toPin.pinname+"'/>"});e+="<LINK createme='pronto' srcnodeid='"+c.node.id+"' srcpinname='"+c.pinname+"' dstnodeid='"+a.node.id+"' dstpinname='"+a.pinname+"'/>";e+="</PATCH>";b.update(n,e);f.select(".vvvv-link.current-link").remove();f.select(".vvvv-connection-highlight").remove();w.state=UIState.Idle}n.afterUpdate()}d3.event.stopPropagation()}).on("mousedown",function(){d3.event.stopPropagation()});f.selectAll("g.vvvv-link").on("contextmenu",function(a){b.update(n,
"<PATCH><LINK deleteme='pronto' srcnodeid='"+a.fromPin.node.id+"' srcpinname='"+a.fromPin.pinname+"' dstnodeid='"+a.toPin.node.id+"' dstpinname='"+a.toPin.pinname+"'/></PATCH>");d3.event.preventDefault()});h.on("mousedown",function(a){$(".resettable",w.window.document).remove();w.state=UIState.Moving;0>j.indexOf(a)&&(g||e(),d3.select(this).attr("class","vvvv-node selected"),j.push(a));d=d3.event.pageX;c=d3.event.pageY;b.inspector&&b.inspector.setNode(a);d3.event.preventDefault();d3.event.stopPropagation();
return!1}).on("contextmenu",function(a){a.isSubpatch?b.openPatch(a):a.openUIWindow&&a.openUIWindow();d3.event.preventDefault();d3.event.stopPropagation();return!1})}};
VVVV.Editors.BrowserEditor.Inspector=function(a){function b(){c=void 0;$(f.win.document).find("#pins, #values").empty();$(f.win.document).find("#pins").append('<div class="row heading">Configuration</div>');$(f.win.document).find("#values").append('<div class="row heading"></div>');_(d.invisiblePins).each(function(a){g(a)});$(f.win.document).find("#pins").append('<div class="row heading">Input Pins</div>');$(f.win.document).find("#values").append('<div class="row heading"></div>');_(d.inputPins).each(function(a){g(a)});
$(f.win.document).find("#pins").append('<div class="row heading">Output Pins</div>');$(f.win.document).find("#values").append('<div class="row heading"></div>');_(d.outputPins).each(function(a){g(a)})}function g(a){var b=$('<a class="row pin" href="#">'+a.pinname+"</a>");$(f.win.document).find("#pins").append(b);b.click(function(b){$(f.win.document).find("a.pin.active").removeClass("active");$(this).addClass("active");VVVV.PinTypes[a.typeName].openInputBox&&e(a);b.preventDefault();return!1});VVVV.PinTypes[a.typeName].openInputBox&&
a.direction!=PinDirection.Output&&!a.isConnected()&&void 0!=a.getValue(0)?(b=$('<div class="row value"><div style="height:100%">'+a.getValue(0)+"</div></div>"),b.find("div").click(function(){VVVV.PinTypes[a.typeName].openInputBox(f.win,$(this),a,0)})):b=$('<div class="row value readonlyvalue"><div style="height:100%">'+a.getValue(0)+"</div></div>");"Color"==a.typeName&&b.find("div").css("background-color","rgba("+_(a.getValue(0).split(",")).map(function(a){return parseInt(255*a)}).join(",")+")");
$(f.win.document).find("#values").append(b)}function e(a){var b=c!=a;c=a;var d=a.getSliceCount(),e=$('<div class="row heading"><input type="text" value="'+d+'"/ size="3"/> Slices</div>');a.direction!=PinDirection.Input&&e.find("input").attr("disabled",!0);var g=$(f.win.document).find("#values .row").first();0<g.length?g.replaceWith(e):$(f.win.document).find("#values").append(e);e.find("input").change(function(a){for(var b=Math.max(1,parseInt($(this).val())),d=c.getSliceCount();d<b;d++)c.setValue(d,
VVVV.PinTypes[c.typeName].defaultValue());c.setSliceCount(b);c.node.parentPatch.afterUpdate();a.preventDefault();return!1});for(e=e=0;e<d;e++)if(g=$(f.win.document).find("#values .row").eq(e+1),b||!g.children().first().hasClass("pininputbox")){if(VVVV.PinTypes[a.typeName].openInputBox&&a.direction!=PinDirection.Output&&!a.isConnected()&&void 0!=a.getValue(0)){var j=$('<div class="row value"><div style="height:100%">'+a.getValue(e)+"</div></div>");(function(b){j.find("div").click(function(){VVVV.PinTypes[a.typeName].openInputBox(f.win,
$(this),a,b)})})(e)}else j=$('<div class="row value readonlyvalue"><div style="height:100%">'+a.getValue(e)+"</div></div>");0<g.length?g.replaceWith(j):$(f.win.document).find("#values").append(j);"Color"==a.typeName&&j.find("div").css("background-color","rgba("+_(a.getValue(e).split(",")).map(function(a){return parseInt(255*a)}).join(",")+")")}e++;for(g=$(f.win.document).find("#values .row");e<g.length;e++)g.eq(e).remove()}this.win=window.open(a+"/inspektor.html","inspektor","location=no, width=250, height=600, toolbar=no");
var d,c;insw=this.win;var f=this;this.update=function(){d&&(c?e(c):b())};this.setNode=function(a){d=a;b()};this.close=function(){this.win.close()}};
VVVV.Editors.BrowserEditor.Interface=function(){function a(){return"Are you sure you want to leave? Unsaved changes in your patches will be lost."}var b=[],g={};this.inspector=void 0;this.enable=function(d,c){this.addPatch(d);this.openPatch(d);var e=this;$(window).bind("beforeunload",a);$(window).unload(function(){e.disable()});this.openInspector(VVVV.Root);b[0].window?c&&c.success&&c.success():c&&c.error&&c.error()};this.openInspector=function(a){if(!this.inspector){this.inspector=new VVVV.Editors.BrowserEditor.Inspector(a);
var b=this;$(this.inspector.win).bind("beforeunload",function(){console.log("closing inspektor");b.inspector=void 0})}};var e=[];this.addPatch=function(a){for(var b=a.id,f=a;void 0!=(f=f.parentPatch);)b+="-"+f.id;if(!(0<=e.indexOf(b))){e.push(b);a.editor=this;b=VVVV.Helpers.prepareFilePath(a.nodename,a.parentPatch);void 0==g[b]&&(g[b]=[]);g[b].push(a);a=a.getSubPatches();for(b=0;b<a.length;b++)this.addPatch(a[b])}};this.removePatch=function(a){for(var b=a.getSubPatches(),e=0;e<b.length;e++)this.removePatch(b[e]);
b=VVVV.Helpers.prepareFilePath(a.nodename,a.parentPatch);g[b].splice(g[b].indexOf(a),1);0==g[b].length&&delete g[b];console.log(g)};this.openPatch=function(a){b.push(new VVVV.Editors.BrowserEditor.PatchWindow(a,this))};this.update=function(a,b){for(var e=VVVV.Helpers.prepareFilePath(a.nodename,a.parentPatch),h=g[e].length,k=0;k<h;k++)g[e][k].doLoad(b),g[e][k].afterUpdate()};this.disable=function(){for(var d=0;d<b.length;d++)b[d].close();this.inspector&&this.inspector.close();$(window).unbind("beforeunload",
a)};this.save=function(a,b){var e=$("<a>save</a>");$("body").append(e);e.attr("href","data:application/octet-stream;charset=utf-8,"+encodeURIComponent(b));e.attr("download",a);e[0].click();e.remove()};this.sendUndo=function(){}};VVVV.Editors.edit=new VVVV.Editors.BrowserEditor.Interface;
